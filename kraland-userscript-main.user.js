// ==UserScript==
// @name         Kraland Theme (Bundled)
// @namespace    http://www.kraland.org/
// @version      1.0.1771771384653
// @description  Injects the Kraland CSS theme (bundled) - Works with Tampermonkey & Violentmonkey
// @match        http://www.kraland.org/*
// @run-at       document-start
// @grant        none
// @grant        GM.xmlHttpRequest
// @connect      raw.githubusercontent.com
// @compatible   chrome tampermonkey
// @compatible   firefox tampermonkey
// @compatible   edge tampermonkey
// @compatible   firefox violentmonkey
// @compatible   chrome violentmonkey
// ==/UserScript==

"false"!==localStorage.getItem("kr-theme-enabled")&&document.documentElement.style.setProperty("opacity","0","important"),function(){"use strict";const t="1.0.1771771384653";function e(){return document.body&&document.body.classList&&document.body.classList.contains("mobile-mode")}const r={_queue:[],_initialized:!1,register(t,e,r=100){this._queue.push({name:t,fn:e,priority:r})},run(){this._initialized||(this._initialized=!0,this._queue.sort((t,e)=>t.priority-e.priority),e(),this._queue.forEach(({name:t,fn:e})=>{try{e()}catch(e){console.error(`[InitQueue] ✗ ${t}:`,e)}}))}};if(function(){let t,e=null;function r(){return window.innerWidth<768}function o(){const t=r();document.body?e!==t&&(e=t,t?(document.body.classList.add("mobile-mode"),console.log("[Kraland Mobile] Mode mobile activé"),function(){const t=()=>{document.querySelectorAll('[class*="col-"]').forEach(t=>{t.style.setProperty("padding-left","0px","important"),t.style.setProperty("padding-right","0px","important")}),document.querySelectorAll(".row").forEach(t=>{t.style.setProperty("margin-left","0px","important"),t.style.setProperty("margin-right","0px","important")}),document.querySelectorAll(".container, .container-fluid").forEach(t=>{t.style.setProperty("padding-left","0px","important"),t.style.setProperty("padding-right","0px","important")}),document.querySelectorAll(".dashboard").forEach(t=>{t.style.setProperty("margin-left","0px","important"),t.style.setProperty("margin-right","0px","important"),t.style.setProperty("width","100%","important"),t.style.setProperty("padding","0px","important")})};t(),setTimeout(t,100),setTimeout(t,500)}()):(document.body.classList.remove("mobile-mode"),console.log("[Kraland Mobile] Mode desktop"))):console.warn("[Kraland Mobile] document.body n'est pas disponible")}function a(){if(!document.body)return;const t=window.location.pathname;t.includes("/kramail")?(document.body.classList.add("page-kramail"),t.match(/\/kramail\/post\/nouveau/)&&document.body.classList.add("page-kramail-compose")):t.startsWith("/forum/")&&document.body.classList.add("page-forum")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),window.addEventListener("resize",function(){clearTimeout(t),t=setTimeout(()=>{o()},150)}),window.KralandMobile={isMobile:r,reinit:o},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a()}(),function(){function t(){if(!document.body.classList.contains("mobile-mode"))return;if("undefined"==typeof jQuery||void 0===jQuery.fn.collapse)return console.warn("[Mobile Header] Bootstrap JS non chargé, utilisation du fallback"),void function(){const t=document.querySelector(".navbar-toggle"),e=document.querySelector(".navbar-collapse");t&&e&&(t.addEventListener("click",function(r){r.preventDefault(),e.classList.toggle("in");const o=e.classList.contains("in");t.setAttribute("aria-expanded",o),document.body.style.overflow=o?"hidden":""}),console.log("[Mobile Header] Fallback toggle initialisé"))}();const t=document.querySelector(".navbar-toggle"),e=document.querySelector(".navbar-collapse");if(t&&e){if(t.getAttribute("data-toggle")||t.setAttribute("data-toggle","collapse"),!t.getAttribute("data-target")){const r=e.id||"navbar-collapse-mobile";e.id=r,t.setAttribute("data-target","#"+r)}!function(){const t=document.querySelector(".navbar-collapse");if(!t)return;t.querySelectorAll("a:not(.dropdown-toggle)").forEach(e=>{e.addEventListener("click",function(){setTimeout(()=>{"undefined"!=typeof jQuery&&jQuery.fn.collapse?jQuery(t).collapse("hide"):(t.classList.remove("in"),document.body.style.overflow="")},150)})})}(),console.log("[Mobile Header] Header Bootstrap 3 initialisé")}else console.log("[Mobile Header] Éléments navbar-toggle ou navbar-collapse non trouvés")}r.register("initMobileHeader",t,10),window.KralandMobile&&(window.KralandMobile.reinitHeader=t)}(),r.register("moveHeaderButtons",function(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.querySelector(".navbar-header"),e=document.querySelector(".navbar-right");if(!t||!e)return void console.log("[Mobile Header Buttons] Éléments non trouvés");const r=Array.from(e.querySelectorAll("li")),o=r.find(t=>t.querySelector(".fa-bell")&&!t.querySelector(".dropdown-menu")),a=r.find(t=>t.querySelector(".fa-envelope")&&!t.querySelector(".dropdown-menu")),n=r.find(t=>t.querySelector(".fa-globe")&&!t.querySelector(".dropdown-menu"));if(!o&&!a&&!n)return void console.log("[Mobile Header Buttons] Aucun bouton trouvé");if(o&&o.hasAttribute("data-moved-to-header"))return;const i=document.createElement("div");i.className="navbar-header-buttons-left",o&&(o.setAttribute("data-moved-to-header","true"),i.appendChild(o.cloneNode(!0))),a&&(a.setAttribute("data-moved-to-header","true"),i.appendChild(a.cloneNode(!0))),n&&(n.setAttribute("data-moved-to-header","true"),i.appendChild(n.cloneNode(!0))),i.children.length>0&&t.insertBefore(i,t.firstChild);const l=document.querySelector(".navbar-brand");l&&(l.style.display="none"),console.log("[Mobile Header Buttons] Boutons déplacés (notification, kramail, map)")},20),function(){function t(){document.body.classList.contains("mobile-mode")&&function(){if(!document.body.classList.contains("mobile-mode"))return;if(document.querySelector(".mobile-mini-profile"))return;const t=function(){const t=document.getElementById("player-header-section"),e=document.getElementById("player-main-panel");if(!t||!e)return console.warn("[Mobile Mini-Profile] Sections profil non trouvées"),null;const r=t.querySelector(".list-group-item.active"),o=r?r.textContent.replace("×","").trim():"Joueur",a=e.querySelector('.btn.alert100 img, a[href*="perso"] img, img[src*="avatar"]'),n=a?a.src:null;let i=null;const l=document.querySelectorAll("div.mini.t");for(const t of l)if(t.querySelector("i.fa.fa-coins")&&t.textContent.includes("MØ")){i=t;break}const d=i?i.textContent.trim():"0 MØ",s=document.getElementById("player-vitals-section"),c=s?s.querySelector(".c100"):null,m=(t,e)=>{if(!t)return null;const r=Array.from(t.querySelectorAll("*")).find(t=>{const r=t.textContent.trim(),o=r.startsWith(e)||r.includes(` ${e} `),a=/\d+/.test(r);return o&&a&&t.children.length<=2});if(!r)return null;const o=r.textContent.trim();if(o.match(/(\d+)\s*\/\s*(\d+)/))return function(t,e){const r=t.textContent,o=r.match(/(\d+)\s*\/\s*(\d+)|(\d+)\s+\/\s+(\d+)/);if(!o){const t=r.match(/\d+/);if(t){const r=parseInt(t[0]);return{type:e,current:r,max:r,percent:100}}return{type:e,current:0,max:1,percent:0}}const a=parseInt(o[1]||o[3]),n=parseInt(o[2]||o[4]);return{type:e,current:a,max:n,percent:Math.min(100,a/n*100)}}(r,e.toLowerCase());{const t=o.match(/\d+/);if(!t)return null;const a=parseInt(t[0]),n=r.querySelector('.progress-bar, [class*="bar"]');let i=a;if(n){const t=n.style.width;if(t&&t.includes("%")){const e=parseInt(t);e>0&&(i=Math.round(100*a/e))}}const l=i>0?Math.min(100,a/i*100):0;return{type:e.toLowerCase(),current:a,max:i,percent:l}}};return{name:o,avatar:n,money:d,clock:c?c.textContent.trim():"--:--",gauges:{pv:m(s,"PV"),pm:m(s,"PM"),pp:m(s,"PP")}}}();if(!t)return void console.warn("[Mobile Mini-Profile] Données profil non trouvées");const e=document.createElement("div");e.className="mobile-mini-profile collapsed",e.setAttribute("data-task","1.4");const r=document.createElement("div");if(r.className="mobile-mini-profile-header",t.avatar){const e=document.createElement("img");e.src=t.avatar,e.className="avatar",e.alt="Avatar",r.appendChild(e)}const o=document.createElement("div");o.className="mobile-mini-profile-info";const a=document.createElement("div");a.className="mobile-mini-profile-name-row";const n=document.createElement("div");n.className="mobile-mini-profile-name",n.textContent=t.name,a.appendChild(n);const i=document.createElement("a");i.href="#",i.className="btn btn-default alert100 mobile-mini-profile-manage-btn",i.innerHTML="<span>⚙️</span>",i.setAttribute("data-toggle","tooltip"),i.setAttribute("data-placement","bottom"),i.setAttribute("title","Gestion du personnage"),a.appendChild(i),o.appendChild(a);const l=document.createElement("div");l.className="mobile-mini-profile-money",l.innerHTML=`\n        <span>${t.money}</span>\n        <span class="mobile-mini-profile-clock">⏱️ ${t.clock}</span>\n      `,o.appendChild(l),r.appendChild(o),e.appendChild(r);const d=document.createElement("div");d.className="mobile-mini-profile-gauges-compact",["pv","pm","pp"].forEach(e=>{const r=t.gauges[e];if(!r)return;const o=document.createElement("div");o.className="mobile-gauge-compact",o.innerHTML=`\n          <span class="mobile-gauge-compact-label">${e.toUpperCase()}</span>\n          <div class="mobile-gauge-compact-bar">\n            <div class="mobile-gauge-compact-fill ${e}" style="width: ${r.percent}%"></div>\n          </div>\n          <span class="mobile-gauge-compact-value">${r.current}</span>\n        `,d.appendChild(o)}),e.appendChild(d);const s=document.createElement("div");s.className="mobile-mini-profile-details";const c=document.createElement("div");c.className="mobile-mini-profile-gauges-full",["pv","pm","pp"].forEach(e=>{const r=t.gauges[e];if(!r)return;const o=document.createElement("div");o.className="mobile-gauge-full",o.innerHTML=`\n          <div class="mobile-gauge-full-header">\n            <span>${e.toUpperCase()}</span>\n            <span>${r.current}/${r.max}</span>\n          </div>\n          <div class="mobile-gauge-full-bar">\n            <div class="mobile-gauge-full-fill ${e}" style="width: ${r.percent}%"></div>\n          </div>\n        `,c.appendChild(o)}),s.appendChild(c);const m=document.createElement("div");m.className="mobile-mini-profile-characteristics";const p=document.getElementById("col-leftest-stats");if(p){const t=[];for(let e=121;e<=126;e++){const r=p.querySelector(`.alert${e}`);r&&t.push(r)}t.length>0&&(t.forEach(t=>{const e=t.cloneNode(!0);e.className=t.className+" mobile-characteristic-badge",e.style.cssText="min-width: 44px; min-height: 44px; margin: 4px;",m.appendChild(e)}),s.appendChild(m))}const u=document.createElement("div");u.className="mobile-mini-profile-skills";const g=document.getElementById("skills-panel");if(g){const t=g.querySelectorAll('.ds_game[class*="alert11"]');t.length>0&&(t.forEach(t=>{const e=t.cloneNode(!0);e.className=t.className+" mobile-skill-item",e.style.cssText="min-height: 44px; margin: 4px; display: flex; align-items: center; justify-content: center;",u.appendChild(e)}),s.appendChild(u))}e.appendChild(s),e.addEventListener("click",t=>{t.target.closest(".mobile-mini-profile-avatar-btn, .mobile-characteristic-badge, .mobile-skill-item")||(e.classList.toggle("collapsed"),e.classList.toggle("expanded"),console.log("[Mobile Mini-Profile] État:",e.classList.contains("expanded")?"déplié":"replié"))});const b=document.querySelector(".navbar"),h=document.getElementById("content")||document.body;b&&b.nextSibling?b.parentNode.insertBefore(e,b.nextSibling):h.insertBefore(e,h.firstChild),console.log("[Mobile Mini-Profile] Créé avec succès"),console.log("  - Nom:",t.name),console.log("  - Argent:",t.money),console.log("  - Horloge:",t.clock),console.log("  - PV:",t.gauges.pv?`${t.gauges.pv.current}/${t.gauges.pv.max}`:"N/A")}()}r.register("initMiniProfile",t,40),window.KralandMobile&&(window.KralandMobile.initMiniProfile=t)}(),function(){function t(){document.body.classList.contains("mobile-mode")&&function(){if(!document.body.classList.contains("mobile-mode"))return;if(document.querySelector(".mobile-quick-actions"))return;if(!window.location.pathname.startsWith("/jouer/"))return;const t=document.getElementById("player-actions-section");if(!t)return void console.warn("[Mobile Quick Actions] Section actions non trouvée");const e=t.querySelectorAll("a.btn, button.btn");if(0===e.length)return void console.warn("[Mobile Quick Actions] Aucun bouton trouvé");const r=document.createElement("div");r.className="btn-group btn-group-justified mobile-quick-actions",r.setAttribute("role","group"),r.setAttribute("data-task","1.5"),e.forEach(t=>{const e=document.createElement("div");e.className="btn-group",e.setAttribute("role","group");const o=t.cloneNode(!0);o.classList.add("mobile-quick-action");const a=o.querySelector("i"),n=o.textContent.trim();if(o.innerHTML="",a){const t=a.cloneNode(!0);t.classList.add("mobile-quick-action-icon"),o.appendChild(t)}const i=document.createElement("span");i.className="mobile-quick-action-label",i.textContent=n,o.appendChild(i),e.appendChild(o),r.appendChild(e)});const o=document.querySelector(".navbar");o&&o.nextSibling?o.parentNode.insertBefore(r,o.nextSibling):document.body.insertBefore(r,document.body.firstChild),console.log("[Mobile Quick Actions] Créées avec",e.length,"actions")}()}r.register("initQuickActions",t,50),window.KralandMobile&&(window.KralandMobile.initQuickActions=t)}(),function(){function t(){if(!e())return;if("/"!==window.location.pathname&&"/accueil"!==window.location.pathname&&!window.location.pathname.endsWith("/"))return;const t=document.querySelector(".carousel");t?(t.remove(),console.log("[Homepage Carousel] Carousel supprimé en mode mobile")):console.log("[Homepage Carousel] Carousel non trouvé sur la page")}r.register("removeHomepageCarousel",t,5),window.KralandMobile&&(window.KralandMobile.removeHomepageCarousel=t)}(),function(){function t(){document.body.classList.contains("mobile-mode")&&function(){if(!document.body.classList.contains("mobile-mode"))return;if(document.querySelector(".mobile-tab-bar"))return;if(!window.location.pathname.startsWith("/jouer/"))return;const t=function(){const t=[];return[{pattern:"/jouer/plateau",href:"/jouer/plateau",label:"Agir",icon:"fa-bolt"},{pattern:"/jouer/materiel",href:"/jouer/materiel",label:"Matériel",icon:"fa-cube"},{pattern:"/jouer/perso",href:"/jouer/perso",label:"Personnage",icon:"fa-user"},{pattern:"/jouer/bat",href:"/jouer/bat",label:"Bâtiments",icon:"fa-home"},{pattern:"/jouer/pnj",href:"/jouer/pnj",label:"Employés",icon:"fa-users"}].forEach(e=>{const r=document.querySelector(`a[href*="${e.pattern}"]`);t.push({href:r?r.getAttribute("href"):e.href,text:r&&r.textContent.trim()||e.label,pattern:e.pattern,icon:e.icon})}),t}();if(0===t.length)return void console.warn("[Mobile Tab Bar] Aucun lien de navigation disponible");const e=document.createElement("ul");e.className="nav nav-tabs mobile-tab-bar",e.setAttribute("role","tablist"),t.forEach(t=>{const r=document.createElement("li");r.setAttribute("role","presentation");const o=document.createElement("a");o.href=t.href,o.setAttribute("role","tab");const a=document.createElement("i");a.className=`fa ${t.icon} mobile-tab-icon`;const n=document.createElement("span");n.className="mobile-tab-label",n.textContent=t.text,o.appendChild(a),o.appendChild(n),window.location.pathname.includes(t.pattern)?(r.classList.add("active"),o.setAttribute("aria-selected","true")):o.setAttribute("aria-selected","false"),r.appendChild(o),e.appendChild(r)});const r=document.querySelector(".navbar")||document.querySelector("header")||document.body.firstElementChild;r&&r.nextSibling?r.parentNode.insertBefore(e,r.nextSibling):document.body.insertBefore(e,document.body.firstChild),function(t){const e=()=>{const e=t.scrollLeft+t.clientWidth>=t.scrollWidth-5;t.classList.toggle("scrolled-end",e)};t.addEventListener("scroll",e),setTimeout(e,100),window.addEventListener("resize",e)}(e),setTimeout(()=>function(t){const e=t.querySelector("li.active > a");if(!e)return;const r=t.getBoundingClientRect(),o=e.getBoundingClientRect(),a=o.left-r.left-r.width/2+o.width/2;t.scrollTo({left:t.scrollLeft+a,behavior:"smooth"})}(e),100),console.log("[Mobile Tab Bar] Créée avec",t.length,"onglets")}()}window.KralandMobile&&(window.KralandMobile.initTabBar=t),r.register("initTabBar",t,30)}(),function(){const t="kraland_dismissed_alerts";function e(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Alerts Memory] Erreur lecture localStorage:",t),[]}}function r(t){return t.id?t.id:"alert_"+function(t){let e=0;for(let r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e&=e;return Math.abs(e).toString(36)}(t.textContent.trim().replace(/\s+/g," "))}function o(){!function(){const t=e();if(0===t.length)return;const o=document.querySelectorAll(".alert.alert-dismissible");let a=0;o.forEach(e=>{const o=r(e);t.includes(o)&&(e.style.display="none",a++)}),a>0&&console.log(`[Alerts Memory] ${a} alerte(s) masquée(s) automatiquement`)}(),function(){const o=document.querySelectorAll(".alert.alert-dismissible");o.forEach(o=>{const a=o.querySelector('.close, [data-dismiss="alert"]');a&&a.addEventListener("click",function(){!function(r){try{const o=e();o.includes(r)||(o.push(r),localStorage.setItem(t,JSON.stringify(o)),console.log("[Alerts Memory] Alerte mémorisée:",r))}catch(t){console.warn("[Alerts Memory] Erreur sauvegarde localStorage:",t)}}(r(o))})}),console.log(`[Alerts Memory] Surveillance activée pour ${o.length} alerte(s)`)}()}function a(){if(!window.location.pathname.includes("/profil/interface"))return;const r=setInterval(()=>{const o=document.querySelector("#kr-tamper-theme-form");if(!o)return;clearInterval(r);const a=document.createElement("div");a.className="form-group",a.style.marginTop="20px",a.style.paddingTop="15px",a.style.borderTop="1px solid rgba(255, 255, 255, 0.1)";const n=document.createElement("label");n.className="col-sm-3 control-label",n.style.paddingLeft="0px",n.style.paddingRight="0px",n.textContent="Alertes";const i=document.createElement("div");i.className="col-sm-9",i.style.paddingLeft="0px";const l=document.createElement("button");l.type="button",l.className="btn btn-warning kr-reset-alerts-btn",l.style.width="33.333%",l.style.display="inline-block";const d=document.createElement("span");d.className="glyphicon glyphicon-refresh",d.style.marginRight="5px";const s=document.createTextNode("Réinitialiser les alertes fermées");l.appendChild(d),l.appendChild(s),l.addEventListener("click",function(){const r=e().length;0!==r?confirm(`Voulez-vous vraiment réinitialiser ${r} alerte(s) fermée(s) ? Elles réapparaîtront lors du prochain chargement de page.`)&&(localStorage.removeItem(t),console.log("[Alerts Memory] Alertes mémorisées effacées"),d.className="glyphicon glyphicon-ok",l.textContent="",l.appendChild(d),l.appendChild(document.createTextNode(" "+(1===r?"1 alerte réinitialisée !":`${r} alertes réinitialisées !`))),l.className="btn btn-success kr-reset-alerts-btn",m(),setTimeout(()=>{d.className="glyphicon glyphicon-refresh",l.textContent="",l.appendChild(d),l.appendChild(document.createTextNode(" Réinitialiser les alertes fermées")),l.className="btn btn-warning btn-block"},3e3)):alert("Aucune alerte fermée à réinitialiser.")});const c=document.createElement("p");function m(){var t;c.textContent=0===(t=e().length)?"Aucune alerte actuellement masquée":1===t?"1 alerte actuellement masquée":`${t} alertes actuellement masquées`}c.className="help-block",c.style.display="inline-block",c.style.marginTop="0",c.style.marginLeft="10px",c.style.verticalAlign="middle",c.style.fontSize="12px",c.style.opacity="0.7",m(),i.appendChild(l),i.appendChild(c),a.appendChild(n),a.appendChild(i),o.parentNode.insertBefore(a,o.nextSibling),console.log("[Alerts Memory] Bouton de réinitialisation ajouté")},100)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o(),"loading"===document.readyState?(document.addEventListener("DOMContentLoaded",o),document.addEventListener("DOMContentLoaded",a)):(o(),a()),window.KralandMobile&&(window.KralandMobile.clearDismissedAlerts=function(){localStorage.removeItem(t),console.log("[Alerts Memory] Alertes mémorisées effacées")})}(),function(){function t(){const t=window.location.pathname;if("/"!==t&&"/accueil"!==t&&!t.startsWith("/accueil"))return;const e=Array.from(document.querySelectorAll("h4.list-group-item-heading.count")).find(t=>{const e=t.textContent.trim();return!/^\d+$/.test(e)&&e.length>0});if(!e)return void console.log("[Welcome Message] Nom d'utilisateur non trouvé");const r=e.textContent.trim();r.startsWith("Bienvenu")||(e.textContent="Bienvenu "+r,console.log("[Welcome Message] Message de bienvenue ajouté pour:",r))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}(),function(){function t(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.querySelectorAll(".dashboard-section");let e=0;t.forEach(t=>{const r=t.querySelector(".dashboard-section-header"),o=t.querySelector(".dashboard-group-title");if(r&&o){const r=t.classList.contains("dashboard-section-mygroup");!function(t,e){const r=t.querySelector(".dashboard-section-header"),o=t.querySelector(".dashboard-cards-grid");if(!r||!o)return;r.classList.add("dashboard-section-header-accordion");const a=e;o.classList.toggle("collapsed",!a),r.classList.toggle("expanded",a);const n=document.createElement("i");n.className="fa fa-chevron-down accordion-icon",r.appendChild(n),r.style.cursor="pointer",r.addEventListener("click",e=>{if(e.target.closest(".dashboard-group-buttons"))return;const a=!o.classList.contains("collapsed");o.classList.toggle("collapsed",a),r.classList.toggle("expanded",!a),console.log("[Group Accordion]",t.querySelector(".dashboard-group-title")?.textContent,a?"collapsed":"expanded")}),console.log("[Group Accordion] Groupe configuré:",t.querySelector(".dashboard-group-title")?.textContent,"état initial:",a?"ouvert":"fermé")}(t,r),e++}}),console.log("[Groups Accordion] Initialisé pour",e,"groupes")}window.KralandMobile&&(window.KralandMobile.initGroupsAccordion=t),r.register("initGroupsAccordion",t,70)}(),r.register("Commerce Accordion",function(){if(!e())return;if(!window.location.href.includes("jouer/plateau"))return;const t=["Nourriture","Repas","Boissons","Bons d'état / Loterie","Services"],r=[];document.querySelectorAll("h4.list-group-item-heading").forEach(e=>{const o=e.textContent.trim();if(t.includes(o)){const t=e.parentElement;t&&t.classList.contains("list-group-item")&&r.push({name:o,div:t,h4:e})}}),0!==r.length&&(console.log(`[Commerce Accordion] Trouvé ${r.length} catégories`),r.forEach((t,e)=>{const r=[];let o=t.div.nextElementSibling;for(;o;)if(o.classList){if(o.classList.contains("ds_forum")&&o.querySelector("h4.list-group-item-heading"))break;"A"===o.tagName&&o.classList.contains("ds_game")&&r.push(o),o=o.nextElementSibling}else o=o.nextElementSibling;const a=document.createElement("div");if(a.className="commerce-products-container",r.forEach(t=>{a.appendChild(t)}),!t.div||!t.div.parentElement||!t.h4)return void console.warn(`[Commerce Accordion] ${t.name}: éléments manquants`);t.div.parentElement.insertBefore(a,t.div.nextSibling),t.div.classList.add("commerce-category-header");const n=0===e;n?t.div.classList.add("expanded"):(a.classList.add("collapsed"),t.div.classList.add("collapsed"));const i=document.createElement("i");i.className="fa fa-chevron-down accordion-icon",t.h4&&t.h4.appendChild&&t.h4.appendChild(i),t.div.style.cursor="pointer",t.div.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const r=!a.classList.contains("collapsed");a.classList.toggle("collapsed",r),t.div.classList.toggle("collapsed",r),t.div.classList.toggle("expanded",!r),console.log(`[Commerce Accordion] ${t.name}: ${r?"fermé":"ouvert"}`)}),console.log(`[Commerce Accordion] ${t.name}: ${r.length} produits, état initial: ${n?"ouvert":"fermé"}`)}))}),r.register("Building Collapse",function(){if(!e())return;const t=Array.from(document.querySelectorAll("h3.panel-title")).find(t=>t.textContent.includes("Bâtiment"));if(!t)return;const r=t.parentElement;if(!r)return;const o=r.nextElementSibling;if(!o||!o.classList.contains("panel-body"))return;r.classList.add("building-section-header"),o.classList.add("building-section-content");const a=document.createElement("i");a.className="fa fa-chevron-down accordion-icon",r.appendChild(a),r.classList.add("expanded"),r.style.cursor="pointer",r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const e=!o.classList.contains("collapsed");o.classList.toggle("collapsed",e),r.classList.toggle("collapsed",e),r.classList.toggle("expanded",!e),console.log("[Building Section] "+(e?"fermé":"ouvert"))}),console.log("[Building Section] Initialisé - section collapsible")}),r.register("initNavigationRow",function(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.querySelector(".navbar");if(!t)return;const e=document.querySelector('img[alt="Sortir"]');if(!e||!e.parentElement)return;const r=e.parentElement,o=r.querySelector('map[name="exitmap"]'),a=Array.from(document.querySelectorAll('img[src*="/bat/bat"]'));if(0===a.length)return;const n=a.filter(t=>{let e=t;for(;e&&e!==document.body;){if(e.classList&&e.classList.contains("kr-navigation-row"))return!1;e=e.parentElement}return!0});if(n.sort((t,e)=>parseInt(t.src.match(/bat(\d+)\.gif/)?.[1]||"999")-parseInt(e.src.match(/bat(\d+)\.gif/)?.[1]||"999")),0===n.length)return;const i=r.closest(".row.center");i&&(i.style.display="none");const l=n.map(t=>t.closest("a")).filter(t=>null!==t);if(0===l.length)return;const d=document.createElement("div");if(d.className="kr-navigation-row",d.setAttribute("role","group"),e&&o){const t=document.createElement("div");t.className="btn-group kr-direction-cross",t.setAttribute("role","group");const r=document.createElement("div");r.className="btn btn-default alert11 mini kr-direction-link";const a=e.cloneNode(!0);a.style.width="60px",a.style.height="60px",a.style.display="block";const n=o.cloneNode(!0);r.addEventListener("click",t=>{const e=r.getBoundingClientRect(),o=t.clientX-e.left,a=t.clientY-e.top,i=n.querySelectorAll("area");for(const e of i)if("rect"===e.shape){const r=e.coords.split(",").map(t=>parseInt(t)),[n,i,l,d]=r;if(o>=n&&o<=l&&a>=i&&a<=d){t.preventDefault(),t.stopPropagation();const r=e.href;return void(r&&"#"!==r&&(window.location.href=r))}}}),r.appendChild(a),r.appendChild(n),t.appendChild(r),d.appendChild(t)}l.forEach(t=>{const e=document.createElement("div");e.className="btn-group kr-room-access-card",e.setAttribute("role","group");const r=t.cloneNode(!0);r.className="btn btn-default alert11 mini kr-room-link",r.addEventListener("click",t=>{t.stopPropagation();const e=r.href;e&&"#"!==e&&(window.location.href=e)}),e.appendChild(r),d.appendChild(e)}),t.parentNode.insertBefore(d,t.nextSibling),console.log(`[Navigation Row] Initialisée avec croix directionnelle et ${l.length} accès aux pièces`)},60),window.innerWidth<768&&window.location.hash&&"#top"!==window.location.hash){const t=history.scrollRestoration;history.scrollRestoration="manual";const e=window.location.pathname+window.location.search;history.replaceState(null,"",e);const r=()=>window.scrollTo(0,0);r(),"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",r),window.addEventListener("load",r),setTimeout(()=>{history.scrollRestoration=t},500)}r.register("initNewsToggle",function(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.getElementById("slide-submenu"),e=document.getElementById("player-header-section");if(t&&e){function r(e){t.innerHTML=e?"▼":"×",t.setAttribute("aria-label",e?"Déplier les nouvelles":"Replier les nouvelles"),t.setAttribute("title",e?"Déplier":"Replier")}const o="true"===localStorage.getItem("kr-news-collapsed");o&&e.classList.add("kr-news-collapsed"),r(o),t.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.classList.toggle("kr-news-collapsed");const o=e.classList.contains("kr-news-collapsed");localStorage.setItem("kr-news-collapsed",o),r(o)},{capture:!0}),console.log("[News Toggle] Initialisé")}},80);const o={BUNDLED_CSS:':root{--kr-primary:#8b0f0e;--kr-primary-dark:#700b09;--kr-gold:#C69100;--kr-highlight:#c41e3a;--kr-highlight-reverse:#f9d9de;--kr-surface:#fff;--kr-text:#0f1724;--kr-muted:#6b7280;--kr-navbar-bg:#111315;--kr-radius:.5rem;--kr-avatar-size:120px;--kr-bg-page:#f5f5f5;--kr-bg-surface:#fff;--kr-bg-elevated:#fff;--kr-bg-hover:rgb(0,0,0,0.02);--kr-bg-active:rgb(0,0,0,0.05);--kr-text-primary:#0f1724;--kr-text-secondary:#6b7280;--kr-text-muted:#9ca3af;--kr-text-inverse:#fff;--kr-border-default:rgb(0,0,0,0.08);--kr-border-strong:rgb(0,0,0,0.15);--kr-shadow-sm:0 1px 2px rgb(0,0,0,0.05);--kr-shadow-md:0 4px 6px rgb(0,0,0,0.07);--kr-shadow-lg:0 10px 15px rgb(0,0,0,0.1);--kr-white:#fff;--kr-focus-ring:rgb(164,18,13,0.22);--kr-focus-ring-light:rgb(164,18,13,0.18);--kr-alert-info-bg:rgb(164,18,13,0.06);--kr-alert-info-border:rgb(164,18,13,0.14);--kr-btn-shadow:rgb(165,18,13,0.12);--kr-badge-danger:#dc3545;--kr-badge-danger-border:#bd2130;--kr-badge-pnj:#d9534f;--kr-bootstrap-blue:#337ab7;--kr-nation-1:#C41E3A;--kr-nation-2:#C69100;--kr-nation-3:#FF0;--kr-nation-4:#0033A0;--kr-nation-5:#0B6623;--kr-nation-6:#6A0DAD;--kr-nation-7:#6B7280;--kr-nation-8:#0A6B2D;--kr-nation-9:#a70;--kr-nation-bg-1:rgb(255, 128, 128);--kr-nation-bg-2:rgb(170, 112, 0);--kr-nation-bg-3:rgb(255, 255, 128);--kr-nation-bg-4:rgb(128, 128, 255);--kr-nation-bg-5:rgb(128, 255, 128);--kr-nation-bg-6:rgb(204, 128, 255);--kr-nation-bg-7:rgb(170, 170, 170);--kr-nation-bg-8:rgb(115, 151, 115);--kr-nation-bg-9:rgb(170, 170, 68);--kr-nation-bg-10:rgb(204, 255, 255);--mobile-tab-bar-height:48px;--mobile-touch-target:44px;--mobile-spacing-xs:4px;--mobile-spacing-sm:8px;--mobile-spacing-md:12px;--mobile-spacing-lg:16px;--mobile-spacing-xl:24px;--mobile-radius:8px;--mobile-radius-lg:16px;--z-header:1000;--z-tab-bar:999;--z-bottom-sheet:998;--z-drawer:1001;--transition-fast:0.15s ease;--transition-normal:0.3s ease;--transition-slow:0.5s ease;--kr-gauge-pv:#28a745;--kr-gauge-pm:#007bff;--kr-gauge-pp:#ffc107;--kr-overlay-light-10:rgba(255, 255, 255, 0.1);--kr-overlay-light-05:rgba(255, 255, 255, 0.05);--kr-overlay-light-20:rgba(255, 255, 255, 0.2);--kr-overlay-dark-20:rgba(0, 0, 0, 0.2);--kr-overlay-dark-30:rgba(0, 0, 0, 0.3);--kr-overlay-dark-125:rgba(0, 0, 0, 0.125)}html.kr-theme-variant-empire-brun{--kr-primary:#5E3B2D;--kr-highlight:#C69100}html.kr-theme-variant-paladium{--kr-primary:#D4AF37;--kr-highlight:#044c17}html.kr-theme-variant-theocratie-seelienne{--kr-primary:#0033A0;--kr-highlight:#2d5fcb}html.kr-theme-variant-paradigme-vert{--kr-primary:#0B6623;--kr-highlight:#063803}html.kr-theme-variant-khanat-elmerien{--kr-primary:#6A0DAD;--kr-highlight:#7b4c9c}html.kr-theme-variant-confederation-libre{--kr-primary:#6B7280;--kr-highlight:#475369}html.kr-theme-variant-royaume-ruthvenie{--kr-primary:#0A6B2D;--kr-highlight:#C41E3A}html.kr-theme-variant-empire-brun-dark{--kr-primary:#7a5240;--kr-primary-dark:#5E3B2D;--kr-highlight:#d4a574;--kr-highlight-reverse:#1a0f0a;--kr-bg-page:#12100d;--kr-bg-surface:#1e1a15;--kr-bg-elevated:#2a251f;--kr-text-primary:#f5f1ed;--kr-text-secondary:#b8a997;--kr-text-muted:#8a7968;--kr-text-inverse:#12100d;--kr-form-bg:#3a332b;--kr-form-bg-focus:#423a31;--kr-nation-2:#d4a574;--kr-nation-4:#74b9ff;--kr-nation-5:#55efc4;--kr-nation-6:#a29bfe;--kr-nation-7:#b2bec3;--kr-nation-8:#81c784}html.kr-theme-variant-confederation-libre-dark,html.kr-theme-variant-empire-brun-dark,html.kr-theme-variant-khanat-elmerien-dark,html.kr-theme-variant-paladium-dark,html.kr-theme-variant-paradigme-vert-dark,html.kr-theme-variant-royaume-ruthvenie-dark,html.kr-theme-variant-theocratie-seelienne-dark{--kr-bg-hover:rgba(255, 255, 255, 0.03);--kr-bg-active:rgba(255, 255, 255, 0.06);color-scheme:dark;--kr-border-default:rgb(255,255,255,0.08);--kr-border-strong:rgb(255,255,255,0.15);--kr-shadow-sm:0 1px 3px rgb(0,0,0,0.4);--kr-shadow-md:0 4px 8px rgb(0,0,0,0.5);--kr-shadow-lg:0 10px 20px rgb(0,0,0,0.6);--kr-nation-1:#ff8080;--kr-nation-3:#ffe066;--kr-nation-9:#c4b958}html.kr-theme-variant-paladium-dark{--kr-primary:#e6c76e;--kr-primary-dark:#D4AF37;--kr-highlight:#4a9d5f;--kr-highlight-reverse:#021a0a;--kr-bg-page:#0f0e0a;--kr-bg-surface:#1a1810;--kr-bg-elevated:#252015;--kr-text-primary:#f5f3e8;--kr-text-secondary:#c4b896;--kr-text-muted:#938567;--kr-text-inverse:#0f0e0a;--kr-form-bg:#3a3420;--kr-form-bg-focus:#43392a;--kr-nation-2:#e6c76e;--kr-nation-4:#74b9ff;--kr-nation-5:#55efc4;--kr-nation-6:#a29bfe;--kr-nation-7:#b2bec3;--kr-nation-8:#81c784}html.kr-theme-variant-confederation-libre-dark,html.kr-theme-variant-khanat-elmerien-dark,html.kr-theme-variant-paradigme-vert-dark,html.kr-theme-variant-royaume-ruthvenie-dark,html.kr-theme-variant-theocratie-seelienne-dark{--kr-nation-2:#d4a574}html.kr-theme-variant-theocratie-seelienne-dark{--kr-primary:#5a8fd9;--kr-primary-dark:#2d5fcb;--kr-highlight:#80b3ff;--kr-highlight-reverse:#000d1f;--kr-bg-page:#0a0e15;--kr-bg-surface:#12182a;--kr-bg-elevated:#1a2438;--kr-text-primary:#e8f0ff;--kr-text-secondary:#9db5d6;--kr-text-muted:#6b7f9e;--kr-text-inverse:#0a0e15;--kr-form-bg:#2a3447;--kr-form-bg-focus:#323d54;--kr-nation-4:#80b3ff;--kr-nation-5:#55efc4;--kr-nation-6:#a29bfe;--kr-nation-7:#b2bec3;--kr-nation-8:#81c784}html.kr-theme-variant-confederation-libre-dark,html.kr-theme-variant-khanat-elmerien-dark,html.kr-theme-variant-paradigme-vert-dark,html.kr-theme-variant-royaume-ruthvenie-dark{--kr-nation-4:#74b9ff}html.kr-theme-variant-paradigme-vert-dark{--kr-primary:#4d9c61;--kr-primary-dark:#2a7a3d;--kr-highlight:#70c784;--kr-highlight-reverse:#021508;--kr-bg-page:#0a120d;--kr-bg-surface:#0f1a13;--kr-bg-elevated:#1a2820;--kr-text-primary:#e8f5ed;--kr-text-secondary:#a0c4ab;--kr-text-muted:#6d8a75;--kr-text-inverse:#0a120d;--kr-form-bg:#2a3d30;--kr-form-bg-focus:#324539;--kr-nation-5:#70c784;--kr-nation-6:#a29bfe;--kr-nation-7:#b2bec3;--kr-nation-8:#81c784}html.kr-theme-variant-confederation-libre-dark,html.kr-theme-variant-khanat-elmerien-dark,html.kr-theme-variant-royaume-ruthvenie-dark{--kr-nation-5:#55efc4}html.kr-theme-variant-khanat-elmerien-dark{--kr-primary:#96c;--kr-primary-dark:#7b4c9c;--kr-highlight:#b794d9;--kr-highlight-reverse:#1a0425;--kr-bg-page:#0f0a15;--kr-bg-surface:#1a121f;--kr-bg-elevated:#251a2d;--kr-text-primary:#f0e8ff;--kr-text-secondary:#bba0d6;--kr-text-muted:#857299;--kr-text-inverse:#0f0a15;--kr-form-bg:#3a2f47;--kr-form-bg-focus:#443854;--kr-nation-6:#b794d9;--kr-nation-7:#b2bec3;--kr-nation-8:#81c784}html.kr-theme-variant-confederation-libre-dark,html.kr-theme-variant-royaume-ruthvenie-dark{--kr-nation-6:#a29bfe}html.kr-theme-variant-confederation-libre-dark{--kr-primary:#9ca3af;--kr-primary-dark:#6b7280;--kr-highlight:#c2c9d6;--kr-highlight-reverse:#0f1115;--kr-bg-page:#0e1013;--kr-bg-surface:#16181c;--kr-bg-elevated:#1f2228;--kr-text-primary:#e8eaed;--kr-text-secondary:#b8bcc4;--kr-text-muted:#7e8591;--kr-text-inverse:#0e1013;--kr-form-bg:#2d3139;--kr-form-bg-focus:#363a43;--kr-nation-7:#c2c9d6;--kr-nation-8:#81c784}html.kr-theme-variant-royaume-ruthvenie-dark{--kr-primary:#4a9d61;--kr-primary-dark:#2a7a3d;--kr-highlight:#ff6b85;--kr-highlight-reverse:#1a0408;--kr-bg-page:#0d1210;--kr-bg-surface:#141a16;--kr-bg-elevated:#1d2621;--kr-text-primary:#ecf5f0;--kr-text-secondary:#a5c4b0;--kr-text-muted:#708a79;--kr-text-inverse:#0d1210;--kr-form-bg:#2d3d33;--kr-form-bg-focus:#36463b;--kr-nation-7:#b2bec3;--kr-nation-8:#70c784}#top,hr[style*="border-top: 1px solid"][style*="337ab7"],html.kr-hide-footer-quote .footer-quote{display:none!important}body,html,nav.navbar{height:auto!important}body{min-height:100vh!important;display:flex;flex-direction:column;margin:0!important;padding-top:60px}nav.navbar{position:fixed!important;top:0!important;left:0!important;right:0!important;z-index:1030!important;max-height:60px!important}#content{flex:1 0 auto}footer{flex-shrink:0;width:100%}.container{max-width:1608px!important;width:1608px!important}#skills-panel{display:block!important;border:1px solid rgb(0,0,0,.06)!important;border-radius:5px!important;background-color:var(--kr-white)!important}.navbar-brand{display:flex!important;align-items:center!important;padding-top:0!important;padding-bottom:0!important}.navbar-brand img.kr-logo{height:28px;vertical-align:middle}.navbar-nav>li>a{color:var(--kr-white)!important}.form-control.form-control{border-radius:.4rem;border:1px solid rgb(0,0,0,.08);padding:.6rem .8rem;font-size:.95rem}.form-control:focus{box-shadow:0 0 0 .18rem var(--kr-focus-ring);border-color:var(--kr-primary);outline:0}textarea.form-control.form-control{font-size:1.4rem!important;line-height:1.6!important}.form-group label{color:var(--kr-text);font-weight:600}input[type=checkbox],input[type=radio]{accent-color:var(--kr-primary)!important}input[type=checkbox]:focus,input[type=radio]:focus{outline:0;box-shadow:0 0 0 .12rem var(--kr-focus-ring-light)!important}input[type=checkbox]:checked{border-color:var(--kr-primary)!important}.badge,.label{border-color:var(--kr-primary-dark)}.badge,.bg-info,.label{background-color:var(--kr-primary);color:var(--kr-white)}.badge-danger{background-color:var(--kr-badge-danger)!important;color:var(--kr-white)!important;border-color:var(--kr-badge-danger-border)!important}.alert.alert-info{background-color:var(--kr-alert-info-bg);border-color:var(--kr-alert-info-border)}.alert p,.alert strong,.alert.alert-info{color:var(--kr-text)}.list-group-item{border:0;padding:.6rem .75rem}.list-group-item.btn{border:0!important}.list-group-item.active,.list-group-item.active a,.list-group-item.active:focus,.list-group-item.active:hover{background-color:var(--kr-primary)!important;border-color:var(--kr-primary-dark)!important;color:var(--kr-surface)!important}.list-group-item:hover{color:var(--kr-primary-dark);background-color:rgb(0,0,0,.02)}.img-circle{width:var(--kr-avatar-size);height:var(--kr-avatar-size);min-width:var(--kr-avatar-size);min-height:var(--kr-avatar-size);object-fit:cover;display:inline-block;border-radius:50%}.img-circle.img-responsive,.img-circle.img-thumbnail{max-width:none!important;width:var(--kr-avatar-size);height:var(--kr-avatar-size)}.col-md-2.sidebar .avatar,.col-md-3.sidebar .avatar{margin-bottom:.5rem}.list-group a.list-group-item.ds_user,.list-group-item.ds_user{position:relative;min-height:var(--kr-avatar-size)!important;padding-right:calc(var(--kr-avatar-size) + 1rem)!important;display:flex!important;align-items:center!important}.list-group-item.ds_user .pull-right{position:absolute!important;right:.75rem!important;top:50%!important;transform:translateY(-50%)!important}#player-header-section .nopadding,#player-header-section .nopadding-right,#player-main-panel .nopadding,#player-main-panel .nopadding-right,#player-vitals-section .nopadding,#player-vitals-section .nopadding-right{padding-left:15px!important;padding-right:15px!important}#player-main-panel>.row>.nopadding:first-child{padding-left:10px!important;padding-right:10px!important}#player-vitals-section[style*=padding-left]{padding-left:0!important}#player-actions-section{display:flex;flex-wrap:wrap;gap:.5rem;padding:0 15px!important}.kr-quick-access-buttons .col-xs-6{margin-bottom:10px}#player-actions-section hr{width:100%;margin:.5rem 0}.carousel-caption{background:linear-gradient(180deg,rgb(0,0,0,.55),rgb(0,0,0,.35));padding:1.4rem;padding-bottom:56px;border-radius:.6rem;color:var(--kr-white)}.item img[class*=-slide]{display:block;margin:0 auto;max-width:100%;height:auto}a.carousel-control.left,a.carousel-control.right{background-image:none}.modal{display:flex!important;position:fixed!important;align-items:flex-start;justify-content:center;pointer-events:auto;padding-top:30px}.modal,.modal.in{overflow-y:hidden!important}.modal-content,.modal-dialog{display:flex;flex-direction:column}.modal-dialog{width:900px;max-width:90vw;margin:0 auto 30px;max-height:calc(100vh - 60px);pointer-events:auto;overflow-y:auto}.modal-content{max-height:100%;overflow:hidden}.modal-body{overflow-y:auto;flex:1 1 auto}.modal-footer,.modal-header{flex-shrink:0}.pagination>li.active>a{color:var(--kr-surface);background-color:var(--kr-primary-dark);border-color:var(--kr-primary-dark)}.pagination>li>a,.pagination>li>a:hover{color:var(--kr-primary)}.pagination>li.active>a:hover{color:var(--kr-surface);background-color:var(--kr-primary);border-color:var(--kr-primary)}.bg-primary{background-color:var(--kr-primary)!important;color:var(--kr-surface)!important}a:link,a:visited{color:var(--kr-highlight);text-decoration:none;transition:color .12s ease,opacity .12s ease}a:focus,a:hover{color:var(--kr-primary-dark);text-decoration:underline;outline:0}a.btn-primary,button.btn-primary{background-color:var(--kr-primary);border-color:var(--kr-primary-dark);color:var(--kr-highlight-reverse);box-shadow:0 6px 18px var(--kr-btn-shadow)}a.btn-primary:focus,a.btn-primary:hover,button.btn-primary:focus,button.btn-primary:hover{background-color:var(--kr-primary-dark)}footer .container.white{position:relative}.container.white .kraland-back-to-top{position:fixed;right:20px;bottom:20px;z-index:1000;transform:none}.dashboard-card-actions>div,.dashboard.dashboard-flex{display:flex;flex-direction:column;gap:15px}.dashboard-section{background:var(--kr-surface);border-radius:8px;overflow:hidden;box-shadow:0 2px 4px rgb(0,0,0,.08)}.dashboard-section-header{background:var(--kr-primary);color:var(--kr-white);padding:3px 8px;font-size:9px;font-weight:600;display:flex;align-items:center;gap:5px}.dashboard-group-buttons{display:flex;gap:6px}.dashboard-group-buttons .btn{background-color:rgb(255,255,255,.15);border:1px solid rgb(255,255,255,.25);color:var(--kr-white);padding:4px 8px;font-size:12px;border-radius:4px;transition:all .2s ease}.dashboard-group-buttons .btn:hover{background-color:rgb(255,255,255,.25);border-color:rgb(255,255,255,.4);transform:scale(1.05)}.dashboard-group-buttons .btn i{font-size:12px}.dashboard-group-title{flex:1;text-transform:uppercase;letter-spacing:.5px}.dashboard-cards-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px;padding:12px}.dashboard-cards-large{grid-template-columns:repeat(auto-fill,minmax(200px,1fr))}.dashboard-card{background:var(--kr-white);border:1px solid rgb(0,0,0,.08);border-radius:6px;overflow:hidden;transition:all .2s ease;position:relative;display:flex;flex-direction:column}.dashboard-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgb(0,0,0,.12);border-color:var(--kr-primary)}.dashboard-card-large{min-height:90px}.dashboard-card-link{display:flex;flex-direction:column;text-decoration:none;color:inherit;flex:1}.dashboard-card-link:hover{text-decoration:none}.dashboard-card-header{display:flex;align-items:center;background:rgb(0,0,0,.02)}.dashboard-card-avatar-wrapper{position:relative;width:82px;height:82px;flex-shrink:0;display:flex;align-items:center;justify-content:center}.dashboard-card-hp-circle{position:absolute;top:0;left:0;width:82px;height:82px;pointer-events:none;z-index:1}.dashboard-card-avatar{width:70px;height:70px;border-radius:50%;object-fit:cover;border:2px solid var(--kr-primary);flex-shrink:0;position:relative;z-index:2}.dashboard-card-large .dashboard-card-avatar{width:70px;height:70px}.dashboard-card-name-container{display:flex;align-items:center;gap:6px;flex:1;min-width:0}.dashboard-card-world{width:20px;height:10px;object-fit:contain;flex-shrink:0}.dashboard-card-name{font-size:11px;font-weight:600;color:var(--kr-text);line-height:1.2;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;flex:1}.dashboard-card-large .dashboard-card-name{font-size:13px}.dashboard-card-body{padding:0 8px 5px;display:flex;flex-direction:column;gap:3px;flex:1;min-height:0}.dashboard-card-status{font-size:9px;color:var(--kr-muted);line-height:1.2;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.dashboard-card-large .dashboard-card-status{font-size:11px;white-space:normal;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.dashboard-card-hp{height:6px;background:rgb(0,0,0,.08);position:relative;margin:0}.dashboard-card-hp-fill{height:100%;transition:width .3s ease,background-color .3s ease;border-radius:0}.dashboard-card-pnj{position:absolute;top:8px;right:8px;background:var(--kr-badge-pnj);color:var(--kr-white);font-size:8px;font-weight:600;padding:2px 5px;border-radius:3px;text-transform:uppercase;letter-spacing:.3px;z-index:1}.dashboard-card-actions{position:absolute;bottom:4px;right:4px;display:flex;flex-direction:row;align-items:center;gap:4px;opacity:.7;transition:opacity .2s ease;z-index:2}.dashboard-card:hover .dashboard-card-actions{opacity:1}.dashboard-card-actions>div{gap:2px}.dashboard-card-actions>div,.dashboard-card-actions>div>div{margin:0!important;padding:0!important;height:auto!important}.dashboard-card-actions a{display:inline-flex;align-items:center;justify-content:center;padding:4px 6px!important;background-color:rgb(0,0,0,.6);border-radius:3px;transition:background-color .2s ease;min-width:24px;height:24px}.dashboard-card-actions a:hover{background-color:rgb(0,0,0,.8)}.dashboard-card-actions a i{color:var(--kr-white);font-size:12px;margin:0}.btn-toolbar .btn:not(.dropdown-menu *){background-color:var(--kr-surface)!important;background-image:none!important;color:var(--kr-primary)!important;border:1px solid rgb(0,0,0,.06)!important;box-shadow:none!important}.btn-toolbar .btn:not(.dropdown-menu *) .fa,.btn-toolbar .btn:not(.dropdown-menu *) .far,.btn-toolbar .btn:not(.dropdown-menu *) .fas,.btn-toolbar .btn:not(.dropdown-menu *) i{color:inherit!important}html[class*=-dark] body{background-color:var(--kr-bg-page);color:var(--kr-text-primary)}html[class*=-dark] .panel,html[class*=-dark] .panel-default,html[class*=-dark] .panel-heading{background-color:var(--kr-bg-surface);border-color:var(--kr-border-default)}html[class*=-dark] .panel-heading{background-color:var(--kr-bg-elevated);color:var(--kr-text-primary)}html[class*=-dark] .panel-body{background-color:var(--kr-bg-surface);color:var(--kr-text-primary)}html[class*=-dark] .panel-footer,html[class*=-dark] .well{background-color:var(--kr-bg-elevated);border-color:var(--kr-border-default)}html[class*=-dark] .form-group label,html[class*=-dark] .kr-tamper-theme h4,html[class*=-dark] .kr-tamper-theme label,html[class*=-dark] .well,html[class*=-dark] label{color:var(--kr-text-primary)}html[class*=-dark] .kr-tamper-theme .control-label{color:var(--kr-text-secondary)}html[class*=-dark] .modal-content{background-color:var(--kr-bg-surface);border-color:var(--kr-border-default)}html[class*=-dark] .form-control,html[class*=-dark] .modal-body,html[class*=-dark] .modal-footer,html[class*=-dark] .modal-header{background-color:var(--kr-bg-surface);color:var(--kr-text-primary);border-color:var(--kr-border-default)}html[class*=-dark] .form-control{background-color:var(--kr-form-bg)}html[class*=-dark] .form-control::placeholder{color:var(--kr-text-muted)}html[class*=-dark] .form-control:focus{background-color:var(--kr-form-bg-focus);border-color:var(--kr-primary);color:var(--kr-text-primary)}html[class*=-dark] .input-group-addon{background-color:var(--kr-bg-elevated);border-color:var(--kr-border-default);color:var(--kr-text-primary)}html[class*=-dark] .btn-primary{background-color:var(--kr-primary);border-color:var(--kr-primary-dark);color:var(--kr-text-primary)}html[class*=-dark] .btn-primary:active,html[class*=-dark] .btn-primary:focus,html[class*=-dark] .btn-primary:hover{background-color:var(--kr-primary-dark);border-color:var(--kr-primary-dark);color:var(--kr-text-primary)}html[class*=-dark] .btn-default,html[class*=-dark] .table>tbody>tr>th,html[class*=-dark] .table>tfoot>tr>th,html[class*=-dark] .table>thead>tr>th{background-color:var(--kr-bg-elevated);border-color:var(--kr-border-default);color:var(--kr-text-primary)}html[class*=-dark] .btn-default:hover{background-color:var(--kr-bg-active);border-color:var(--kr-border-strong)}html[class*=-dark] .btn-default:active,html[class*=-dark] .btn-default:focus{background-color:var(--kr-bg-hover);border-color:var(--kr-border-strong);color:var(--kr-text-primary)}html[class*=-dark] .list-group-item{background-color:var(--kr-bg-surface);border-color:var(--kr-border-default);color:var(--kr-text-primary)}html[class*=-dark] .list-group-item:hover{background-color:var(--kr-bg-hover)}html[class*=-dark] .list-group-item-heading{color:var(--kr-text-primary)}html[class*=-dark] .list-group-item-text{color:var(--kr-text-secondary)}html[class*=-dark] .dropdown-menu>li>a,html[class*=-dark] .nav-tabs>li>a,html[class*=-dark] .table{color:var(--kr-text-primary)}html[class*=-dark] .table>tbody>tr>td{border-color:var(--kr-border-default)}html[class*=-dark] .table-striped>tbody>tr:nth-of-type(odd){background-color:var(--kr-bg-hover)}html[class*=-dark] .table.table-striped>tbody>tr{background-color:var(--kr-bg-page)}html[class*=-dark] .table.table-striped>tbody>tr:nth-of-type(odd){background-color:var(--kr-bg-elevated)}html[class*=-dark] .table-hover>tbody>tr:hover{background-color:var(--kr-bg-active)}html[class*=-dark] .dropdown-menu{background-color:var(--kr-bg-elevated);border-color:var(--kr-border-strong)}html[class*=-dark] .dropdown-menu>li>a:focus,html[class*=-dark] .dropdown-menu>li>a:hover{background-color:var(--kr-bg-hover);color:var(--kr-text-primary)}html[class*=-dark] .dropdown-menu>.active>a,html[class*=-dark] .dropdown-menu>.active>a:focus,html[class*=-dark] .dropdown-menu>.active>a:hover{background-color:var(--kr-primary);color:var(--kr-text-inverse)}.btn-toolbar .dropdown-menu table img,.dropdown-menu table img{width:32px!important;height:32px!important;object-fit:contain!important;display:block!important;flex-shrink:0!important}html[class*=-dark] .nav-tabs{border-color:var(--kr-border-default)}html[class*=-dark] .nav-tabs>li>a:hover{background-color:var(--kr-bg-hover);border-color:var(--kr-border-default)}html[class*=-dark] .nav-tabs>li.active>a,html[class*=-dark] .nav-tabs>li.active>a:focus,html[class*=-dark] .nav-tabs>li.active>a:hover{background-color:var(--kr-bg-surface);border-color:var(--kr-border-default) var(--kr-border-default) transparent;color:var(--kr-text-primary)}html[class*=-dark] .alert{border-color:var(--kr-border-default);color:var(--kr-text-primary)!important}html[class*=-dark] .alert *{color:inherit!important}html[class*=-dark] .alert a{color:var(--kr-primary)!important;text-decoration:underline}html[class*=-dark] .alert-info{background-color:rgb(122,82,64,.15);border-color:rgb(122,82,64,.3);color:var(--kr-text-primary)}html[class*=-dark] .alert-success{background-color:rgb(34,197,94,.15);border-color:rgb(34,197,94,.3);color:var(--kr-text-primary)}html[class*=-dark] .alert-warning{background-color:rgb(245,158,11,.15);border-color:rgb(245,158,11,.3);color:var(--kr-text-primary)}html[class*=-dark] .alert-danger{background-color:rgb(239,68,68,.15);border-color:rgb(239,68,68,.3);color:var(--kr-text-primary)}html[class*=-dark] #flap,html[class*=-dark] .progress{background-color:var(--kr-bg-elevated)}html[class*=-dark] .dashboard-card{background:var(--kr-bg-surface);border-color:var(--kr-border-default)}html[class*=-dark] .dashboard-card:hover{box-shadow:var(--kr-shadow-md)}html[class*=-dark] .dashboard-card-header{background:var(--kr-bg-hover)}html[class*=-dark] .dashboard-card-name{color:var(--kr-text-primary)}html[class*=-dark] .dashboard-card-status{color:var(--kr-text-muted)}html[class*=-dark] .dashboard-section{background:var(--kr-bg-surface)}html[class*=-dark] .dashboard-card-hp{background:var(--kr-bg-elevated)}html[class*=-dark] .chat li{border-bottom-color:var(--kr-border-default)}html[class*=-dark] .map-box,html[class*=-dark] .panel-body-scroll{background-color:var(--kr-bg-surface)}html[class*=-dark] #flap a.closed,html[class*=-dark] #flap a.open{background:var(--kr-bg-elevated);color:var(--kr-text-primary)}html[class*=-dark] .map-box{border-color:var(--kr-border-default)}html[class*=-dark] .map-box-title{background-color:var(--kr-primary);color:var(--kr-text-inverse)}html[class*=-dark] .map-box-content{color:var(--kr-text-primary)}html[class*=-dark] .map-box-bottom{background-color:var(--kr-primary);color:var(--kr-text-inverse)}html[class*=-dark] .f1{color:var(--kr-nation-1)}html[class*=-dark] .f2{color:var(--kr-nation-2)}html[class*=-dark] .f3{color:var(--kr-nation-3)}html[class*=-dark] .f4{color:var(--kr-nation-4)}html[class*=-dark] .f5{color:var(--kr-nation-5)}html[class*=-dark] .f6{color:var(--kr-nation-6)}html[class*=-dark] .f7{color:var(--kr-nation-7)}html[class*=-dark] .f8{color:var(--kr-nation-8)}html[class*=-dark] .f9{color:var(--kr-nation-9)}html[class*=-dark] .c1{background-color:var(--kr-nation-bg-1)}html[class*=-dark] .c2{background-color:var(--kr-nation-bg-2)}html[class*=-dark] .c3{background-color:var(--kr-nation-bg-3)}html[class*=-dark] .c4{background-color:var(--kr-nation-bg-4)}html[class*=-dark] .c5{background-color:var(--kr-nation-bg-5)}html[class*=-dark] .c6{background-color:var(--kr-nation-bg-6)}html[class*=-dark] .c7{background-color:var(--kr-nation-bg-7)}html[class*=-dark] .c8{background-color:var(--kr-nation-bg-8)}html[class*=-dark] .c9{background-color:var(--kr-nation-bg-9)}html[class*=-dark] .c10{background-color:var(--kr-nation-bg-10)}html[class*=-dark] font[color="#f4ac00"],html[class*=-dark] font[color=f4ac00]{color:#ffbe33!important}html[class*=-dark] font[color="#f77400"],html[class*=-dark] font[color=f77400]{color:#f83!important}html[class*=-dark] font[color="#ed6161"],html[class*=-dark] font[color=ed6161]{color:#ff7a7a!important}html[class*=-dark] .red,html[class*=-dark] font[color="#d50000"],html[class*=-dark] font[color=d50000]{color:#f33!important}html[class*=-dark] font[color=olive]{color:#b3b333!important}html[class*=-dark] font[color="#219c5a"],html[class*=-dark] font[color="219c5a"]{color:#3c7!important}html[class*=-dark] font[color="#006f00"],html[class*=-dark] font[color="006f00"]{color:#0b0!important}html[class*=-dark] font[color=teal]{color:#3cc!important}html[class*=-dark] font[color="#5577bc"],html[class*=-dark] font[color="5577bc"]{color:#79d!important}html[class*=-dark] font[color="#2b2be4"],html[class*=-dark] font[color="2b2be4"]{color:#55f!important}html[class*=-dark] font[color=navy]{color:#55c!important}html[class*=-dark] font[color=purple]{color:#c5c!important}html[class*=-dark] font[color="#4B0082"],html[class*=-dark] font[color="4B0082"],html[class*=-dark] font[color="4b0082"]{color:#85c!important}html[class*=-dark] font[color=maroon]{color:#c55!important}html[class*=-dark] font[color="#5e432d"],html[class*=-dark] font[color="5e432d"]{color:#a75!important}html[class*=-dark] font[color=gray]{color:#aaa!important}html[class*=-dark] font[color="#5a5a5a"],html[class*=-dark] font[color="5a5a5a"]{color:#999!important}html[class*=-dark] font[color="#000000"],html[class*=-dark] font[color="000000"]{color:#ccc!important}html[class*=-dark] .blue{color:#38f!important}html[class*=-dark] [style*="background-color: #f4ac00"],html[class*=-dark] [style*="background-color:#f4ac00"]{background-color:#ffbe33!important}html[class*=-dark] [style*="background-color: #f77400"],html[class*=-dark] [style*="background-color:#f77400"]{background-color:#f83!important}html[class*=-dark] [style*="background-color: #ed6161"],html[class*=-dark] [style*="background-color:#ed6161"]{background-color:#ff7a7a!important}html[class*=-dark] [style*="background-color: #d50000"],html[class*=-dark] [style*="background-color:#d50000"]{background-color:#f33!important}html[class*=-dark] [style*="background-color: #808000"],html[class*=-dark] [style*="background-color:#808000"]{background-color:#b3b333!important}html[class*=-dark] [style*="background-color: #219c5a"],html[class*=-dark] [style*="background-color:#219c5a"]{background-color:#3c7!important}html[class*=-dark] [style*="background-color: #006f00"],html[class*=-dark] [style*="background-color:#006f00"]{background-color:#0b0!important}html[class*=-dark] [style*="background-color: #008080"],html[class*=-dark] [style*="background-color:#008080"]{background-color:#3cc!important}html[class*=-dark] [style*="background-color: #5577bc"],html[class*=-dark] [style*="background-color:#5577bc"]{background-color:#79d!important}html[class*=-dark] [style*="background-color: #2b2be4"],html[class*=-dark] [style*="background-color:#2b2be4"]{background-color:#55f!important}html[class*=-dark] [style*="background-color: #000080"],html[class*=-dark] [style*="background-color:#000080"]{background-color:#55c!important}html[class*=-dark] [style*="background-color: #800080"],html[class*=-dark] [style*="background-color:#800080"]{background-color:#c5c!important}html[class*=-dark] [style*="background-color: #4B0082"],html[class*=-dark] [style*="background-color: #4b0082"],html[class*=-dark] [style*="background-color:#4B0082"],html[class*=-dark] [style*="background-color:#4b0082"]{background-color:#85c!important}html[class*=-dark] [style*="background-color: #800000"],html[class*=-dark] [style*="background-color:#800000"]{background-color:#c55!important}html[class*=-dark] [style*="background-color: #5e432d"],html[class*=-dark] [style*="background-color:#5e432d"]{background-color:#a75!important}html[class*=-dark] [style*="background-color: #808080"],html[class*=-dark] [style*="background-color:#808080"]{background-color:#aaa!important}html[class*=-dark] [style*="background-color: #5a5a5a"],html[class*=-dark] [style*="background-color:#5a5a5a"]{background-color:#999!important}html[class*=-dark] [style*="background-color: #000000"],html[class*=-dark] [style*="background-color:#000000"]{background-color:#ccc!important}html[class*=-dark] ::-webkit-scrollbar-track{background-color:var(--kr-bg-page)}html[class*=-dark] ::-webkit-scrollbar-thumb{background-color:var(--kr-text-muted)}html[class*=-dark] ::-webkit-scrollbar-thumb:hover{background-color:var(--kr-text-secondary)}html[class*=-dark] ::selection{background-color:var(--kr-primary);color:var(--kr-text-inverse)}html[class*=-dark] footer{background-color:var(--kr-bg-elevated);border-top:1px solid var(--kr-border-default)}html[class*=-dark] .dataTables_filter label,html[class*=-dark] .dataTables_length label,html[class*=-dark] .footer-quote{color:var(--kr-text-secondary)}html[class*=-dark] #skills-panel{background-color:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important}body.mobile-mode .commerce-products-container>a.list-group-item p i,body>map,html[class*=-dark] hr{display:none}html[class*=-dark] .carousel-control{color:var(--kr-primary);opacity:.7}html[class*=-dark] .carousel-control:focus,html[class*=-dark] .carousel-control:hover{color:var(--kr-highlight);opacity:.9}html[class*=-dark] .carousel-indicators li{background-color:var(--kr-border-default);border-color:var(--kr-border-default)}html[class*=-dark] .carousel-indicators .active{background-color:var(--kr-primary);border-color:var(--kr-primary)}html[class*=-dark] a:link,html[class*=-dark] a:visited{color:var(--kr-highlight)}html[class*=-dark] a:focus,html[class*=-dark] a:hover{color:var(--kr-primary)}html[class*=-dark] a.next,html[class*=-dark] a.prev{background-color:var(--kr-bg-elevated)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-primary)!important}html[class*=-dark] a.next:hover,html[class*=-dark] a.prev:hover{background-color:var(--kr-bg-hover)!important;border-color:var(--kr-border-strong)!important;color:var(--kr-highlight)!important}html[class*=-dark] .btn-warning{background-color:var(--kr-primary)!important;border-color:var(--kr-primary-dark)!important;color:var(--kr-text-inverse)!important}html[class*=-dark] .btn-warning:hover{background-color:var(--kr-highlight)!important;border-color:var(--kr-primary)!important}html[class*=-dark] img[src*="/bat/bat"],html[class*=-dark] img[src*="/mat/94/"],html[class*=-dark] img[src*="/voc/"]{filter:none;opacity:.85}html[class*=-dark] img[src*="/bat/bat"]:hover,html[class*=-dark] img[src*="/mat/94/"]:hover,html[class*=-dark] img[src*="/voc/"]:hover{filter:none;opacity:1}.c100{width:80px!important;height:80px!important;border-radius:50%!important;background-color:var(--kr-bg-elevated, #f5f5f5)!important;display:flex!important;align-items:center!important;justify-content:center!important;overflow:visible!important}.c100 .bar,.c100 .fill,.c100 .slice,.mobile-mode table[data-mobile-hidden=true]{display:none!important}.c100>span,html[class*=-dark] .c100>span{font-size:20px!important;font-weight:600!important}.c100,.c100>span{position:relative!important}.c100>span{z-index:10!important;color:var(--kr-text-primary, #333)!important;text-align:center!important}.c100::after,.c100::before{content:""!important;position:absolute!important;border-radius:50%!important}.c100::after{top:50%!important;left:50%!important;transform:translate(-50%,-50%)!important;width:68px!important;height:68px!important;background-color:var(--kr-bg-elevated, #f5f5f5)!important;z-index:5!important}.c100::before{top:0!important;left:0!important;width:100%!important;height:100%!important;background:conic-gradient(var(--clock-color, #8B0000) 0deg,var(--clock-color, #8B0000) calc(var(--clock-deg, 0)*1deg),transparent calc(var(--clock-deg, 0)*1deg),transparent 360deg)!important;z-index:1!important;transition:none!important}.c100[data-second-lap=true]::before{box-shadow:0 0 0 1px var(--kr-bg-elevated, #f5f5f5),0 0 0 5px var(--clock-color, #32CD32),inset 0 0 0 2px var(--clock-color, #32CD32)!important}.c100.p0{--clock-deg:0}.c100.p1{--clock-deg:3.6}.c100.p2{--clock-deg:7.2}.c100.p3{--clock-deg:10.8}.c100.p4{--clock-deg:14.4}.c100.p5{--clock-deg:18}.c100.p6{--clock-deg:21.6}.c100.p7{--clock-deg:25.2}.c100.p8{--clock-deg:28.8}.c100.p9{--clock-deg:32.4}.c100.p10{--clock-deg:36}.c100.p11{--clock-deg:39.6}.c100.p12{--clock-deg:43.2}.c100.p13{--clock-deg:46.8}.c100.p14{--clock-deg:50.4}.c100.p15{--clock-deg:54}.c100.p16{--clock-deg:57.6}.c100.p17{--clock-deg:61.2}.c100.p18{--clock-deg:64.8}.c100.p19{--clock-deg:68.4}.c100.p20{--clock-deg:72}.c100.p21{--clock-deg:75.6}.c100.p22{--clock-deg:79.2}.c100.p23{--clock-deg:82.8}.c100.p24{--clock-deg:86.4}.c100.p25{--clock-deg:90}.c100.p26{--clock-deg:93.6}.c100.p27{--clock-deg:97.2}.c100.p28{--clock-deg:100.8}.c100.p29{--clock-deg:104.4}.c100.p30{--clock-deg:108}.c100.p31{--clock-deg:111.6}.c100.p32{--clock-deg:115.2}.c100.p33{--clock-deg:118.8}.c100.p34{--clock-deg:122.4}.c100.p35{--clock-deg:126}.c100.p36{--clock-deg:129.6}.c100.p37{--clock-deg:133.2}.c100.p38{--clock-deg:136.8}.c100.p39{--clock-deg:140.4}.c100.p40{--clock-deg:144}.c100.p41{--clock-deg:147.6}.c100.p42{--clock-deg:151.2}.c100.p43{--clock-deg:154.8}.c100.p44{--clock-deg:158.4}.c100.p45{--clock-deg:162}.c100.p46{--clock-deg:165.6}.c100.p47{--clock-deg:169.2}.c100.p48{--clock-deg:172.8}.c100.p49{--clock-deg:176.4}.c100.p50{--clock-deg:180}.c100.p51{--clock-deg:183.6}.c100.p52{--clock-deg:187.2}.c100.p53{--clock-deg:190.8}.c100.p54{--clock-deg:194.4}.c100.p55{--clock-deg:198}.c100.p56{--clock-deg:201.6}.c100.p57{--clock-deg:205.2}.c100.p58{--clock-deg:208.8}.c100.p59{--clock-deg:212.4}.c100.p60{--clock-deg:216}.c100.p61{--clock-deg:219.6}.c100.p62{--clock-deg:223.2}.c100.p63{--clock-deg:226.8}.c100.p64{--clock-deg:230.4}.c100.p65{--clock-deg:234}.c100.p66{--clock-deg:237.6}.c100.p67{--clock-deg:241.2}.c100.p68{--clock-deg:244.8}.c100.p69{--clock-deg:248.4}.c100.p70{--clock-deg:252}.c100.p71{--clock-deg:255.6}.c100.p72{--clock-deg:259.2}.c100.p73{--clock-deg:262.8}.c100.p74{--clock-deg:266.4}.c100.p75{--clock-deg:270}.c100.p76{--clock-deg:273.6}.c100.p77{--clock-deg:277.2}.c100.p78{--clock-deg:280.8}.c100.p79{--clock-deg:284.4}.c100.p80{--clock-deg:288}.c100.p81{--clock-deg:291.6}.c100.p82{--clock-deg:295.2}.c100.p83{--clock-deg:298.8}.c100.p84{--clock-deg:302.4}.c100.p85{--clock-deg:306}.c100.p86{--clock-deg:309.6}.c100.p87{--clock-deg:313.2}.c100.p88{--clock-deg:316.8}.c100.p89{--clock-deg:320.4}.c100.p90{--clock-deg:324}.c100.p91{--clock-deg:327.6}.c100.p92{--clock-deg:331.2}.c100.p93{--clock-deg:334.8}.c100.p94{--clock-deg:338.4}.c100.p95{--clock-deg:342}.c100.p96{--clock-deg:345.6}.c100.p97{--clock-deg:349.2}.c100.p98{--clock-deg:352.8}.c100.p99{--clock-deg:356.4}.c100.p100{--clock-deg:360}html[class*=-dark] .c100,html[class*=-dark] .dataTables_filter input,html[class*=-dark] .dataTables_length select,html[class*=-dark] .pagination>li>a,html[class*=-dark] .pagination>li>span,html[class*=-dark] table.dataTable thead td,html[class*=-dark] table.dataTable thead th{background-color:var(--kr-bg-elevated)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-primary)!important}html[class*=-dark] .c100::after,html[class*=-dark] table.dataTable thead th.sorting,html[class*=-dark] table.dataTable thead th.sorting_asc,html[class*=-dark] table.dataTable thead th.sorting_desc{background-color:var(--kr-bg-elevated)!important}html[class*=-dark] .c100>span{color:var(--kr-text-primary)!important;line-height:80px!important;width:80px!important;height:80px!important}html[class*=-dark] .c100 .slice{border-color:var(--kr-bg-elevated)!important}html[class*=-dark] .c100 .bar{border-color:var(--kr-primary)!important}html[class*=-dark] .c100 .fill{border-color:var(--kr-bg-elevated)!important}html[class*=-dark] .dataTables_paginate,html[class*=-dark] .pagination{background-color:transparent!important}html[class*=-dark] .pagination>li.disabled>a,html[class*=-dark] .pagination>li.disabled>span{background-color:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-muted)!important;opacity:.6!important}html[class*=-dark] .pagination>li>a:hover,html[class*=-dark] .pagination>li>span:hover{background-color:var(--kr-bg-hover)!important;border-color:var(--kr-border-strong)!important;color:var(--kr-primary)!important}html[class*=-dark] .dataTables_paginate .paginate_button.current,html[class*=-dark] .pagination>.active>a,html[class*=-dark] .pagination>.active>a:hover,html[class*=-dark] .pagination>.active>span,html[class*=-dark] .pagination>.active>span:hover{background-color:var(--kr-primary)!important;border-color:var(--kr-primary)!important;color:var(--kr-text-inverse)!important}html[class*=-dark] .dataTables_paginate .paginate_button{background-color:var(--kr-bg-elevated)!important;border:1px solid var(--kr-border-default)!important;color:var(--kr-text-primary)!important;background-image:none!important;box-shadow:none!important}html[class*=-dark] .dataTables_paginate .paginate_button.disabled,html[class*=-dark] .dataTables_paginate .paginate_button.disabled:hover{background-color:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-muted)!important;opacity:.6!important;cursor:not-allowed!important}html[class*=-dark] .dataTables_paginate .paginate_button:not(.disabled):hover{background-color:var(--kr-bg-hover)!important;border-color:var(--kr-border-strong)!important;color:var(--kr-primary)!important}html[class*=-dark] .dataTables_paginate .paginate_button.current:hover{background-color:var(--kr-primary)!important;border-color:var(--kr-primary)!important;color:var(--kr-text-inverse)!important}html[class*=-dark] .dataTables_wrapper{color:var(--kr-text-primary)}html[class*=-dark] .dataTables_filter,html[class*=-dark] .dataTables_info,html[class*=-dark] .dataTables_length{color:var(--kr-text-secondary)!important}html[class*=-dark] .dataTables_filter input:focus,html[class*=-dark] .dataTables_length select:focus{background-color:var(--kr-bg-elevated)!important;border-color:var(--kr-primary)!important;outline:0!important}html[class*=-dark] table.dataTable{background-color:transparent!important;color:var(--kr-text-primary)!important}html[class*=-dark] table.dataTable tbody tr,html[class*=-dark] table.dataTable tbody tr.odd{background-color:var(--kr-bg-surface)!important}html[class*=-dark] table.dataTable tbody tr.even,html[class*=-dark] table.dataTable thead th.sorting:hover,html[class*=-dark] table.dataTable thead th.sorting_asc:hover,html[class*=-dark] table.dataTable thead th.sorting_desc:hover{background-color:var(--kr-bg-hover)!important}html[class*=-dark] table.dataTable tbody tr:hover{background-color:var(--kr-bg-active)!important}html[class*=-dark] table.dataTable tbody td{border-color:var(--kr-border-default)!important;color:var(--kr-text-primary)!important}html[class*=-dark] table.dataTable tbody td.dataTables_empty{background-color:var(--kr-bg-surface)!important;color:var(--kr-text-secondary)!important}html[class*=-dark] table.dataTable tfoot td,html[class*=-dark] table.dataTable tfoot th{background-color:var(--kr-bg-elevated)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-primary)!important}body>div:has([id^=c]){display:block;position:relative;min-height:550px}.kr-mobile-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:1040;opacity:0;transition:opacity .3s ease}.kr-mobile-overlay.active{display:block;opacity:1}.kr-mobile-close{position:absolute;top:10px;right:10px;width:40px;height:40px;background:var(--kr-primary);color:#fff;border:0;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;font-size:20px}.kr-mobile-close:hover{background:var(--kr-primary-dark)}.kr-mobile-skills-toggle{position:fixed!important;bottom:90px!important;right:20px!important;z-index:1000!important;width:56px!important;height:56px!important;border-radius:50%!important;padding:0!important;display:none!important;box-shadow:var(--kr-shadow-lg)!important}body.mobile-mode .commerce-category-header{cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;position:relative;transition:background-color var(--transition-fast)}body.mobile-mode .commerce-category-header:hover{background-color:var(--kr-bg-hover)}body.mobile-mode .commerce-category-header:active{background-color:var(--kr-bg-active)}body.mobile-mode .commerce-category-header .accordion-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);transition:transform var(--transition-normal);font-size:14px;color:var(--kr-text-secondary)}body.mobile-mode .building-section-header.expanded .accordion-icon,body.mobile-mode .commerce-category-header.expanded .accordion-icon{transform:translateY(-50%) rotate(-180deg)}body.mobile-mode .commerce-products-container{max-height:5000px;opacity:1;overflow:hidden;transition:max-height var(--transition-normal),opacity var(--transition-normal);display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px;padding:8px 0}body.mobile-mode .commerce-products-container.collapsed{max-height:0!important;opacity:0}body.mobile-mode .commerce-products-container>a.list-group-item{display:flex!important;flex-direction:column;padding:8px!important;min-height:120px;border-radius:8px;background-color:var(--kr-bg-surface);border:1px solid var(--kr-border-default);transition:transform var(--transition-fast),box-shadow var(--transition-fast)}body.mobile-mode .commerce-products-container>a.list-group-item:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.3)}body.mobile-mode .commerce-products-container>a.list-group-item .mention{position:absolute;top:4px;right:4px;float:none!important;font-size:10px;line-height:1.2;text-align:right;background-color:rgba(0,0,0,.6);padding:2px 4px;border-radius:4px}body.mobile-mode .commerce-products-container>a.list-group-item .mention .xmini{font-size:9px;opacity:.8}body.mobile-mode .commerce-products-container>a.list-group-item img{float:none!important;display:block;margin:0 auto 8px;width:40px;height:40px}body.mobile-mode .commerce-products-container>a.list-group-item h4{font-size:11px;line-height:1.3;margin:0 0 4px;text-align:center;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;word-break:break-all}body.mobile-mode .commerce-products-container>a.list-group-item p{font-size:9px;line-height:1.2;margin:0;text-align:center;color:var(--kr-text-secondary);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}body.mobile-mode .building-section-header{cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;position:relative;transition:background-color var(--transition-fast)}body.mobile-mode .building-section-header:hover{background-color:var(--kr-bg-hover)}body.mobile-mode .building-section-header:active{background-color:var(--kr-bg-active)}body.mobile-mode .building-section-header .accordion-icon{position:absolute;right:12px;top:50%;transform:translateY(-50%);transition:transform var(--transition-normal);font-size:14px;color:var(--kr-text-secondary)}body.mobile-mode .building-section-content{max-height:5000px;opacity:1;overflow:hidden;transition:max-height var(--transition-normal),opacity var(--transition-normal)}body.mobile-mode .building-section-content.collapsed{max-height:0!important;opacity:0}body.mobile-mode .kr-navigation-row{display:table!important;width:100%;table-layout:fixed;margin-bottom:5px;border-collapse:separate;border-spacing:0}body.mobile-mode .kr-navigation-row+.container{padding-top:10px!important}body.mobile-mode .kr-navigation-row>.btn-group{display:table-cell!important;width:1%;vertical-align:middle;float:none!important}body.mobile-mode .kr-direction-link,body.mobile-mode .kr-room-link{display:flex!important;flex-direction:column;align-items:center;justify-content:center;width:100%;height:60px!important;padding:0!important;text-align:center}body.mobile-mode .kr-direction-link{position:relative}body.mobile-mode .kr-direction-link img,body.mobile-mode .kr-room-link img{width:60px;height:60px;display:block}body.mobile-mode .kr-direction-link map{position:absolute;top:0;left:0;width:100%;height:100%}body.mobile-mode .kr-room-link{font-size:10px;line-height:1.2}body.mobile-mode .kr-navigation-row>.btn-group:first-child .kr-direction-link,body.mobile-mode .kr-navigation-row>.btn-group:first-child .kr-room-link{border-radius:4px 0 0 4px}body.mobile-mode .kr-navigation-row>.btn-group:last-child .kr-room-link{border-radius:0 4px 4px 0}body.mobile-mode .kr-navigation-row>.btn-group:not(:first-child) .kr-direction-link,body.mobile-mode .kr-navigation-row>.btn-group:not(:first-child) .kr-room-link{border-left:none}body.mobile-mode .kr-navigation-row>.btn-group:only-child .kr-direction-link,body.mobile-mode .kr-navigation-row>.btn-group:only-child .kr-room-link{border-radius:4px}.forums-cards-container{display:none;padding:12px 8px;background:var(--kr-bg-page)}.mobile-mode .forums-cards-container{display:block}.forum-card{background:var(--kr-bg-surface);border-radius:12px;margin:0 12px 12px;transition:background .2s ease;overflow:hidden;border:1px solid var(--kr-border-default)}.forum-card *,.forum-card-header *,.forum-card-link *,.forum-footer *{text-align:left!important}.forum-card:active{background:var(--kr-bg-hover)}.forum-card-link{display:flex!important;flex-direction:column!important;align-items:flex-start!important;justify-content:flex-start!important;padding:16px;text-decoration:none;color:inherit;min-height:100px;-webkit-tap-highlight-color:rgba(139,15,14,.05)}.forum-card-link:focus,.forum-card-link:hover{text-decoration:none;color:inherit}.forum-card-header{margin-bottom:8px;text-align:left}.forum-title{font-size:18px;font-weight:700;color:var(--kr-text-primary);line-height:1.3;margin:0;padding:0;text-align:left!important}.forum-description{font-size:14px;color:var(--kr-text-secondary);line-height:1.5;margin:0 0 8px;text-align:left!important;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}.forum-moderators{font-size:12px;color:var(--kr-text-muted);margin:0 0 10px;font-style:normal;font-weight:400;text-align:left!important}.forum-footer{border-top:1px solid var(--kr-border-default);padding-top:10px;margin-top:auto;text-align:left!important}.forum-stats{font-size:13px;color:var(--kr-text-muted);margin-bottom:6px;white-space:nowrap;text-align:left!important}.forum-messages,.forum-topics{font-weight:600;color:var(--kr-text-secondary)}.forum-separator{margin:0 4px;color:var(--kr-text-muted)}.forum-last-activity{font-size:13px;color:var(--kr-text-secondary);line-height:1.5;text-align:left!important}.last-user{font-weight:600;color:var(--kr-text-primary)}.last-time{color:var(--kr-text-muted);font-size:12px}.forum-card:has(.forum-topics:empty){opacity:.6}.forum-card-link:focus{outline:2px solid #2196f3;outline-offset:2px}.mini-chat-fab{position:fixed;bottom:80px;right:16px;width:56px;height:56px;background:#2196f3;color:#fff;border:0;border-radius:50%;box-shadow:0 4px 12px rgba(0,0,0,.3);z-index:1000;cursor:pointer;font-size:14px;font-weight:700;transition:all .3s ease}.mini-chat-fab:active{transform:scale(.95);box-shadow:0 2px 8px rgba(0,0,0,.3)}.mini-chat-fab.active{background:#f44336}.mini-chat-fab .fab-text{display:block;line-height:1}.mobile-mode .mini-chat-overlay{position:fixed!important;inset:56px 0 0!important;width:100%!important;height:auto!important;z-index:999!important;background:#fff}@media (max-width:767px){.dataTables_wrapper{padding:0!important}.dataTables_filter,.dataTables_length{display:block!important;width:100%!important;margin:0 0 var(--mobile-spacing-md)!important;text-align:left!important;float:none!important}.dataTables_filter label,.dataTables_length label{display:flex!important;align-items:center!important;gap:8px!important;font-size:14px!important;margin:0!important}.dataTables_filter input,.dataTables_length select{min-height:var(--mobile-touch-target)!important;font-size:16px!important;border:1px solid var(--kr-border-default)!important;border-radius:var(--mobile-radius)!important;background-color:var(--kr-bg-surface)!important}.dataTables_length select{padding:10px 32px 10px 12px!important;flex:0 0 auto!important;min-width:80px!important}.dataTables_filter label{width:100%!important}.dataTables_filter input{flex:1!important;padding:10px 16px!important;width:100%!important}.dataTables_filter input:focus,.dataTables_length select:focus{outline:2px solid var(--kr-primary)!important;outline-offset:2px!important;border-color:var(--kr-primary)!important}body.page-forum .panel-default{background:0 0!important;border:0!important;box-shadow:none!important}body.page-forum .panel-default>.panel-heading{background:0 0!important;border:0!important;border-bottom:1px solid var(--kr-border-default)!important;border-radius:0!important;padding:12px 16px!important;margin-bottom:0!important;align-items:center!important}body.page-forum .panel-default>.panel-body{padding:0!important}body.page-forum .panel-default>.panel-heading h3{font-size:16px!important;font-weight:600!important;margin:0!important;color:var(--kr-primary)!important}body.page-forum .panel-default .table>thead,body.page-forum table.dataTable thead,body.page-kramail #topics thead,body.page-kramail #topics_wrapper .dataTables_length{display:none!important}body.page-forum .panel-default .table>tbody{display:flex!important;flex-direction:column!important;gap:8px!important}body.page-forum .panel-default .table>tbody>tr{display:grid!important;grid-template-columns:1fr!important;grid-template-rows:auto!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:12px!important;padding:12px!important;transition:background var(--transition-fast)!important;position:relative!important;min-height:auto!important}body.page-forum .panel-default .table>tbody>tr:active,body.page-forum table.dataTable tbody tr:active,body.page-kramail #topics tbody tr:active{background:var(--kr-bg-hover)!important}body.page-forum .panel-default .table>tbody>tr>td{display:block!important;border:0!important;padding:0!important;width:100%!important}body.page-forum .panel-default .table>tbody>tr>td:first-child{display:flex!important;flex-direction:column!important;grid-row:1!important}body.page-forum .panel-default .table>tbody>tr>td:nth-child(2),body.page-forum .panel-default .table>tbody>tr>td:nth-child(3){grid-row:2!important}body.page-forum .panel-default .table>tbody>tr>td:nth-child(4){grid-row:4!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>p:first-child{order:1!important;margin:0!important;font-size:0!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>p:first-child>a{font-size:15px!important;font-weight:700!important;color:var(--kr-text-primary)!important;text-decoration:none!important;line-height:1.1!important;display:block!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>p:first-child>a:active{color:var(--kr-primary)!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>span.tagforum{order:2!important;margin:0!important;font-size:11px!important;color:var(--kr-text-secondary)!important;line-height:1.2!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>span.tagforum>.lefticon{display:none!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>span.tagforum a{color:var(--kr-text-secondary)!important;text-decoration:none!important;font-weight:500!important}body.page-forum .panel-default .table>tbody>tr>td:first-child>span.tagforum a:active{color:var(--kr-primary)!important;text-decoration:underline!important}body.page-forum .panel-default .table>tbody>tr>.forum-description-wrapper>p,body.page-forum .panel-default .table>tbody>tr>td:first-child>p:nth-child(2){order:999!important;font-size:12px!important;color:var(--kr-text-secondary)!important;line-height:1.2!important;margin:0!important}body.page-forum .panel-default .table>tbody>tr>.forum-description-wrapper{margin:0 0 6px!important}body.page-forum .panel-default .table>tbody>tr>.forum-stats-wrapper>td,body.page-forum .panel-default .table>tbody>tr>td:nth-child(2),body.page-forum .panel-default .table>tbody>tr>td:nth-child(3){display:inline!important;font-size:11px!important;color:var(--kr-text-secondary)!important;order:2!important;margin:0!important;padding:0!important}body.page-forum .panel-default .table>tbody>tr>.forum-stats-wrapper{margin:0 0 2px!important}body.page-forum .panel-default .table>tbody>tr>.forum-stats-wrapper>td:first-child::after,body.page-forum .panel-default .table>tbody>tr>td:nth-child(2)::after{content:" sujets · "!important}body.page-forum .panel-default .table>tbody>tr>.forum-stats-wrapper>td:nth-child(2)::after,body.page-forum .panel-default .table>tbody>tr>td:nth-child(3)::after{content:" messages"!important}body.page-forum .panel-default .table>tbody>tr>td:last-child,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4){order:5!important;padding-top:3px!important;border-top:1px solid var(--kr-border-default)!important;margin-top:0!important;font-size:11px!important;color:var(--kr-text-secondary)!important;display:block!important}body.page-forum .panel-default .table>tbody>tr>td:last-child::before,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)::before{content:"→ "!important;color:var(--kr-text-secondary)!important;font-weight:400!important;margin-right:4px!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>a,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>a{font-size:12px!important;font-weight:500!important;color:var(--kr-text-primary)!important;text-decoration:none!important;display:inline!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>a:active,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>a:active{color:var(--kr-primary)!important;text-decoration:underline!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>a::after,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>a::after{content:" · "!important;color:var(--kr-text-muted)!important;font-weight:400!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>p,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>p{display:inline!important;margin:0!important;font-size:13px!important;color:var(--kr-text-secondary)!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>p>a,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>p>a{color:var(--kr-text-secondary)!important;text-decoration:none!important;display:inline-flex!important;align-items:center!important;background:0 0!important;border:0!important;padding:0!important;box-shadow:none!important;min-width:20px!important;min-height:20px!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>p>a:active,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>p>a:active{color:var(--kr-primary)!important}body.page-forum .panel-default .table>tbody>tr>td:last-child>p>a .glyphicon,body.page-forum .panel-default .table>tbody>tr>td:nth-child(4)>p>a .glyphicon{display:inline-block!important;width:20px!important;height:20px!important;font-size:14px!important;line-height:20px!important;vertical-align:middle!important}body.page-forum .panel-default .table>tbody>tr>td:nth-child(4) img{vertical-align:middle!important;margin:0 2px!important;max-height:16px!important}body.page-forum table.dataTable tbody{display:flex!important;flex-direction:column!important;gap:var(--mobile-spacing-md)!important}body.page-forum table.dataTable tbody tr{display:flex!important;flex-direction:column!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:12px!important;padding:12px!important;margin:0!important;overflow:hidden!important;transition:background var(--transition-fast)!important;cursor:pointer!important}body.page-forum table.dataTable tbody td:nth-child(2),body.page-forum table.dataTable tbody td:nth-child(3),body.page-forum table.dataTable tbody td:nth-child(4),body.page-forum table.dataTable tbody td:nth-child(5){display:none!important}body.page-forum table.dataTable tbody td:nth-child(1){display:flex!important;flex-direction:column!important;padding:0!important;min-height:var(--mobile-touch-target)!important;gap:var(--mobile-spacing-sm)!important}body.page-forum table.dataTable tbody td:nth-child(1) p{margin:0 0 4px!important;padding:0!important;display:flex!important;align-items:flex-start!important;gap:8px!important}body.page-forum table.dataTable tbody td:nth-child(1) p a{flex:1!important;font-size:15px!important;font-weight:600!important;line-height:1.4!important;color:var(--kr-text-primary)!important;text-decoration:none!important;display:block!important}body.page-forum table.dataTable tbody td:nth-child(1) p a:active{color:var(--kr-primary)!important}body.page-forum table.dataTable tbody td:nth-child(1)>ul:first-of-type{display:none!important}body.page-forum table.dataTable tbody td:nth-child(1)>ul:nth-of-type(2){display:none!important}body.page-forum table.dataTable tbody td:nth-child(1) .forum-tags{display:flex!important;flex-wrap:wrap!important;gap:3px!important;margin-top:6px!important}body.page-forum table.dataTable tbody td:nth-child(1) .forum-tags .glyphicon{color:var(--kr-text-muted)!important;font-size:8px!important}body.page-forum table.dataTable tbody td:nth-child(1) .forum-tags a{display:inline-flex!important;align-items:center!important;padding:1px 4px!important;font-size:9px!important;color:var(--kr-text-secondary)!important;background:var(--kr-bg-hover)!important;border-radius:2px!important;text-decoration:none!important;transition:all var(--transition-fast)!important}body.page-forum table.dataTable tbody td:nth-child(1) .forum-tags a:active,body.page-forum table.dataTable tbody td:nth-child(5):active{background:var(--kr-bg-active)!important}.forum-topic-stats-mobile{display:flex!important;align-items:center!important;gap:4px!important;margin-top:4px!important;font-size:13px!important;color:var(--kr-text-secondary)!important}.forum-topic-stats-mobile i{font-size:12px!important}.forum-topic-stats-mobile .stats-sep{margin:0 4px!important;color:var(--kr-text-muted)!important}body.page-forum table.dataTable tbody td:nth-child(5) a:first-child{font-size:14px!important;font-weight:600!important;color:var(--kr-text-primary)!important;text-decoration:none!important;display:inline-flex!important;align-items:center!important;gap:4px!important}body.page-forum table.dataTable tbody td:nth-child(5) a:first-child img{width:16px!important;height:16px!important;vertical-align:middle!important}body.page-forum table.dataTable tbody td:nth-child(5) p{font-size:13px!important;color:var(--kr-text-muted)!important;margin:0!important;display:flex!important;align-items:center!important;gap:6px!important}body.page-forum table.dataTable tbody td:nth-child(5) p a .glyphicon{font-size:12px!important;color:var(--kr-primary)!important}.dataTables_paginate{display:flex!important;justify-content:center!important;gap:var(--mobile-spacing-sm)!important;margin-top:var(--mobile-spacing-lg)!important;padding:0!important}.dataTables_paginate .paginate_button{min-height:var(--mobile-touch-target)!important;min-width:var(--mobile-touch-target)!important;padding:10px 16px!important;font-size:16px!important;border:1px solid var(--kr-border-default)!important;border-radius:var(--mobile-radius)!important;background:var(--kr-bg-surface)!important;color:var(--kr-text-primary)!important;text-decoration:none!important;display:inline-flex!important;align-items:center!important;justify-content:center!important;cursor:pointer!important;transition:all var(--transition-fast)!important}.dataTables_paginate .paginate_button.current{background:var(--kr-primary)!important;color:#fff!important;border-color:var(--kr-primary)!important;font-weight:600!important}.dataTables_paginate .paginate_button.disabled{opacity:.4!important;cursor:not-allowed!important;pointer-events:none!important}.dataTables_paginate .paginate_button:not(.disabled):not(.current):active{background:var(--kr-bg-active)!important;transform:scale(.95)!important}.dataTables_info{text-align:center!important;font-size:14px!important;color:var(--kr-text-secondary)!important;margin-top:var(--mobile-spacing-md)!important;padding:0 var(--mobile-spacing-md)!important}html[class*=-dark] table.dataTable tbody tr{background:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important}html[class*=-dark] table.dataTable tbody td:nth-child(1){border-bottom-color:var(--kr-border-default)!important}html[class*=-dark] table.dataTable tbody td:nth-child(5){background:rgba(255,255,255,.03)!important}html[class*=-dark] .dataTables_filter input,html[class*=-dark] .dataTables_length select,html[class*=-dark] .dataTables_paginate .paginate_button{background:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important;color:var(--kr-text-primary)!important}body.page-kramail h1.page-header{display:flex!important;flex-direction:column!important;align-items:stretch!important;gap:12px!important;padding:12px 16px!important;margin:0!important;border-bottom:none!important}body.page-kramail h1.page-header .pull-right{float:none!important;display:flex!important;flex-wrap:wrap!important;align-items:center!important;gap:8px!important;width:100%!important}body.page-kramail h1.page-header .pull-right>.btn-group>.btn,body.page-kramail h1.page-header .pull-right>a.btn{width:44px!important;height:44px!important;display:flex!important;align-items:center!important;justify-content:center!important;padding:0!important;margin:0!important;font-size:0!important;line-height:0!important;box-sizing:border-box!important;border-radius:10px!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;color:var(--kr-text-primary)!important;text-decoration:none!important;transition:all var(--transition-fast)!important}body.page-kramail h1.page-header .pull-right>.btn-group>.btn>i,body.page-kramail h1.page-header .pull-right>a.btn>i{font-size:18px!important;line-height:1!important}body.page-kramail h1.page-header .pull-right>a.btn.btn-primary{background:var(--kr-primary)!important;border-color:var(--kr-primary)!important;color:#fff!important}body.page-kramail h1.page-header .pull-right>.btn-group>.btn:active,body.page-kramail h1.page-header .pull-right>a.btn:active{transform:scale(.97)!important;opacity:.9!important}body.page-kramail h1.page-header .pull-right>.btn-group{position:relative!important;width:44px!important;height:44px!important}body.page-kramail h1.page-header .pull-right>.btn-group>.dropdown-menu{min-width:260px!important;right:0!important;left:auto!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:10px!important;padding:8px 0!important;box-shadow:0 4px 16px rgba(0,0,0,.4)!important}body.page-kramail h1.page-header .pull-right>.btn-group>.dropdown-menu>li>a{display:flex!important;align-items:center!important;gap:8px!important;padding:12px 16px!important;min-height:44px!important;font-size:15px!important;color:var(--kr-text-primary)!important;white-space:nowrap!important}body.page-kramail h1.page-header .pull-right>.btn-group>.dropdown-menu>li>a:active{background:rgba(255,255,255,.08)!important}body.page-kramail h1.page-header .pull-right>.btn-group>.dropdown-menu>li>a .label-simple{font-size:15px!important;color:var(--kr-text-primary)!important}body.page-kramail h1.page-header .pull-right>.btn-group>.dropdown-menu>li>a input[type=checkbox]{width:18px!important;height:18px!important}body.page-kramail .panel.panel-default{border:0!important;box-shadow:none!important;margin:0!important;background:0 0!important}body.page-kramail .panel-heading{padding:12px 16px!important;background:0 0!important;border-bottom:1px solid var(--kr-border-default)!important}body.page-kramail .panel-heading h3.panel-title{font-size:16px!important;font-weight:600!important;color:var(--kr-primary)!important}body.page-kramail .panel-heading .glyphicon-chevron-up{float:right!important;color:var(--kr-text-secondary)!important}body.page-kramail .panel-body{padding:0!important}body.page-kramail #topics_wrapper .dataTables_filter{padding:12px 16px!important;text-align:left!important;width:100%!important}body.page-kramail #topics_wrapper .dataTables_filter label{display:flex!important;align-items:center!important;gap:8px!important;width:100%!important;margin:0!important;font-size:14px!important;color:var(--kr-text-secondary)!important}body.page-kramail #topics_wrapper .dataTables_filter input,body.page-kramail #topics_wrapper .dataTables_filter input[type=search]{flex:1!important;height:44px!important;padding:0 16px!important;font-size:16px!important;border-radius:22px!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;color:var(--kr-text-primary)!important;transition:border-color var(--transition-fast),box-shadow var(--transition-fast)!important;-webkit-appearance:none!important}body.page-kramail #topics_wrapper .dataTables_filter input:focus{outline:0!important;border-color:var(--kr-primary)!important;box-shadow:0 0 0 3px rgba(212,134,62,.15)!important}body.page-kramail #topics_wrapper .dataTables_info{padding:8px 16px!important;font-size:13px!important;color:var(--kr-text-muted)!important;text-align:center!important}body.page-kramail #topics_wrapper .dataTables_paginate{padding:8px 16px 16px!important;text-align:center!important}body.page-kramail #topics_wrapper .dataTables_paginate .paginate_button{min-height:44px!important;min-width:44px!important;padding:10px 14px!important;margin:0 4px!important;border-radius:8px!important;font-size:14px!important}body.page-kramail #topics{display:block!important;width:100%!important;border-collapse:separate!important}body.page-kramail #topics tbody{display:flex!important;flex-direction:column!important;gap:8px!important;padding:8px 16px!important}body.page-kramail #topics tbody tr{display:grid!important;grid-template-columns:36px 1fr!important;grid-template-rows:auto auto!important;gap:4px 10px!important;padding:12px!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:12px!important;cursor:pointer!important;transition:background var(--transition-fast)!important;min-height:56px!important;position:relative!important}body.page-kramail #topics tbody td:first-child{grid-row:1/-1!important;grid-column:1!important;display:flex!important;align-items:center!important;justify-content:center!important;padding:0!important;width:auto!important;border:0!important}body.page-kramail #topics tbody td:first-child input[type=checkbox]{width:20px!important;height:20px!important;cursor:pointer!important;accent-color:var(--kr-primary)!important}body.page-kramail #topics tbody td:nth-child(2){grid-column:2!important;grid-row:1!important;display:block!important;padding:0!important;border:0!important;overflow:hidden!important}body.page-kramail #topics tbody td:nth-child(2) p.nomargin{margin:0!important;padding:0!important}body.page-kramail #topics tbody td:nth-child(2) span[id^=ajax-m]{display:flex!important;align-items:center!important;gap:8px!important;overflow:hidden!important}body.page-kramail #topics tbody td:nth-child(2) a:first-child i.fa,body.page-kramail #topics tbody td:nth-child(2) a:first-child i.far,body.page-kramail #topics tbody td:nth-child(2) a:first-child i.fas{font-size:16px!important;color:var(--kr-text-secondary)!important;flex-shrink:0!important}body.page-kramail #topics tbody td:nth-child(2) span[id^=ajax-m]>a:first-child{flex-shrink:0!important;display:flex!important;align-items:center!important;padding:0!important;min-height:0!important}body.page-kramail #topics tbody td:nth-child(2) a:last-of-type{font-size:15px!important;font-weight:500!important;color:var(--kr-text-primary)!important;text-decoration:none!important;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important;line-height:1.3!important;display:block!important;padding:0!important;min-height:0!important;flex:1!important;min-width:0!important}body.page-kramail #topics tbody td:nth-child(2) span.invisible,body.page-kramail #topics tbody td:nth-child(4) span.invisible{display:none!important}body.page-kramail #topics tbody td:nth-child(3){grid-column:2!important;grid-row:2!important;display:inline!important;padding:0!important;border:0!important;font-size:13px!important;color:var(--kr-text-secondary)!important}body.page-kramail #topics tbody td:nth-child(3) a{color:var(--kr-text-secondary)!important;text-decoration:none!important;font-size:13px!important}body.page-kramail #topics tbody td:nth-child(4){position:absolute!important;right:12px!important;bottom:12px!important;display:block!important;padding:0!important;border:0!important;font-size:12px!important;color:var(--kr-text-muted)!important;text-align:right!important}body.page-kramail #topics_wrapper .btn-group{display:flex!important;gap:4px!important;padding:8px 16px!important}body.page-kramail #topics_wrapper .btn-group .btn{min-height:44px!important;min-width:44px!important;padding:10px!important;font-size:14px!important;border-radius:8px!important}.kramail-character-selector{position:relative!important;display:inline-flex!important;align-items:center!important;gap:8px!important;cursor:pointer!important;user-select:none!important;padding:8px 12px!important;margin:-8px -12px!important;border-radius:var(--mobile-radius)!important;transition:background var(--transition-fast)!important}.kramail-character-selector:active{background:var(--kr-bg-active)!important}.kramail-dropdown-icon{font-size:12px!important;transition:transform var(--transition-fast)!important;color:var(--kr-text-secondary)!important}.kramail-character-dropdown{position:absolute!important;top:100%!important;left:0!important;right:auto!important;min-width:calc(100vw - 48px)!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:var(--mobile-radius)!important;box-shadow:var(--kr-shadow-lg)!important;margin-top:8px!important;z-index:1000!important;overflow:hidden!important;max-height:70vh!important;overflow-y:auto!important;display:none;flex-direction:column!important}.kramail-character-dropdown[style*="display: block"],.kramail-character-dropdown[style*="display:block"]{display:flex!important}.kramail-character-option{display:flex!important;flex-direction:column!important;align-items:center!important;text-align:center!important;padding:12px 16px!important;min-height:var(--mobile-touch-target)!important;text-decoration:none!important;color:var(--kr-text-primary)!important;border-bottom:1px solid var(--kr-border-default)!important;transition:background var(--transition-fast)!important}.kramail-character-option>div:first-child{justify-content:center!important;width:100%!important}.kramail-character-option>div:last-child{text-align:center!important}.kramail-character-option:last-child{border-bottom:none!important}.kramail-character-option:active{background:var(--kr-bg-active)!important}html[class*=-dark] .kramail-character-dropdown{background:var(--kr-bg-surface)!important;border-color:var(--kr-border-default)!important}html[class*=-dark] .kramail-character-option{color:var(--kr-text-primary)!important;border-bottom-color:var(--kr-border-default)!important}.forum-top:has(.kramail-actions-moved){display:none!important}body.mobile-mode ul.media-list.forum>li.media.well.kramail-post-restructured{display:flex!important;flex-direction:column!important;padding:0!important;margin:0 16px 16px!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;border-radius:12px!important;overflow:hidden!important;list-style:none!important}body.mobile-mode li.kramail-post-restructured>.media-body,body.mobile-mode li.kramail-post-restructured>.pull-left,body.page-kramail .editeur-text #results hr,body.page-kramail .editeur-text .form-group hr{display:none!important}.kramail-msg-header{display:flex!important;align-items:center!important;gap:12px!important;padding:12px 16px!important;border-bottom:1px solid var(--kr-border-default)!important}.kramail-msg-header .kramail-msg-avatar{width:48px!important;height:48px!important;border-radius:8px!important;object-fit:cover!important;flex-shrink:0!important}.kramail-msg-header-info{flex:1!important;min-width:0!important}.kramail-msg-sender{font-size:15px!important;font-weight:600!important;color:var(--kr-text-primary)!important;margin-bottom:2px!important}.kramail-msg-sender a{color:inherit!important;text-decoration:none!important}.kramail-msg-date{font-size:12px!important;color:var(--kr-text-muted)!important;display:flex!important;align-items:center!important;gap:4px!important}.kramail-msg-date i{font-size:11px!important}.kramail-msg-recipients{padding:8px 16px!important;font-size:13px!important;color:var(--kr-text-secondary)!important;border-bottom:1px solid var(--kr-border-default)!important;line-height:1.5!important}.kramail-msg-recipients strong{color:var(--kr-text-muted)!important;font-weight:500!important}.kramail-msg-recipients a{color:var(--kr-primary)!important;text-decoration:none!important}.kramail-msg-body{padding:16px!important;font-size:15px!important;line-height:1.6!important;color:var(--kr-text-primary)!important;word-wrap:break-word!important;overflow-wrap:break-word!important}.kramail-msg-body .blockquote,.kramail-msg-body .quote,.kramail-msg-body blockquote{margin:12px 0!important;padding:12px 16px!important;border-left:3px solid var(--kr-primary)!important;border-right:none!important;border-top:none!important;border-bottom:none!important;background:rgba(255,255,255,.03)!important;border-radius:0 8px 8px 0!important;font-size:14px!important;color:var(--kr-text-secondary)!important;line-height:1.5!important}.kramail-msg-body blockquote .fa-quote-left,.kramail-msg-body blockquote .text-warning{color:var(--kr-primary)!important;opacity:.6!important;margin-right:6px!important;font-size:12px!important}.kramail-msg-signature{margin-top:16px!important;padding-top:12px!important;border-top:1px solid var(--kr-border-default)!important;font-size:13px!important;color:var(--kr-text-muted)!important;line-height:1.5!important}.kramail-msg-signature img.icon{max-height:18px!important;vertical-align:middle!important}body.mobile-mode .center:has(>ul.pagination){padding:8px 16px 16px!important}body.mobile-mode .center>ul.pagination.t{display:flex!important;justify-content:center!important;gap:8px!important;padding:0!important;margin:0!important;list-style:none!important}body.mobile-mode .center>ul.pagination.t>li{list-style:none!important}body.mobile-mode .center>ul.pagination.t>li>a{display:flex!important;align-items:center!important;justify-content:center!important;width:44px!important;height:44px!important;border-radius:10px!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;color:var(--kr-text-primary)!important;text-decoration:none!important;font-size:16px!important;transition:all .15s!important}body.mobile-mode .center>ul.pagination.t>li>a:active{transform:scale(.97)!important;background:var(--kr-primary)!important;border-color:var(--kr-primary)!important;color:#fff!important}ul.media-list.forum>li.media.forum-post-restructured{display:block!important;padding:12px 8px!important;margin-bottom:24px!important;list-style:none!important;border-bottom:1px solid rgba(255,255,255,.1)!important}ul.media-list.forum>li.media .forum-header{margin-bottom:12px!important;display:flex!important;flex-wrap:nowrap!important}ul.media-list.forum>li.media .forum-content-row,ul.media-list.forum>li.media .forum-header{margin-left:0!important;margin-right:0!important}.forum-user-section{padding:0 8px!important;display:flex!important;flex-direction:column!important;align-items:center!important;text-align:center!important}.forum-user-section .user-info img:first-child,.forum-user-section img.avatar{max-width:80px!important;height:auto!important;border-radius:4px!important;margin-bottom:8px!important}.forum-user-section .cartouche strong,.forum-user-section [data-kr-rank-title] strong,.forum-user-section strong a{white-space:normal!important;word-wrap:break-word!important;overflow-wrap:break-word!important;hyphens:auto!important;overflow:visible!important;text-overflow:clip!important}.forum-user-section .cartouche strong,.forum-user-section strong a{font-size:13px!important;line-height:1.2!important;display:block!important;max-width:100%!important;min-height:0!important}.forum-user-section [data-kr-rank-title]{display:inline-flex!important;align-items:center!important;justify-content:center!important;gap:4px!important;flex-wrap:nowrap!important;margin-top:4px!important;max-width:100%!important}.forum-user-section [data-kr-rank-title] img{flex-shrink:0!important;margin:0!important;max-width:24px!important;max-height:24px!important}.forum-user-section [data-kr-rank-title] strong{font-size:10px!important;color:#bbb!important;font-weight:400!important;max-width:none!important;line-height:1.3!important;text-align:center!important;flex:1 1 auto!important;min-width:0!important}.forum-user-section .post-date-mobile{font-size:11px!important;color:#999!important;margin-top:4px!important;text-align:center!important}.forum-user-section strong:not(.cartouche strong):not([data-kr-rank-title] strong){font-size:10px!important;color:#bbb!important;font-weight:400!important;margin-top:4px!important;white-space:nowrap!important;overflow:hidden!important;text-overflow:ellipsis!important;max-width:100%!important}.forum-actions-section{padding:0 8px!important;display:flex!important;flex-direction:column!important;align-items:flex-end!important;gap:8px!important}.forum-actions-section .pull-right{float:none!important;display:flex!important;flex-direction:row!important;flex-wrap:wrap!important;justify-content:center!important;align-items:center!important;gap:8px!important;width:100%!important}.forum-actions-section .btn-group{display:inline-flex!important;flex-direction:row!important;gap:0!important;flex-wrap:nowrap!important}.forum-actions-section .btn{width:44px!important;height:44px!important;min-width:44px!important;max-width:44px!important;padding:0!important;margin:0!important;font-size:14px!important;line-height:44px!important;border:0!important;border-radius:0!important;display:inline-flex!important;align-items:center!important;justify-content:center!important}.forum-actions-section .btn-group-xs .btn,.forum-actions-section .btn-group-xs>.btn{min-width:44px!important}.forum-actions-section .btn i{font-size:11px!important;line-height:24px!important}.forum-content-row{margin-top:0!important}.forum-content-section{padding:12px 8px!important;border-top:1px dashed rgba(255,255,255,.15)!important;font-size:15px!important;line-height:1.6!important;width:100%!important}.forum-content-section .forum-msg,.forum-content-section>div{width:100%!important;padding:0!important;margin:0!important}.forum-content-section blockquote{margin:8px 0!important;padding:8px 12px!important;border-left:3px solid rgba(255,255,255,.2)!important;font-size:14px!important}.forum-content-section img{max-width:100%!important;height:auto!important}.forum-content-section .spoiler{margin:8px 0!important}.forum-content-section .signature,.forum-content-section hr{margin-top:16px!important;padding-top:16px!important;border-top:1px solid rgba(255,255,255,.1)!important;font-size:12px!important;color:#999!important}body.page-kramail .editeur-text .form-group+.form-group>.col-sm-2:empty+.col-sm-10>hr{display:none!important}body.page-kramail .editeur-text .form-group:has(#results){margin-bottom:0;padding-top:0}body.page-kramail .editeur-text select.form-control{cursor:pointer}body.page-kramail .editeur-text .form-group:has(input[type=checkbox]) input[type=checkbox]{cursor:pointer}body.page-kramail .editeur-text .form-group>label.control-label .required{color:var(--kr-primary);font-weight:700}body.page-kramail h1.page-header .btn-default{border-radius:var(--kr-radius);font-weight:500;transition:all .15s ease}body.page-kramail h1.page-header .btn-default:hover{border-color:var(--kr-primary);color:var(--kr-primary)}@media (min-width:769px){body.page-kramail form.form-horizontal.editeur-text{background:var(--kr-bg-surface);border:1px solid var(--kr-border-strong);border-radius:var(--kr-radius);padding:28px 32px;margin-top:8px;box-shadow:var(--kr-shadow-md)}body.page-kramail h1.page-header{border-bottom-color:var(--kr-primary)!important;padding-bottom:12px;margin-bottom:16px}body.page-kramail .editeur-text .input-group-addon{background-color:var(--kr-bg-elevated);border-color:var(--kr-border-default);color:var(--kr-text-secondary);min-width:42px;text-align:center}body.page-kramail .editeur-text .input-group-addon i.fa,body.page-kramail .editeur-text .input-group-addon i.far,body.page-kramail .editeur-text .input-group-addon i.fas{color:var(--kr-primary);font-size:14px}body.page-kramail .editeur-text .input-group-addon .btn.btn-primary{min-width:36px;min-height:32px;font-size:16px;font-weight:700;padding:4px 12px;border-radius:4px}body.page-kramail .editeur-text .form-group label[for],body.page-kramail .editeur-text .form-group>label.col-sm-1{font-size:13px;text-transform:uppercase;letter-spacing:.3px;color:var(--kr-text-secondary);font-weight:600}body.page-kramail .editeur-text .form-group:has(input[type=checkbox]){background:var(--kr-bg-hover);border:1px solid var(--kr-border-default);border-radius:var(--kr-radius);padding:16px 20px!important;margin-top:8px}body.page-kramail .editeur-text .form-group:has(input[type=checkbox])>label.col-md-2,body.page-kramail .editeur-text .form-group:has(input[type=checkbox])>label.col-sm-2{color:var(--kr-text-primary);font-weight:700;font-size:14px}body.page-kramail .editeur-text .form-group:has(input[type=checkbox]) .checkbox-inline{margin-right:24px;padding:6px 4px 6px 24px;cursor:pointer}body.page-kramail .editeur-text>div:last-child{text-align:right;padding-top:16px;margin-top:8px;border-top:1px solid var(--kr-border-default);clear:both}body.page-kramail .editeur-text button.btn-primary.pull-right{float:none!important;min-width:180px;padding:12px 32px;font-size:15px;font-weight:600;letter-spacing:.3px;border-radius:var(--kr-radius);margin:0;transition:all .2s ease;box-shadow:0 4px 12px var(--kr-btn-shadow)}body.page-kramail .editeur-text button.btn-primary.pull-right:hover{transform:translateY(-1px);box-shadow:0 6px 20px var(--kr-btn-shadow)}body.page-kramail .editeur-text button.btn-primary.pull-right:active{transform:translateY(0);box-shadow:0 2px 8px var(--kr-btn-shadow)}body.page-kramail .editeur-text .btn-toolbar{background:var(--kr-bg-hover);border:1px solid var(--kr-border-default);border-radius:var(--kr-radius);padding:8px;margin-bottom:8px;display:flex;flex-wrap:wrap;gap:4px}body.page-kramail .editeur-text .btn-toolbar .btn-group{margin-right:4px;border-right:1px solid var(--kr-border-default);padding-right:8px}body.page-kramail .editeur-text .btn-toolbar .btn-group:last-child{border-right:none;margin-right:0;padding-right:0}body.page-kramail .editeur-text .btn-toolbar .btn{min-width:34px;min-height:32px;display:inline-flex;align-items:center;justify-content:center;border-radius:4px;transition:all .15s ease}body.page-kramail .editeur-text .btn-toolbar .btn:hover{background:var(--kr-bg-active)!important;border-color:var(--kr-primary)!important}body.page-kramail .editeur-text textarea[name="c[5]"],body.page-kramail .editeur-text textarea[placeholder="Votre message"]{min-height:250px;line-height:1.6}body.page-kramail .editeur-text .col-sm-10>.btn-toolbar+textarea.form-control{border-top-left-radius:0!important;border-top-right-radius:0!important;border-top:none!important;margin-top:0}body.page-kramail .editeur-text .col-sm-10>.btn-toolbar{border-bottom-left-radius:0!important;border-bottom-right-radius:0!important;margin-bottom:0!important;border-bottom:1px solid var(--kr-border-default)}body.page-kramail .editeur-text .form-group>label.control-label{font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.4px;color:var(--kr-text-secondary)}body.page-kramail .editeur-text .form-group{margin-bottom:20px}}@media (max-width:768px){body.page-kramail-compose h1.page-header .kramail-character-selector .kramail-character-dropdown,body.page-kramail-compose h1.page-header .kramail-character-selector .kramail-dropdown-icon{display:none!important}body.page-kramail-compose h1.page-header .kramail-character-selector{cursor:default!important;pointer-events:none;flex:1;min-width:0}body.page-kramail-compose h1.page-header{display:flex!important;flex-direction:row!important;align-items:center;gap:10px;flex-wrap:nowrap}body.page-kramail-compose h1.page-header .pull-right{float:none!important;width:auto!important;flex-shrink:0;margin-left:auto}body.page-kramail-compose h1.page-header .pull-right .btn{min-width:44px;min-height:44px;display:inline-flex!important;align-items:center;justify-content:center;padding:8px 12px;font-size:14px;white-space:nowrap}body.page-kramail .editeur-text .input-group{display:flex!important;flex-wrap:nowrap;border-radius:var(--mobile-radius);overflow:hidden}body.page-kramail .editeur-text .input-group-addon{width:44px!important;min-width:44px!important;max-width:44px!important;height:44px!important;flex-shrink:0;display:flex!important;align-items:center;justify-content:center;border-radius:0!important;border-right:none!important;padding:0!important}body.page-kramail .editeur-text .input-group-addon:first-child{border-radius:var(--mobile-radius)0 0 var(--mobile-radius)!important}body.page-kramail .editeur-text .input-group .form-control{flex:1;min-width:0;height:44px!important;border-radius:0 var(--mobile-radius) var(--mobile-radius)0!important;border-left:none!important}body.page-kramail .editeur-text .input-group-addon .btn{width:44px!important;height:44px!important;max-width:44px!important;min-width:44px!important;padding:0!important;margin:0!important;display:flex!important;align-items:center;justify-content:center;font-size:18px;font-weight:700;border:0!important;background:0 0!important;color:inherit}body.page-kramail .editeur-text .btn-toolbar{display:flex!important;flex-wrap:nowrap;gap:0!important;padding:0!important;border-radius:var(--mobile-radius) var(--mobile-radius)0 0!important;border:1px solid var(--kr-border-default)!important;border-bottom:1px solid var(--kr-border-default)!important;margin-bottom:0!important;overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;background:var(--kr-bg-hover)}body.page-kramail .editeur-text .btn-toolbar .btn-group{flex-direction:row!important;width:auto!important;flex-shrink:0;margin:0!important;padding:0!important;border:0!important;border-right:1px solid var(--kr-border-default)!important;border-radius:0!important}body.page-kramail .editeur-text .btn-toolbar>.btn-group:last-child,body.page-kramail .editeur-text .btn-toolbar>.btn-group[aria-label]:last-of-type{border-right:none!important}body.page-kramail .editeur-text .btn-toolbar>.btn-group .dropdown .dropdown-toggle .btn,body.page-kramail .editeur-text .btn-toolbar>.btn-group .dropdown>.dropdown-toggle,body.page-kramail .editeur-text .btn-toolbar>.btn-group .dropdown>a>.btn,body.page-kramail .editeur-text .btn-toolbar>.btn-group>.btn,body.page-kramail .editeur-text .btn-toolbar>.btn-group>a.btn{width:44px!important;max-width:44px!important;min-width:44px!important;height:44px!important;margin:0!important;padding:0!important;border-radius:0!important;border:0!important;border-right:1px solid rgba(255,255,255,.05)!important;display:flex!important;align-items:center;justify-content:center;flex-shrink:0;background:0 0!important;color:var(--kr-text-primary, #f5f1ed)!important}body.page-kramail .editeur-text .btn-toolbar .btn-group .dropdown>.dropdown-toggle>.btn .fa,body.page-kramail .editeur-text .btn-toolbar .btn-group .dropdown>.dropdown-toggle>.btn .far,body.page-kramail .editeur-text .btn-toolbar .btn-group .dropdown>.dropdown-toggle>.btn i,body.page-kramail .editeur-text .btn-toolbar>.btn-group>.btn i,body.page-kramail .editeur-text .btn-toolbar>.btn-group>a.btn i{color:inherit!important}body.page-kramail .editeur-text .btn-toolbar .btn-group .dropdown{display:flex!important;flex-shrink:0}body.page-kramail .editeur-text .btn-toolbar .btn-group .dropdown>.dropdown-toggle>.btn{width:44px!important;height:44px!important;min-width:44px!important;max-width:44px!important;padding:0!important;margin:0!important;border:0!important;border-radius:0!important;background:0 0!important;color:var(--kr-text-primary, #d4a574)!important}body.page-kramail .editeur-text .btn-toolbar .dropdown-menu .btn-group .btn{width:auto!important;height:auto!important;min-width:28px!important;max-width:none!important;min-height:28px!important;padding:4px 6px!important;margin:2px!important;border-radius:4px!important;border:1px solid rgba(255,255,255,.1)!important}body.page-kramail .editeur-text .btn-toolbar>.btn-group:first-child>.btn:first-child,body.page-kramail .editeur-text .btn-toolbar>.btn-group:first-child>a.btn:first-child{border-radius:var(--mobile-radius)0 0 var(--mobile-radius)!important}body.page-kramail .editeur-text .btn-toolbar>.btn-group[aria-label]:last-of-type>.btn:last-child,body.page-kramail .editeur-text .btn-toolbar>.btn-group[aria-label]:last-of-type>a.btn:last-child{border-radius:0 var(--mobile-radius) var(--mobile-radius)0!important;border-right:none!important}body.page-kramail .editeur-text .btn-toolbar .btn:active{background:rgba(139,15,14,.15)!important}body.page-kramail .editeur-text .btn-toolbar::-webkit-scrollbar{height:3px}body.page-kramail .editeur-text .btn-toolbar::-webkit-scrollbar-thumb{background:rgba(255,255,255,.15);border-radius:2px}body.page-kramail .editeur-text .btn-toolbar+textarea.form-control,body.page-kramail .editeur-text .col-sm-10>.btn-toolbar+textarea.form-control{border-top-left-radius:0!important;border-top-right-radius:0!important;border-top:none!important;margin-top:0}body.page-kramail .editeur-text .btn-toolbar .dropdown-menu{position:fixed!important;bottom:60px!important;left:8px!important;right:8px!important;top:auto!important;width:auto!important;max-width:calc(100vw - 16px)!important;max-height:50vh;overflow-y:auto;border-radius:var(--mobile-radius) var(--mobile-radius)0 0!important;box-shadow:0-4px 24px rgba(0,0,0,.4)!important;z-index:1050!important;background:var(--kr-bg-surface)!important;border:1px solid var(--kr-border-default)!important;padding:12px!important}body.page-kramail .editeur-text .checkbox-inline{display:flex!important;align-items:center;gap:8px;padding-left:0!important;margin-right:16px;margin-bottom:8px;min-height:44px;white-space:nowrap}body.page-kramail .editeur-text .checkbox-inline input[type=checkbox]{position:static!important;margin-left:0!important;margin-top:0!important;width:20px!important;height:20px!important;min-width:20px;flex-shrink:0}body.page-kramail .editeur-text .form-group:has(input[type=checkbox]){background:var(--kr-bg-hover);border:1px solid var(--kr-border-default);border-radius:var(--mobile-radius);padding:12px 16px!important;margin-top:8px}body.page-kramail .editeur-text .form-group>label.control-label{color:var(--kr-text-secondary)}body.page-kramail .editeur-text .form-group:last-of-type{padding-bottom:70px!important}}.forum-thread-detail>div:nth-of-type(2),.page-forum-sujet [role=main]>div>div:nth-of-type(2)>div:nth-of-type(3){display:none}.forum-thread-metadata+div:has(a[href*="/forum/tags/"]){display:none}.kr-changelog-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000;opacity:0;transition:opacity .3s ease}.kr-changelog-modal.active{opacity:1;display:flex;align-items:center;justify-content:center}.kr-changelog-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.75)!important;cursor:pointer}.kr-changelog-header{padding:24px 24px 16px;border-bottom:1px solid var(--kr-border-default);position:relative}.kr-changelog-header h2,.kr-changelog-version h3{margin:0;font-size:20px;font-weight:600;color:var(--kr-primary)}.kr-changelog-close{display:none!important}.kr-changelog-body{padding:16px 24px;overflow-y:auto;flex:1}.kr-changelog-subtitle{margin:0 0 16px;color:var(--kr-muted);font-size:14px}.kr-changelog-list,.kr-changelog-version ul{list-style:none;padding:0;margin:0}.kr-changelog-list li,.kr-changelog-version li{padding:8px 0 8px 24px;position:relative;color:var(--kr-text);line-height:1.5;font-size:14px}.kr-changelog-list li:before{content:"✓";position:absolute;left:0;color:var(--kr-primary);font-weight:700;font-size:16px}.kr-changelog-footer{padding:16px 24px;border-top:1px solid var(--kr-border-default);display:flex;gap:12px;flex-wrap:wrap}.kr-changelog-footer button{flex:1;min-width:120px;padding:10px 16px;border:1px solid var(--kr-border-strong);border-radius:var(--kr-radius);background:var(--kr-surface);color:var(--kr-text);cursor:pointer;font-size:14px;font-weight:500;transition:all .2s}.kr-changelog-view-all{background:var(--kr-primary)!important;color:#fff!important;border-color:var(--kr-primary)!important}.kr-changelog-view-all:hover{background:var(--kr-primary-dark)!important;border-color:var(--kr-primary-dark)!important}.kr-changelog-close-btn:hover{background:var(--kr-bg-hover)}.kr-changelog-modal.kr-changelog-full .kr-changelog-content-full{max-width:800px}.kr-changelog-body-full{max-height:500px}.kr-changelog-version{margin-bottom:24px}.kr-changelog-version h3{margin:0 0 12px;font-size:16px;padding-bottom:8px;border-bottom:1px solid var(--kr-border-default)}.kr-changelog-version li{padding:6px 0 6px 20px;font-size:13px}.kr-changelog-version li:before{content:"•";position:absolute;left:5px;color:var(--kr-primary);font-weight:700}.kr-changelog-btn{margin-bottom:16px}.kr-changelog-inline{color:var(--kr-primary);text-decoration:none;border:0;background:0 0;padding:0;font-size:13px;margin-left:8px;vertical-align:middle;cursor:pointer;display:inline}.kr-changelog-inline:hover{color:var(--kr-primary-dark);text-decoration:underline}@media (max-width:768px){.kr-changelog-content{width:95%;max-height:85vh}.kr-changelog-header{padding:16px 16px 12px}.kr-changelog-header h2{font-size:18px}.kr-changelog-body{padding:12px 16px}.kr-changelog-list li{padding:6px 0 6px 20px;font-size:13px}.kr-changelog-footer{padding:12px 16px;flex-direction:column}.kr-changelog-footer button{width:100%}.kr-changelog-content-full{max-width:95%}}html[class*=-dark] .mini{color:var(--kr-text-primary)!important;text-shadow:0 1px 0 rgba(0,0,0,.6);padding:2px 6px;border-radius:3px;font-weight:700;background-image:none!important;background-color:rgba(0,0,0,.6)!important}html[class*=-dark] .mini.c3,html[class*=-dark] .mini.c5{background-color:rgba(255,255,128,.92)!important;color:var(--kr-text-inverse)!important}html[class*=-dark] .mini.c5{background-color:rgba(128,255,128,.92)!important}html:not([class*=-dark]) .mini{padding:2px 6px;border-radius:3px;font-weight:700}}',ENABLE_KEY:"kr-theme-enabled",VARIANT_KEY:"kr-theme-variant",STATS_DISPLAY_KEY:"kr-stats-display",STYLE_ID:"kraland-theme-style",THEME_VARIANTS:["kraland","empire-brun","paladium","theocratie-seelienne","paradigme-vert","khanat-elmerien","confederation-libre","royaume-ruthvenie","empire-brun-dark","paladium-dark","theocratie-seelienne-dark","paradigme-vert-dark","khanat-elmerien-dark","confederation-libre-dark","royaume-ruthvenie-dark","high-contrast"],LOGO_MAP:{kraland:1,"empire-brun":2,"empire-brun-dark":2,paladium:3,"paladium-dark":3,"theocratie-seelienne":4,"theocratie-seelienne-dark":4,"paradigme-vert":5,"paradigme-vert-dark":5,"khanat-elmerien":6,"khanat-elmerien-dark":6,"confederation-libre":7,"confederation-libre-dark":7,"royaume-ruthvenie":8,"royaume-ruthvenie-dark":8},SKILL_ICONS:{Baratin:"9401","Combat Mains Nues":"9402","Combat Contact":"9403","Combat Distance":"9404",Commerce:"9405","Démolition":"9406","Discrétion":"9407","Éloquence":"9408",Falsification:"9409",Foi:"9410",Informatique:"9411","Médecine":"9412",Observation:"9413",Organisation:"9414",Pouvoir:"9415","Séduction":"9416",Survie:"9417",Vol:"9418"},STAT_ICONS:{FOR:"9402",VOL:"9415",CHA:"9416",INT:"9412",GES:"9405",PER:"9413"},MEDIEVAL_MAP_KEY:"kr-medieval-map",MEDIEVAL_MAP_STYLE_ID:"kr-medieval-map-style",MEDIEVAL_MAP_OVERRIDES:{"http://img7.kraland.org/2/map/1/54.gif":"https://i.imgur.com/yQaUb2q.png","http://img7.kraland.org/2/map/1/123.gif":"https://i.imgur.com/zeD5Q3m.gif","http://img7.kraland.org/2/map/1/124.gif":"https://i.imgur.com/kT1NcMR.gif","http://img7.kraland.org/2/map/1/125.gif":"https://i.imgur.com/OZcbEpv.gif","http://img7.kraland.org/2/map/1/126.gif":"https://i.imgur.com/pnNPvQa.gif","http://img7.kraland.org/2/map/1/127.gif":"https://i.imgur.com/AWDyET8.gif","http://img7.kraland.org/2/map/1/128.gif":"https://i.imgur.com/v9BUsFz.gif","http://img7.kraland.org/2/map/1/129.gif":"https://i.imgur.com/F3hWy6L.gif","http://img7.kraland.org/2/map/1/130.gif":"https://i.imgur.com/dQ1eAgR.gif","http://img7.kraland.org/2/map/1/131.gif":"https://i.imgur.com/hQzJHvq.gif","http://img7.kraland.org/2/map/1/150.gif":"https://i.imgur.com/b4gCbux.png","http://img7.kraland.org/2/map/1/160.gif":"https://i.imgur.com/u3pxKOO.gif","http://img7.kraland.org/2/map/1/161.gif":"https://i.imgur.com/SptXelD.gif","http://img7.kraland.org/2/map/1/162.gif":"https://i.imgur.com/r9AajUr.gif","http://img7.kraland.org/2/map/1/163.gif":"https://i.imgur.com/j0E8T1P.gif","http://img7.kraland.org/2/map/1/164.gif":"https://i.imgur.com/ogaiUqe.gif","http://img7.kraland.org/2/map/1/165.gif":"https://i.imgur.com/qe3sdQF.gif","http://img7.kraland.org/2/map/1/166.gif":"https://i.imgur.com/Z6QHBzh.gif","http://img7.kraland.org/2/map/1/167.gif":"https://i.imgur.com/DtNeOzd.gif","http://img7.kraland.org/2/map/1/168.gif":"https://i.imgur.com/bowPMN6.gif","http://img7.kraland.org/2/map/1/169.gif":"https://i.imgur.com/o7CILuq.gif","http://img7.kraland.org/2/map/1/170.gif":"https://i.imgur.com/y9U0dYl.gif","http://img7.kraland.org/2/map/1b/54.gif":"https://i.imgur.com/06sWizC.png","http://img7.kraland.org/2/map/1b/123.gif":"https://i.imgur.com/AVfs5gP.gif","http://img7.kraland.org/2/map/1b/124.gif":"https://i.imgur.com/5EXjAMq.gif","http://img7.kraland.org/2/map/1b/125.gif":"https://i.imgur.com/2W8B2Dt.gif","http://img7.kraland.org/2/map/1b/126.gif":"https://i.imgur.com/4bBE651.gif","http://img7.kraland.org/2/map/1b/127.gif":"https://i.imgur.com/MlV4iYC.gif","http://img7.kraland.org/2/map/1b/128.gif":"https://i.imgur.com/rmU5dY2.gif","http://img7.kraland.org/2/map/1b/129.gif":"https://i.imgur.com/YeujdJG.gif","http://img7.kraland.org/2/map/1b/130.gif":"https://i.imgur.com/PqDVOX3.gif","http://img7.kraland.org/2/map/1b/131.gif":"https://i.imgur.com/W8FRpdH.gif","http://img7.kraland.org/2/map/1b/150.gif":"https://i.imgur.com/w6yVuNX.png","http://img7.kraland.org/2/map/1b/160.gif":"https://i.imgur.com/bHKR6EJ.gif","http://img7.kraland.org/2/map/1b/161.gif":"https://i.imgur.com/yrfMXwl.gif","http://img7.kraland.org/2/map/1b/162.gif":"https://i.imgur.com/qfSfUkX.gif","http://img7.kraland.org/2/map/1b/163.gif":"https://i.imgur.com/MR7miUh.gif","http://img7.kraland.org/2/map/1b/164.gif":"https://i.imgur.com/MMunrUy.gif","http://img7.kraland.org/2/map/1b/165.gif":"https://i.imgur.com/Kqs7t39.gif","http://img7.kraland.org/2/map/1b/166.gif":"https://i.imgur.com/6FoA0Hi.gif","http://img7.kraland.org/2/map/1b/167.gif":"https://i.imgur.com/Jgu5rX9.gif","http://img7.kraland.org/2/map/1b/168.gif":"https://i.imgur.com/KCPBL3T.gif","http://img7.kraland.org/2/map/1b/169.gif":"https://i.imgur.com/uBJObWh.gif","http://img7.kraland.org/2/map/1b/170.gif":"https://i.imgur.com/FfpTfLi.gif"},MEDIEVAL_SEPIA:"85%"};function a(t){try{t()}catch(t){}}function n(){return"false"!==localStorage.getItem(o.ENABLE_KEY)}function i(){return localStorage.getItem(o.VARIANT_KEY)||"kraland"}function l(){return localStorage.getItem(o.STATS_DISPLAY_KEY)||"icon"}function d(t){if(!t)return null;const e=t.match(/url\((?:'|")?(.*?)(?:'|")?\)/);return e?e[1]:null}function s(){try{const t="data-kr-medieval-applied",e="data-kr-medieval-original-bg",r="data-kr-medieval-original-filter",a={};function n(n){if(!n||n.getAttribute&&"true"===n.getAttribute(t)||n.getAttribute&&"true"===n.getAttribute("data-kr-medieval-pending"))return;let i=null;if("IMG"===n.tagName)i=n.src||n.getAttribute("src");else{const t=n.style&&n.style.getPropertyValue("background-image")||"",e=t||window.getComputedStyle&&getComputedStyle(n).backgroundImage||"";i=d(t)||d(e)}if(!i)return;if(o.MEDIEVAL_NO_REPLACE&&o.MEDIEVAL_NO_REPLACE[i])return;const l=function(t){if(!t)return null;const e=o.MEDIEVAL_MAP_OVERRIDES||{};return e[t]?e[t]:-1!==t.indexOf("/2/map/1b/")?t.replace("/2/map/1b/","/2/map/5/"):-1!==t.indexOf("/2/map/1/")?t.replace("/2/map/1/","/2/map/5/"):null}(i);if(!l)return;n.setAttribute&&n.setAttribute("data-kr-medieval-pending","true"),n.hasAttribute&&n.hasAttribute(e)||n.setAttribute(e,i);const s=n.style&&n.style.getPropertyValue("filter")||"";var c;n.hasAttribute&&n.hasAttribute(r)||n.setAttribute(r,s),(c=l,a.hasOwnProperty(c)?Promise.resolve(!!a[c]):new Promise(t=>{try{const e=new Image;e.onload=()=>{a[c]=!0,t(!0)},e.onerror=()=>{a[c]=!1,t(!1)},e.src=c}catch(e){a[c]=!1,t(!1)}})).then(a=>{if(a){if("IMG"===n.tagName)try{n.src=l}catch(t){n.setAttribute("src",l)}else n.style&&n.style.setProperty&&n.style.setProperty("background-image",'url("'+l+'")',"important");-1!==i.indexOf("/2/map/1b/")&&n.style&&n.style.setProperty&&n.style.setProperty("filter","sepia("+o.MEDIEVAL_SEPIA+")","important"),n.setAttribute&&n.setAttribute(t,"true")}else{const t=n.getAttribute(e);if("IMG"===n.tagName){if(t)try{n.src=t}catch(e){n.setAttribute("src",t)}}else t?n.style&&n.style.setProperty&&n.style.setProperty("background-image",'url("'+t+'")',"important"):n.style&&n.style.removeProperty&&n.style.removeProperty("background-image");const o=n.getAttribute(r);o?n.style&&n.style.setProperty&&n.style.setProperty("filter",o,"important"):n.style&&n.style.removeProperty&&n.style.removeProperty("filter")}n.removeAttribute&&n.removeAttribute("data-kr-medieval-pending")}).catch(t=>{n.removeAttribute&&n.removeAttribute("data-kr-medieval-pending")})}function i(){document.querySelectorAll("["+t+'="true"]').forEach(o=>{const a=o.getAttribute(e);if("IMG"===o.tagName)if(a)try{o.src=a}catch(t){o.setAttribute("src",a)}else o.removeAttribute&&o.removeAttribute("src");else a?o.style&&o.style.setProperty&&o.style.setProperty("background-image",'url("'+a+'")',"important"):o.style&&o.style.removeProperty&&o.style.removeProperty("background-image");const n=o.getAttribute(r);n?o.style&&o.style.setProperty&&o.style.setProperty("filter",n,"important"):o.style&&o.style.removeProperty&&o.style.removeProperty("filter"),o.removeAttribute&&o.removeAttribute(t),o.removeAttribute&&o.removeAttribute(e),o.removeAttribute&&o.removeAttribute(r)})}if("true"===localStorage.getItem(o.MEDIEVAL_MAP_KEY)){if(document.documentElement.classList.add("kr-medieval-map-enabled"),document.querySelectorAll('div[style*="/2/map/1/"], div[style*="/2/map/1b/"], img[src*="/2/map/1/"], img[src*="/2/map/1b/"]').forEach(n),!s._observer){const l=new MutationObserver(t=>{t.forEach(t=>{"attributes"!==t.type||"style"!==t.attributeName&&"src"!==t.attributeName||!t.target||1!==t.target.nodeType?"childList"===t.type&&t.addedNodes.forEach(t=>{1===t.nodeType&&(t.matches&&(t.matches('div[style*="/2/map/1/"]')||t.matches('div[style*="/2/map/1b/"]')||t.matches('img[src*="/2/map/1/"]')||t.matches('img[src*="/2/map/1b/"]'))&&n(t),t.querySelectorAll&&t.querySelectorAll('div[style*="/2/map/1/"], div[style*="/2/map/1b/"], img[src*="/2/map/1/"], img[src*="/2/map/1b/"]').forEach(n))}):n(t.target)})});l.observe(document.body||document.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","src"]}),s._observer=l}}else document.documentElement.classList.remove("kr-medieval-map-enabled"),i(),s._observer&&(s._observer.disconnect(),s._observer=null);return!0}catch(c){return console.error("applyMedievalMapOption error",c),!1}}function c(){const t=location?.pathname||"";return 0===t.indexOf("/jouer")&&"/jouer/communaute"!==t&&"/jouer/communaute/membres"!==t}function m(){const t=document.documentElement;t.style.setProperty("transition","opacity .18s ease-in"),t.style.setProperty("opacity","1"),setTimeout(()=>{t.style.removeProperty("transition"),t.style.removeProperty("opacity")},250)}function p(t){if(!n())return!1;try{let e=document.getElementById(o.STYLE_ID);e?e.textContent=t:(e=document.createElement("style"),e.id=o.STYLE_ID,e.textContent=t,document.head.appendChild(e)),document.documentElement.classList.add("kr-theme-enabled");const r=i();document.documentElement.classList.toggle("kr-theme-high-contrast","high-contrast"===r),o.THEME_VARIANTS.forEach(t=>document.documentElement.classList.remove("kr-theme-variant-"+t)),r&&"disable"!==r&&document.documentElement.classList.add("kr-theme-variant-"+r);const a=0===location?.pathname?.indexOf("/communaute/membres");return document.documentElement.classList.toggle("kr-page-members",a),!0}catch(t){return console.error("Theme apply failed",t),!1}}function u(){n()&&p(o.BUNDLED_CSS)}function g(t,e=!1){try{if(!t||"disable"===t)return localStorage.setItem(o.ENABLE_KEY,"false"),void(e||location.reload());const r=!n();if(localStorage.setItem(o.ENABLE_KEY,"true"),localStorage.setItem(o.VARIANT_KEY,t),r&&!e)return void location.reload();o.THEME_VARIANTS.forEach(t=>document.documentElement.classList.remove("kr-theme-variant-"+t)),document.documentElement.classList.add("kr-theme-variant-"+t),document.documentElement.classList.add("kr-theme-enabled"),a(()=>p(o.BUNDLED_CSS)),a(()=>E())}catch(t){console.error("applyThemeVariant error",t)}}function b(){"true"===localStorage.getItem("kr-hide-footer-quote")?document.documentElement.classList.add("kr-hide-footer-quote"):document.documentElement.classList.remove("kr-hide-footer-quote")}function h(){n()&&[x,w,S,E,C,A,L,q,T,N,M,I,P,z,_,B,j,F,D,H,k,f,v,window.updateForumRPMenu,window.updateForumHRPMenu,window.updateForumCommunauteMenu,window.updateForumDebatsMenu,window.updateForumStaffMenu,y,b,G].forEach(t=>a(t))}function f(){document.querySelectorAll('[data-toggle="tooltip"]').forEach(t=>{const e=document.body.classList.contains("mobile-mode"),r=t.closest(".col-leftest"),o=t.closest(".panel-body.grid-transformed");(e||r||o)&&(t.removeAttribute("data-toggle"),t.removeAttribute("data-placement"),t.removeAttribute("title"),t.removeAttribute("data-original-title"))}),window.$&&window.$.fn&&window.$.fn.tooltip&&(window.$.fn.tooltip=function(){return this})}function k(){window.location.pathname.startsWith("/forum/")&&document.querySelectorAll('img[src*="img7.kraland.org/2/rank/"]').forEach(t=>{let e=t.getAttribute("data-original-title")||t.getAttribute("title");if(!e)return;let r=t.closest("div");if(!r||!r.parentElement)return;let o=r.closest(".cartouche")||r.closest('div[class="cartouche"]');o||(o=r.parentElement),o&&o.querySelector('strong a[href*="charlie-2-82045"]')&&"Empereur"===e&&(e="Emperatrice"),"Gouverneure Mystisie"===e?e="Sultane Eternelle de Mystisie":"Gouverneur Mystisie"===e&&(e="Sultan Eternel de Mystisie");const a=r.parentElement.querySelectorAll("div");let n=!1;for(let t of a)if(t.textContent.trim()===e&&t!==r){n=!0;break}if(n)return;const i=r.nextElementSibling;if(i&&i.hasAttribute("data-kr-rank-title"))return;const l=document.createElement("div");l.setAttribute("data-kr-rank-title","true"),l.style.display="flex",l.style.alignItems="center",l.style.justifyContent="center",l.style.gap="4px",l.style.marginTop="4px";const d=r.querySelector('img[src*="/rank/"]');d&&l.appendChild(d.cloneNode(!0));const s=document.createElement("strong");s.textContent=e,l.appendChild(s),r.parentElement&&r.parentElement.replaceChild(l,r)})}function y(){if(!c())return;const t=document.querySelector(".dashboard");if(!t)return;const e=t.querySelectorAll(":scope > .panel");if(!e.length)return;const r=document.createElement("div");r.className="dashboard-flex";const o=[];let a=!1;e.forEach(t=>{const e=t.querySelector(".panel-body");if(!e)return;if(!e.querySelector("table"))return;const r=t.querySelector(".panel-heading .panel-title"),n=r?r.textContent.trim():"";if(!n.toLowerCase().includes("groupe"))return;const i=function(t){const e={title:"",groupButtons:[],members:[]},r=t.querySelector(".panel-heading");if(r){const t=r.querySelector(".panel-title");t&&(e.title=t.textContent.trim(),t.querySelectorAll("a.btn").forEach(t=>{e.groupButtons.push(t.cloneNode(!0))}))}const o=t.querySelector(".panel-body");if(!o)return e;const a=o.querySelector("table");return a?(a.querySelectorAll("tr").forEach(t=>{const r=t.querySelector("td:first-child"),o=t.querySelector("td:last-child");if(!r||!o)return;const a=r.querySelectorAll("a.list-group-item.ds_game"),n=o.querySelectorAll('div[style*="height:59px"]');a.forEach((t,r)=>{const o=function(t,e){const r={originalLink:t,avatar:null,name:"",status:"",isPNJ:!1,worldImage:null,hpInfo:null,pvLevel:null,profileUrl:"",actionsDiv:null},o=t.querySelector("img.pull-left");o&&(r.avatar=o.src);const a=t.querySelector(".list-group-item-heading"),n=t.querySelector(".list-group-item-text");a&&(r.name=a.textContent.trim()),n&&(r.status=n.textContent.trim()),t.querySelector(".btn-danger.xmini")&&(r.isPNJ=!0);const i=t.querySelector(".mention.pull-right");if(i){const t=i.querySelector('img[src*="world"]');t&&(r.worldImage=t.src);const e=i.querySelector('img[src*="pdv"]');if(e){const t=e.src.match(/pdv(\d)\.png/);t&&(r.pvLevel=parseInt(t[1],10))}const o=i.querySelector('div[style*="background"]');if(o){const t=(o.getAttribute("style")||"").match(/width:\s*(\d+)%/);t&&(r.hpInfo=parseInt(t[1],10))}}return r.profileUrl=t.href,e&&(r.actionsDiv=e.cloneNode(!0)),r}(t,n[r]||null);e.members.push(o)})}),e):e}(t);if(0===i.members.length)return;const l=!a;n.toLowerCase().includes("groupe")&&(a=!0),o.push({isMyGroup:l,title:i.title,groupButtons:i.groupButtons,members:i.members})}),0!==o.length&&(o.forEach((t,e)=>{const o=document.createElement("div");o.className=t.isMyGroup?"dashboard-section dashboard-section-mygroup":"dashboard-section dashboard-section-others";const a=document.createElement("div");if(a.className="dashboard-section-header",t.groupButtons&&t.groupButtons.length>0){const e=document.createElement("div");e.className="dashboard-group-buttons",t.groupButtons.forEach(t=>{e.appendChild(t)}),a.appendChild(e)}const n=document.createElement("span");if(n.className="dashboard-group-title",t.isMyGroup){const e=t.title.replace(/\s*Groupe\s+/i,"");n.textContent=e||"Mon groupe"}else{const e=t.title.replace(/\s*Groupe\s+/i,"");n.textContent=e||`Groupe de ${t.members[0]?.name||"Inconnu"}`}a.appendChild(n),o.appendChild(a);const i=document.createElement("div");i.className=t.isMyGroup?"dashboard-cards-grid dashboard-cards-large":"dashboard-cards-grid",t.members.forEach(e=>{i.appendChild(function(t,e=!1){const r=document.createElement("div");r.className=e?"dashboard-card dashboard-card-large":"dashboard-card";const o=t.originalLink.cloneNode(!1);o.classList.add("dashboard-card-link");const a=document.createElement("div");if(a.className="dashboard-card-header",t.avatar){const e=document.createElement("div");if(e.className="dashboard-card-avatar-wrapper",t.pvLevel){const r=function(t){if(!t)return null;const e={1:{color:"#32CD32",percentage:100},2:{color:"#FFD700",percentage:80},3:{color:"#FF8C00",percentage:60},4:{color:"#DC143C",percentage:40},5:{color:"#8B0000",percentage:20}},r=e[t]||e[1],o=2*Math.PI*37,a=o-o*r.percentage/100,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("class","dashboard-card-hp-circle"),n.setAttribute("width","82"),n.setAttribute("height","82"),n.setAttribute("viewBox","0 0 82 82");const i=document.createElementNS("http://www.w3.org/2000/svg","circle");i.setAttribute("cx","41"),i.setAttribute("cy","41"),i.setAttribute("r",37),i.setAttribute("fill","none"),i.setAttribute("stroke","rgba(0,0,0,0.1)"),i.setAttribute("stroke-width","3");const l=document.createElementNS("http://www.w3.org/2000/svg","circle");return l.setAttribute("cx","41"),l.setAttribute("cy","41"),l.setAttribute("r",37),l.setAttribute("fill","none"),l.setAttribute("stroke",r.color),l.setAttribute("stroke-width","4"),l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-dasharray",o),l.setAttribute("stroke-dashoffset",a),l.setAttribute("transform","rotate(-90 41 41)"),n.appendChild(i),n.appendChild(l),n}(t.pvLevel);r&&e.appendChild(r)}const r=document.createElement("img");r.src=t.avatar,r.className="dashboard-card-avatar",r.alt=t.name,5===t.pvLevel&&(r.style.filter="grayscale(100%)",r.style.opacity="0.7"),e.appendChild(r),a.appendChild(e)}const n=document.createElement("div");if(n.className="dashboard-card-name-container",t.worldImage){const e=document.createElement("img");e.src=t.worldImage,e.className="dashboard-card-world",e.alt="World",n.appendChild(e)}const i=document.createElement("div");i.className="dashboard-card-name",i.textContent=t.name,n.appendChild(i),a.appendChild(n),o.appendChild(a);const l=document.createElement("div");if(l.className="dashboard-card-body",t.status){const e=document.createElement("div");e.className="dashboard-card-status",e.textContent=t.status,l.appendChild(e)}if(o.appendChild(l),r.appendChild(o),null!==t.hpInfo){const e=document.createElement("div");e.className="dashboard-card-hp";const o=document.createElement("div");o.className="dashboard-card-hp-fill",o.style.width=t.hpInfo+"%",t.hpInfo>70?o.style.backgroundColor="#5cb85c":t.hpInfo>30?o.style.backgroundColor="#f0ad4e":o.style.backgroundColor="#d9534f",e.appendChild(o),r.appendChild(e)}if(t.isPNJ){const t=document.createElement("span");t.className="dashboard-card-pnj",t.textContent="PNJ",r.appendChild(t)}if(t.actionsDiv){const e=document.createElement("div");e.className="dashboard-card-actions",t.actionsDiv.querySelectorAll("a").forEach(t=>{e.appendChild(t.cloneNode(!0))}),r.appendChild(e)}return r}(e,t.isMyGroup))}),o.appendChild(i),r.appendChild(o)}),t.innerHTML="",t.appendChild(r))}function v(){const t={Jouer:"jouer/plateau","Règles":"regles/avancees",Monde:"monde/evenements","Communauté":"communaute/membres"};let e=null;const r=document.body.classList.contains("mobile-mode");if(document.querySelectorAll(".navbar-nav .dropdown > a.dropdown-toggle").forEach(o=>{const a=o.textContent.trim().replace(/\s*\n.*$/,"");if(a.startsWith("Forum")&&!a.includes("HRP")&&!a.includes("RP"))return void(e=o.closest("li.dropdown"));const n=Object.keys(t).find(t=>a.includes(t));n&&t[n]&&(o.href=t[n],r?o.setAttribute("data-toggle","dropdown"):(o.removeAttribute("data-toggle"),o.hasAttribute("data-nav-modified")||(o.setAttribute("data-nav-modified","true"),o.addEventListener("click",function(t){return t.preventDefault(),window.location.href=this.href,!1}))))}),e&&!document.querySelector("[data-forums-added]")){const t=e.querySelector(".dropdown-menu"),o=document.createElement("li");o.className="dropdown",o.setAttribute("data-forums-added","rp"),o.innerHTML='\n        <a href="forum/rp" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n          Forum RP <span class="caret"></span>\n        </a>\n        <ul class="dropdown-menu" role="menu">\n          <li><a href="forum/rp/taverne-10101">Taverne</a></li>\n          <li><a href="forum/rp/marche-10102">Marché</a></li>\n          <li><a href="forum/rp/monde-10103">Monde</a></li>\n          <li class="divider"></li>\n          <li><a href="forum/rp">Autre</a></li>\n        </ul>\n      ';const a=document.createElement("li");if(a.className="dropdown",a.setAttribute("data-forums-added","hrp"),a.innerHTML='\n        <a href="forum/hrp" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n          Forum HRP <span class="caret"></span>\n        </a>\n      ',t){const e=t.cloneNode(!0),r=Array.from(e.querySelectorAll("li > a")).find(t=>t.textContent.includes("Jeu (RP)"));r&&r.parentElement&&r.parentElement.remove(),a.appendChild(e)}if(e.parentElement&&(e.parentElement.insertBefore(o,e),e.parentElement.insertBefore(a,e)),e.remove(),r){const t=o.querySelector("a.dropdown-toggle");t&&t.setAttribute("data-toggle","dropdown");const e=a.querySelector("a.dropdown-toggle");e&&e.setAttribute("data-toggle","dropdown")}else{const t=o.querySelector("a.dropdown-toggle");t&&(t.removeAttribute("data-toggle"),t.addEventListener("click",function(t){return t.preventDefault(),window.location.href=this.href,!1}));const e=a.querySelector("a.dropdown-toggle");e&&(e.removeAttribute("data-toggle"),e.addEventListener("click",function(t){return t.preventDefault(),window.location.href=this.href,!1}))}const n=o.parentElement;if(n&&!document.querySelector('[data-forums-added="forum-communaute"]')){let e=!1;t&&(e=!!Array.from(t.querySelectorAll("li > a")).find(t=>t.textContent.toLowerCase().includes("staff")));const o=document.createElement("li");o.className="dropdown",o.setAttribute("data-forums-added","forum-communaute"),o.innerHTML='\n          <a href="forum/communaute" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n            Forum Communauté <span class="caret"></span>\n          </a>\n          <ul class="dropdown-menu" role="menu">\n            <li><a href="forum/communaute">Voir tous les sujets</a></li>\n          </ul>\n        ';const i=document.createElement("li");i.className="dropdown",i.setAttribute("data-forums-added","forum-debats"),i.innerHTML='\n          <a href="forum/debats" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n            Forum Débats <span class="caret"></span>\n          </a>\n          <ul class="dropdown-menu" role="menu">\n            <li><a href="forum/debats">Voir tous les sujets</a></li>\n          </ul>\n        ';let l=null;if(e&&(l=document.createElement("li"),l.className="dropdown",l.setAttribute("data-forums-added","forum-staff"),l.innerHTML='\n            <a href="forum/staff" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n              Forum Staff <span class="caret"></span>\n            </a>\n            <ul class="dropdown-menu" role="menu">\n              <li><a href="forum/staff">Voir tous les sujets</a></li>\n            </ul>\n          '),n.insertBefore(o,a.nextSibling),n.insertBefore(i,o.nextSibling),l&&n.insertBefore(l,i.nextSibling),r){const t=[o,i];l&&t.push(l),t.forEach(t=>{const e=t.querySelector("a.dropdown-toggle");e&&e.setAttribute("data-toggle","dropdown")})}else{const t=[o,i];l&&t.push(l),t.forEach(t=>{const e=t.querySelector("a.dropdown-toggle");e&&(e.removeAttribute("data-toggle"),e.addEventListener("click",function(t){return t.preventDefault(),window.location.href=this.href,!1}))})}}}const o=Array.from(document.querySelectorAll(".navbar-nav > li.dropdown")).find(t=>t.querySelector("a.dropdown-toggle")?.textContent.includes("Communauté")&&!t.getAttribute("data-forums-added"));if(o&&!document.querySelector("[data-stats-menu-added]")){const t=document.createElement("li");if(t.className="dropdown",t.setAttribute("data-stats-menu-added","true"),t.innerHTML='\n        <a href="monde/citoyens" class="dropdown-toggle" role="button" aria-expanded="false" data-nav-modified="true">\n          Statistiques <span class="caret"></span>\n        </a>\n        <ul class="dropdown-menu" role="menu">\n          <li><a href="communaute/stats">Communautés</a></li>\n          <li><a href="monde/citoyens">Citoyens</a></li>\n        </ul>\n      ',o.parentElement&&o.parentElement.insertBefore(t,o.nextSibling),r){const e=t.querySelector("a.dropdown-toggle");e&&e.setAttribute("data-toggle","dropdown")}else{const e=t.querySelector("a.dropdown-toggle");e&&(e.removeAttribute("data-toggle"),e.addEventListener("click",function(t){return t.preventDefault(),window.location.href=this.href,!1}))}}}function x(){const t=[{text:"Membres actifs",cls:"kr-icon-members"},{text:"Personnages actifs",cls:"kr-icon-characters"},{text:"Personnes en ligne",cls:"kr-icon-online"},{text:"Présentation",cls:"kr-icon-presentation"},{text:"Médailles",cls:"kr-icon-medals"}];t.forEach(t=>document.querySelectorAll("."+t.cls).forEach(e=>e.classList.remove(t.cls)));const e=Array.from(document.querySelectorAll("*"));t.forEach(t=>{let r=null;for(const o of e){const e=(o.textContent||"").trim();if(!e.includes(t.text))continue;const a=(o.querySelector("i.fa, i.falarge, .glyphicon, svg")?100:0)+Math.max(0,200-Math.min(e.length,200));(!r||a>r.score)&&(r={el:o,score:a})}r?.el&&r.el.classList.add(t.cls)})}function w(){Array.from(document.querySelectorAll("a")).filter(t=>"MC"===(t.textContent||"").trim()).forEach(t=>{t.classList.add("kr-mc-icon");const e=t.getAttribute("data-original-title")||t.getAttribute("title")||(t.classList.contains("open")?"ouvrir le mini-chat":"fermer le mini-chat");e&&t.setAttribute("aria-label",e),t.removeAttribute("aria-hidden")})}function E(){const t=document.querySelector(".navbar-brand");if(!t)return;const e=i(),r=o.LOGO_MAP[e]||1,a=`http://img7.kraland.org/2/world/logo${r}.gif`,n=t.querySelector("img.kr-logo");if(n?.src?.includes(`logo${r}.gif`))return;t.innerHTML="";const l=document.createElement("img");l.className="kr-logo",l.src=a,l.alt="Kraland",l.style.height="28px",l.style.verticalAlign="middle",t.appendChild(l)}function S(){const t={"s1.gif":"♂","s2.gif":"♀","s3.gif":"⚧"};Array.from(document.querySelectorAll("img")).filter(t=>/img7\.kraland\.org\/.+\/(s[123]\.gif)$/.test(t.src)).forEach(e=>{const r=e.src.match(/(s[123]\.gif)$/),o=r?.[1],a=t[o]||"",n=document.createElement("span");if(n.className="kr-symbol kr-symbol-"+(o||"s"),n.setAttribute("aria-hidden","true"),n.textContent=a,e.alt){const t=document.createElement("span");t.className="kr-sr-only",t.textContent=e.alt,n.appendChild(t)}if(e.closest('[id*="sex"]')){const t=document.createElement("strong");t.appendChild(n),e.replaceWith(t)}else e.replaceWith(n)})}function C(){document.querySelectorAll("span.btn-group-xs").forEach(t=>{const e=t.parentElement;if(!e)return;const r=e.querySelector("strong");if(r&&r.parentElement===e&&t.nextElementSibling!==r)return void e.insertBefore(t,r);const o=Array.from(e.childNodes).find(t=>3===t.nodeType&&t.textContent?.trim().length>0);o&&t.nextSibling!==o&&e.insertBefore(t,o)})}function A(){document.querySelectorAll('[id*="ajax-sex"]').forEach(t=>{if(t.querySelector("strong"))return;const e=t.querySelector(".kr-symbol");if(e&&e.parentElement){const t=document.createElement("strong");return e.parentElement.replaceChild(t,e),void t.appendChild(e)}const r=Array.from(t.childNodes).find(t=>3===t.nodeType&&t.textContent?.trim().length>0);if(r&&r.parentElement){const t=r.textContent.trim(),e=document.createElement("strong");e.textContent=t,r.textContent=r.textContent.replace(t,""),r.parentElement.insertBefore(e,r.nextSibling)}})}function L(){const t=document.querySelector("footer, .footer, .contentinfo");if(!t)return;null!==t.nextSibling&&document.body.appendChild(t);const e=['a[href="#top"]',"a.to-top",".back-to-top",".scroll-top","a.well.well-sm"];let r=null;for(const t of e)if(r=document.querySelector(t),r)break;if(r){r.classList.add("kraland-back-to-top"),r.getAttribute("aria-label")||r.setAttribute("aria-label","Remonter en haut");const e=t.querySelector(".container.white");e?e.appendChild(r):r.parentElement!==t&&t.appendChild(r)}document.body.style.marginBottom||(document.body.style.marginBottom="60px")}function q(){const e=document.querySelector("footer, .footer, .contentinfo");if(!e)return;let r=e.querySelector(".kraland-css-version");r||(r=document.createElement("div"),r.className="kraland-css-version",r.style.cssText="text-align: center; padding: 10px; font-size: 12px; color: #666;",(e.querySelector(".container.white")||e).appendChild(r));const o=t;r.innerHTML=`<span>CSS : version courante <strong>${o}</strong>, dernière version <span id="latest-version">chargement...</span></span>`,fetch("https://raw.githubusercontent.com/arnaudroubinet/kraland-css/refs/heads/main/version.json").then(t=>{if(!t.ok)throw new Error("Fetch failed");return t.json()}).then(t=>{const e=document.getElementById("latest-version");e&&(e.innerHTML=`<strong>${t.version}</strong>`,t.version!==o&&(e.innerHTML+=' <span style="color: #d9534f;">⚠️ (mise à jour disponible)</span>'))}).catch(t=>{console.error("[Version Info] Erreur lors de la récupération de la version:",t);const e=document.getElementById("latest-version");e&&(e.textContent="erreur")})}function T(){if(window.location.pathname.includes("/kramail"))return;const t=document.getElementById("col-t"),e=document.getElementById("col-left");if(!t||!e)return;t.querySelectorAll('a[href*="kramail"]').forEach(e=>{const r=e.closest("div,section,li,article");r&&r!==t&&"col-t"!==r.id?r.remove():e.remove()});const r=[".ds_users",".ds_characters",".ds_online"].map(t=>`a${t}`);let o=[];if(r.forEach(e=>o.push(...t.querySelectorAll(e))),o.length<3&&["Membres actifs","Personnages actifs","Personnes en ligne"].forEach(e=>{const r=Array.from(t.querySelectorAll("a, li, div, p")).find(t=>t.textContent?.includes(e));r&&!o.includes(r)&&o.push(r)}),o=o.filter(t=>t&&!e.contains(t)),!o.length)return;let a=e.querySelector(".kraland-metrics");a||(a=document.createElement("div"),a.className="kraland-metrics list-group",e.appendChild(a)),o.forEach(t=>a.appendChild(t))}function N(){if(!c())return;const t=document.getElementById("col-left"),e=document.getElementById("col-right");if(!t||!e)return;const r=t.parentElement;if(!r||!r.classList.contains("row"))return;let o=document.getElementById("col-leftest");o||(o=document.createElement("div"),o.id="col-leftest",o.className="col-md-1",r.insertBefore(o,t)),e.classList.contains("col-md-9")&&(e.classList.remove("col-md-9"),e.classList.add("col-md-8"))}function M(){if(!c())return;const t=document.querySelector(".btn-group-xs.center"),e=document.getElementById("col-leftest");if(!t||!e||e.contains(t))return;let r=document.getElementById("col-leftest-stats");r||(r=document.createElement("div"),r.id="col-leftest-stats",r.className="panel panel-body",e.appendChild(r)),r.contains(t)||r.appendChild(t)}function P(){const t=document.getElementById("col-leftest-stats"),e=document.getElementById("skills-panel");if(t&&!t.classList.contains("grid-transformed")){const e=t.querySelector(".btn-group-xs");if(e){const r=Array.from(e.querySelectorAll("a.btn"));if(r.length>0){t.innerHTML="";const e=document.createElement("div");e.className="row",r.forEach(t=>{const r=document.createElement("div");r.className="col-md-6",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.marginBottom="8px",r.appendChild(t),e.appendChild(r)}),t.appendChild(e),t.classList.add("grid-transformed")}}}if(e&&!e.classList.contains("grid-transformed")){const t=Array.from(e.querySelectorAll("a.list-group-item"));if(t.length>0){e.innerHTML="";const r=document.createElement("div");r.className="row",t.forEach(t=>{const e=document.createElement("div");e.className="col-md-6",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.marginBottom="8px",e.appendChild(t),r.appendChild(e)}),e.appendChild(r),e.classList.add("grid-transformed")}}}function I(){const t=document.getElementById("col-left"),e=document.getElementById("col-leftest");if(!t||!e)return;const r=t.querySelector(".panel.panel-default");if(!r)return;const o=r.querySelector(".panel-body");o&&!o.id&&(o.id="skills-panel",e.appendChild(o),r.remove())}function z(){const t=document.getElementById("col-left");if(!t)return;const e=t.querySelector(".panel.panel-body");e&&!e.id&&(e.id="player-main-panel");const r=t.querySelector(".list-group");r&&!r.id&&(r.id="player-header-section");const o=t.querySelector("div.t.row");o&&!o.id&&(o.id="player-vitals-section");const a=Array.from(t.querySelectorAll("div.t"));if(a.length>0){const t=a[a.length-1];!t.id&&t.querySelector("a.btn-primary")&&(t.id="player-actions-section")}}function _(){const t=document.getElementById("skills-panel");t&&!t.dataset.iconsTransformed&&(t.querySelectorAll(".list-group-item").forEach(t=>{const e=t.querySelector(".list-group-item-heading"),r=e?.querySelector(".mini")?.textContent||"",a=t.querySelector(".mention")?.textContent||"0",n=o.SKILL_ICONS[r];if(!n)return;const i=`http://img7.kraland.org/2/mat/94/${n}.gif`,l=t.className;t.className=l+" btn btn-default mini",t.innerHTML="";const d=function(t,e,r){const o=document.createElement("div");Object.assign(o.style,{position:"relative",display:"inline-block",width:"32px",height:"32px"});const a=document.createElement("img");return a.src=t,a.alt=e,a.title=e,Object.assign(a.style,{width:"32px",height:"32px",display:"block"}),o.appendChild(a),o.appendChild(function(t){const e=document.createElement("span");return e.className="badge",e.textContent=t,Object.assign(e.style,{position:"absolute",top:"25px",right:"-8px",backgroundColor:"#d9534f",color:"#fff",borderRadius:"50%",width:"19px",height:"19px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",border:"2px solid #fff"}),e}(r)),o}(i,r,a);Object.assign(t.style,{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",width:"40px",height:"40px",minWidth:"40px",minHeight:"40px"}),t.appendChild(d)}),t.dataset.iconsTransformed="1")}function B(){const t=document.getElementById("col-leftest-stats");t&&!t.dataset.badgesTransformed&&(t.querySelectorAll(".col-md-6 > a.btn").forEach(t=>{const e=t.textContent.trim(),r=e.match(/^([A-Z]+)/),a=r?r[1]:e,n=e.match(/(\d+)$/),i=n?n[1]:"0";for(;t.firstChild;)t.removeChild(t.firstChild);const d=t.className;t.className=d+" list-group-item ds_game",Object.assign(t.style,{padding:"8px",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",minWidth:"40px",minHeight:"40px"}),t.title=a;const s=l(),c=document.createElement("div");if(Object.assign(c.style,{position:"relative",display:"inline-block",width:"32px",height:"32px"}),"text"===s){const t=document.createElement("span");t.textContent=a.substring(0,3).toUpperCase(),Object.assign(t.style,{fontWeight:"bold",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",width:"32px",height:"32px"}),c.appendChild(t)}else{const t=o.STAT_ICONS[a];if(t){const e=`http://img7.kraland.org/2/mat/94/${t}.gif`,r=document.createElement("img");r.src=e,r.alt=a,r.title=a,Object.assign(r.style,{display:"block",width:"32px",height:"32px"}),c.appendChild(r)}else{const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("width","32"),t.setAttribute("height","32"),t.setAttribute("viewBox","0 0 32 32"),t.style.display="block";const e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("width","32"),e.setAttribute("height","32"),e.setAttribute("fill","#f0f0f0"),e.setAttribute("stroke","#ccc"),t.appendChild(e);const r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("x","16"),r.setAttribute("y","20"),r.setAttribute("text-anchor","middle"),r.setAttribute("font-size","14"),r.setAttribute("font-weight","bold"),r.setAttribute("fill","#333"),r.textContent=a.substring(0,2).toUpperCase(),t.appendChild(r),c.appendChild(t)}}c.appendChild(function(t){const e=document.createElement("span");return e.className="badge",e.textContent=t,Object.assign(e.style,{position:"absolute",top:"25px",right:"-8px",backgroundColor:"#007bff",color:"#fff",borderRadius:"50%",width:"19px",height:"19px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",border:"2px solid #fff"}),e}(i)),t.appendChild(c)}),t.dataset.badgesTransformed="1")}function j(){document.querySelectorAll(['[id^="ajax-"] form#msg','[id^="ajax-"] textarea',".col-sm-10 form#msg",".col-sm-10 textarea#message",'form[name="post_msg"]',"textarea#message"].join(",")).forEach(t=>{const e="form"===t.tagName?.toLowerCase()?t:t.closest("form")||t.parentElement;e&&!e.classList.contains("editeur-text")&&e.classList.add("editeur-text")})}function F(){const t=0===location?.pathname?.indexOf("/communaute/membres");document.documentElement.classList.toggle("kr-page-members",t)}function D(){const t=document.getElementById("player-main-panel");t&&Array.from(t.children).filter(t=>"div"===t.tagName?.toLowerCase()).filter(t=>!t.classList.contains("kr-quick-access-buttons")).forEach(t=>{t.classList.contains("row")||t.classList.add("row")})}function H(){const t=document.getElementById("player-main-panel");if(!t)return;if(t.querySelector(".kr-quick-access-buttons"))return;const e=document.createElement("div");e.className="kr-quick-access-buttons",e.style.marginTop="10px";const r=document.createElement("div");r.className="row",[{label:"Agir",url:"/jouer/plateau",icon:"fa-map"},{label:"Matériel",url:"/jouer/materiel",icon:"fa-box"},{label:"Personnage",url:"/jouer/perso",icon:"fa-user"},{label:"Bâtiments",url:"/jouer/bat",icon:"fa-building"},{label:"Employés",url:"/jouer/pnj",icon:"fa-users"}].forEach(t=>{const e=document.createElement("div");e.className="col-xs-6 col-sm-6";const o=document.createElement("a");o.href=t.url,o.className="btn btn-default btn-block mini";const a=document.createElement("i");a.className=`fa ${t.icon}`,o.appendChild(a),o.appendChild(document.createTextNode(" "+t.label)),e.appendChild(o),r.appendChild(e)}),e.appendChild(r),t.appendChild(e)}function O(){if(document.getElementById("kr-toggle-css-btn"))return;const t=Array.from(document.querySelectorAll("a")).find(t=>t.getAttribute("onclick")?.includes("openMap"));if(!t)return;const e=t.closest("li");if(!e?.parentElement)return;const r=document.createElement("li"),o=document.createElement("a");o.href="",o.id="kr-toggle-css-btn",o.innerHTML='<i class="fa fa-palette"></i>',o.title=n()?"Désactiver la surcharge CSS":"Activer la surcharge CSS",o.addEventListener("click",t=>(t.preventDefault(),n()?g("disable"):g(i()),!1)),r.appendChild(o),e.parentElement&&e.parentElement.insertBefore(r,e)}function R(){if(location?.href?.includes("/profil/interface")&&!t()){let e=0;const r=setInterval(()=>{e++,(t()||e>25)&&clearInterval(r)},200)}function t(){const t=Array.from(document.querySelectorAll("h4, h3, h2")).find(t=>t.textContent?.trim().toLowerCase().includes("thème de base"));if(!t)return!1;if(document.getElementById("kr-tamper-theme"))return!0;const e=[{value:"disable",flag:"f0",label:"Désactiver la surcharge CSS"},{value:"kraland",flag:"f1",label:"République de Kraland"},{value:"empire-brun",flag:"f2",label:"Empire Brun"},{value:"empire-brun-dark",flag:"f2",label:"Empire Brun (Dark Mode)"},{value:"paladium",flag:"f3",label:"Paladium Corporation"},{value:"paladium-dark",flag:"f3",label:"Paladium Corporation (Dark Mode)"},{value:"theocratie-seelienne",flag:"f4",label:"Théocratie Seelienne"},{value:"theocratie-seelienne-dark",flag:"f4",label:"Théocratie Seelienne (Dark Mode)"},{value:"paradigme-vert",flag:"f5",label:"Paradigme Vert"},{value:"paradigme-vert-dark",flag:"f5",label:"Paradigme Vert (Dark Mode)"},{value:"khanat-elmerien",flag:"f6",label:"Khanat Elmérien"},{value:"khanat-elmerien-dark",flag:"f6",label:"Khanat Elmérien (Dark Mode)"},{value:"confederation-libre",flag:"f7",label:"Confédération Libre"},{value:"confederation-libre-dark",flag:"f7",label:"Confédération Libre (Dark Mode)"},{value:"royaume-ruthvenie",flag:"f8",label:"Royaume de Ruthvénie"},{value:"royaume-ruthvenie-dark",flag:"f8",label:"Royaume de Ruthvénie (Dark Mode)"}].map(t=>`\n        <div class="radio">\n          <span class="lefticon"><img src="http://img7.kraland.org/2/world/${t.flag}.png" width="15" height="10"></span>\n          <label><input type="radio" name="kr-theme" value="${t.value}"> ${t.label}</label>\n        </div>\n      `).join(""),r=document.createElement("div");r.id="kr-tamper-theme",r.className="well kr-tamper-theme",r.innerHTML=`\n        <h4>Thème Tampermonkey (Activez le thème de base officiel pour éviter les conflits)</h4>\n        <form id="kr-tamper-theme-form" class="form-horizontal">\n          <div class="form-group">\n            <label class="col-sm-3 control-label">Choix du thème</label>\n            <div class="col-sm-9">${e}</div>\n          </div>\n          <div class="form-group">\n            <label class="col-sm-3 control-label">Affichage des caractéristiques</label>\n            <div class="col-sm-9">\n        <div class="radio">\n          <label><input type="radio" name="kr-stats-display" value="icon"> Icônes</label>\n        </div>\n        <div class="radio">\n          <label><input type="radio" name="kr-stats-display" value="text"> Texte</label>\n        </div>\n      </div>\n          </div>\n          <div class="form-group">\n            <label class="col-sm-3 control-label">Options du footer</label>\n            <div class="col-sm-9">\n        <div class="checkbox">\n          <label><input type="checkbox" name="kr-hide-quote" id="kr-hide-quote"> Masquer la citation du footer</label>\n        </div>\n      </div>\n          </div>\n          <div class="form-group">\n            <label class="col-sm-3 control-label">Carte</label>\n            <div class="col-sm-9">\n              <div class="checkbox">\n                <label><input type="checkbox" name="kr-medieval-map" id="kr-medieval-map-checkbox"> Carte médiévale — remplace les tuiles de la carte</label>\n                <p class="help-block" style="margin-top:6px">Merci <a href="http://www.kraland.org/communaute/membres/sylke-1-3335" target="_blank" rel="noopener noreferrer">Sylke</a></p>\n              </div>\n            </div>\n          </div>\n        </form>\n      `,t.parentElement&&t.parentElement.insertBefore(r,t);const a=r.querySelector("#kr-tamper-theme-form");return a.addEventListener("change",t=>{if("kr-theme"===t.target.name){const t=a.querySelector('input[name="kr-theme"]:checked');if(!t)return;const e=t.value,o=document.createElement("div");o.className="alert alert-success",o.textContent="disable"===e?"Désactivation du thème...":"Application du thème: "+e,r.appendChild(o),setTimeout(()=>g(e),300)}if("kr-stats-display"===t.target.name){const t=a.querySelector('input[name="kr-stats-display"]:checked');if(!t)return;const e=t.value;localStorage.setItem(o.STATS_DISPLAY_KEY,e);const n=document.createElement("div");n.className="alert alert-success",n.textContent="icon"===e?"Affichage en icônes activé. Rechargez la page pour voir les changements.":"Affichage en texte activé. Rechargez la page pour voir les changements.",r.appendChild(n),setTimeout(()=>{n.remove()},5e3)}if("kr-hide-quote"===t.target.name){const e=t.target.checked;localStorage.setItem("kr-hide-footer-quote",e.toString()),e?document.documentElement.classList.add("kr-hide-footer-quote"):document.documentElement.classList.remove("kr-hide-footer-quote");const o=document.createElement("div");o.className="alert alert-success",o.textContent=e?"Citation du footer masquée.":"Citation du footer affichée.",r.appendChild(o),setTimeout(()=>{o.remove()},3e3)}if("kr-medieval-map"===t.target.name){const e=t.target.checked;localStorage.setItem(o.MEDIEVAL_MAP_KEY,e.toString());const a=document.createElement("div");a.className="alert alert-success",a.textContent=e?"Carte médiévale activée. Application...":"Carte médiévale désactivée.",r.appendChild(a),s(),setTimeout(()=>a.remove(),3e3)}}),function(){if(n()){const t=i(),e=a.querySelector(`input[value="${t}"]`);e&&(e.checked=!0)}else{const t=a.querySelector('input[value="disable"]');t&&(t.checked=!0)}const t=l(),e=a.querySelector(`input[name="kr-stats-display"][value="${t}"]`);e&&(e.checked=!0);const r="true"===localStorage.getItem("kr-hide-footer-quote"),d=a.querySelector("#kr-hide-quote");d&&(d.checked=r);const s="true"===localStorage.getItem(o.MEDIEVAL_MAP_KEY),c=a.querySelector("#kr-medieval-map-checkbox");c&&(c.checked=s)}(),!0}}function K(){const t=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{1===t.nodeType&&t.classList?.contains("bootbox")&&setTimeout(()=>{!function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;(function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;if(t.dataset.structureTransformed)return;console.log("[Order Modal] Optimisation structure mobile");const e=t.querySelector(".bootbox-body, .modal-body");if(!e)return;const r=e.querySelector(".row"),o=e.querySelector("h3");r&&o&&(r.classList.add("kraland-modal-header"),o.classList.add("kraland-character-title"),console.log("[Order Modal] Header marqué"));const a=e.querySelector(".panel.with-nav-tabs");if(a){const t=a.querySelector(".panel-heading");t&&(t.classList.add("kraland-actions-zone"),console.log("[Order Modal] Zone actions identifiée"));const e=a.querySelector(".panel-body.panel-order");e&&(e.classList.add("kraland-form-zone"),console.log("[Order Modal] Zone formulaire identifiée"));const r=a.querySelector(".panel-footer");r&&(r.classList.add("kraland-action-footer"),console.log("[Order Modal] Footer action identifié"))}const n=t.querySelector(".modal-footer");n&&(n.classList.add("kraland-modal-footer"),console.log("[Order Modal] Footer modal identifié"));const i=e.querySelector(".panel-info");i&&(i.querySelectorAll(".row").forEach(t=>{t.style.marginLeft="",t.style.marginRight=""}),i.querySelectorAll('[class*="col-"]').forEach(t=>{t.style.paddingLeft="",t.style.paddingRight=""}),console.log("[Order Modal] Styles inline nettoyés du panel-info")),t.dataset.structureTransformed="true",console.log("[Order Modal] Structure optimisée pour mobile")})(t),function(t){if(!t)return;const e=new MutationObserver(t=>{t.forEach(t=>{if("attributes"===t.type&&"class"===t.attributeName){const e=t.target;if(e.classList.contains("dropdown")&&e.classList.contains("open")){const t=e.querySelector(".dropdown-menu");t&&(t.style.setProperty("position","absolute","important"),t.style.setProperty("bottom","100%","important"),t.style.setProperty("top","auto","important"),t.style.setProperty("left","0","important"),t.style.setProperty("margin-bottom","4px","important"),t.style.setProperty("z-index","10000","important"),console.log("[Order Modal] Dropdown position forcée à absolute"))}}})}),r=t.querySelector(".btn-toolbar");if(r){const t=r.querySelectorAll(".dropdown");t.forEach(t=>{e.observe(t,{attributes:!0,attributeFilter:["class"]})}),console.log(`[Order Modal] Observateur dropdown installé sur ${t.length} dropdowns`)}}(t),Y(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector(".alert");if(!e)return;const r=document.createElement("button");r.type="button",r.className="kr-alert-toggle",r.innerHTML='<i class="fas fa-question-circle"></i> Aide',r.setAttribute("aria-expanded","false"),r.setAttribute("aria-label","Afficher/masquer l'aide");const o=document.createElement("div");for(o.className="kr-alert-content",o.style.display="none";e.firstChild;)o.appendChild(e.firstChild);e.appendChild(r),e.appendChild(o),e.classList.add("kr-alert-collapsible"),r.addEventListener("click",function(){const t="none"!==o.style.display;o.style.display=t?"none":"block",r.setAttribute("aria-expanded",!t),r.innerHTML=t?'<i class="fas fa-question-circle"></i> Aide':'<i class="fas fa-times-circle"></i> Masquer l\'aide'}),console.log("[Order Modal] Alerte rendue repliable")}(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;t.querySelectorAll(".nav.nav-tabs li a").forEach(e=>{e.classList.add("kr-touch-feedback"),e.addEventListener("click",function(){t.querySelectorAll(".nav.nav-tabs li").forEach(t=>t.classList.remove("active")),this.parentElement.classList.add("active")})}),console.log("[Order Modal] Feedback tactile ajouté aux nav-tabs")}(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector("textarea#message");e&&(e.rows=8,e.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}),console.log("[Order Modal] Textarea agrandi (8 rows + auto-resize)"))}(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector(".kraland-action-footer p");if(!e)return;const r=e.textContent,o=r.match(/Coût:\s*([^|]+)/),a=r.match(/Durée:\s*([^|]+)/),n=r.match(/Potentiel:\s*(.+)$/);if(!o&&!a&&!n)return;const i=`\n      <div class="kr-action-badges">\n        ${o?`<span class="kr-badge kr-badge-cost"><i class="fas fa-coins"></i> ${o[1].trim()}</span>`:""}\n        ${a?`<span class="kr-badge kr-badge-duration"><i class="far fa-clock"></i> ${a[1].trim()}</span>`:""}\n        ${n?`<span class="kr-badge kr-badge-potential"><i class="fas fa-dice-d20"></i> ${n[1].trim()}</span>`:""}\n      </div>\n    `;e.innerHTML=i,console.log("[Order Modal] Footer formaté en badges")}(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector(".kraland-modal-footer");if(!e)return;const r=e.querySelector(".btn-primary"),o=e.querySelector(".btn-default");r&&r.classList.add("kr-btn-primary-enhanced"),o&&o.classList.add("kr-btn-secondary-subtle"),console.log("[Order Modal] Boutons OK/Cancel améliorés")}(t),function(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector(".kraland-modal-header select");if(!e)return;const r=Array.from(e.options);if(0===r.length)return;const o=[],a=[];if(r.forEach(t=>{const e=t.textContent;e.includes("PNJ")||e.includes("[")||e.match(/\d+ /)||e.includes("Garde")||e.includes("Esclave")?a.push(t):o.push(t)}),0!==o.length&&0!==a.length){if(e.innerHTML="",o.length>0){const t=document.createElement("optgroup");t.label="Personnages Joueurs",o.forEach(e=>t.appendChild(e)),e.appendChild(t)}if(a.length>0){const t=document.createElement("optgroup");t.label="Personnages Non-Joueurs",a.forEach(e=>t.appendChild(e)),e.appendChild(t)}console.log(`[Order Modal] Select groupé (${o.length} PJ, ${a.length} PNJ)`)}}(t),V(t);const e=t.querySelector(".bootbox-body, .modal-body");e&&(new MutationObserver(()=>{console.log("[Order Modal] Contenu Ajax détecté - réapplication du grid"),V(t),Y(t)}).observe(e,{childList:!0,subtree:!0}),console.log("[Order Modal] Observer Ajax installé sur modal body")),function(t){if(!t)return;t.querySelectorAll(".panel-info, .panel-primary, .panel-default").forEach(t=>{t.querySelectorAll(".panel-heading .row, .panel-body .row, .panel-actions .row, .panel-footer .row").forEach(t=>{const e=t.querySelectorAll('[class*="col-"]');if(e.length>0){const r=[];e.forEach(t=>{const e=t.textContent.trim(),o=t.innerHTML.trim();t.children.length>0?r.push(o):e&&r.push(e)});const o=document.createElement("div");o.className="col-xs-12 merged-columns",o.innerHTML=r.join(" "),e.forEach(t=>t.remove()),t.appendChild(o)}})})}(t);const r=t.querySelector('select[onchange*="perso"]');r&&function(t,e){const r=Array.from(e.options);if(r.length<=1)return;const o=e.selectedIndex,a=document.createElement("div");a.className="kr-char-selector";const n=document.createElement("button");n.type="button",n.className="kr-char-nav-btn",n.innerHTML="‹",n.disabled=0===o,n.setAttribute("aria-label","Personnage précédent");const i=document.createElement("div");i.className="kr-selector-current";const l=document.createElement("img");l.src=t.querySelector(".modal-header img")?.src||"",l.alt="Avatar";const d=document.createElement("span");d.className="kr-selector-current-name",d.textContent=r[o].text;const s=document.createElement("span");s.className="kr-selector-current-count",s.textContent=`${o+1}/${r.length}`,i.appendChild(l),i.appendChild(d),i.appendChild(s);const c=document.createElement("button");c.type="button",c.className="kr-char-nav-btn",c.innerHTML="›",c.disabled=o===r.length-1,c.setAttribute("aria-label","Personnage suivant"),a.appendChild(n),a.appendChild(i),a.appendChild(c),e.parentNode.insertBefore(a,e.nextSibling),n.addEventListener("click",()=>{e.selectedIndex>0&&(e.selectedIndex--,e.dispatchEvent(new Event("change")))}),c.addEventListener("click",()=>{e.selectedIndex<r.length-1&&(e.selectedIndex++,e.dispatchEvent(new Event("change")))})}(t,r),function(t){const e=t.querySelector(".modal-header");if(!e)return;const r=e.querySelector("div");if(!r)return;const o=Array.from(r.childNodes).filter(t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim());if(0===o.length)return;const a=document.createElement("div");if(a.className="kr-char-description collapsed",o.slice(1).forEach(t=>{a.appendChild(t.cloneNode(!0)),t.remove()}),a.textContent.trim()){r.appendChild(a);const t=document.createElement("button");t.type="button",t.className="kr-char-expand-btn",t.innerHTML="▼",t.setAttribute("aria-label","Afficher/masquer description"),t.setAttribute("aria-expanded","false"),e.appendChild(t),t.addEventListener("click",()=>{a.classList.contains("collapsed")?(a.classList.remove("collapsed"),a.classList.add("expanded"),t.classList.add("expanded"),t.setAttribute("aria-expanded","true")):(a.classList.remove("expanded"),a.classList.add("collapsed"),t.classList.remove("expanded"),t.setAttribute("aria-expanded","false"))})}}(t),function(t){const e=t.querySelector(".nav-tabs");if(!e)return;const r=Array.from(e.querySelectorAll("li"));if(0===r.length)return;const o=document.createElement("div");o.className="kr-tabs-indicator",r.forEach((t,e)=>{const r=document.createElement("span");r.className="kr-tab-dot",t.classList.contains("active")&&r.classList.add("active"),o.appendChild(r)}),e.parentNode.insertBefore(o,e.nextSibling);const a=new MutationObserver(()=>{const t=r.findIndex(t=>t.classList.contains("active"));o.querySelectorAll(".kr-tab-dot").forEach((e,r)=>{e.classList.toggle("active",r===t)})});r.forEach(t=>{a.observe(t,{attributes:!0,attributeFilter:["class"]})});let n=0,i=0;e.addEventListener("touchstart",t=>{n=t.changedTouches[0].screenX},{passive:!0}),e.addEventListener("touchend",t=>{i=t.changedTouches[0].screenX,function(){const t=n-i;if(Math.abs(t)<50)return;const e=r.findIndex(t=>t.classList.contains("active"));t>0&&e<r.length-1?r[e+1].querySelector("a")?.click():t<0&&e>0&&r[e-1].querySelector("a")?.click()}()},{passive:!0});const l=()=>{const t=e.closest(".bootbox.modal"),r=t?.querySelectorAll(".nav-tabs")||[e];let o=null;for(const t of r)if(o=t.querySelector("li.active"),o){o.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"});break}};setTimeout(l,100);const d=e.closest(".bootbox.modal");(d?.querySelectorAll(".nav-tabs")||[e]).forEach(t=>{Array.from(t.querySelectorAll("li")).forEach(t=>{t.querySelector("a")?.addEventListener("click",()=>{setTimeout(l,100)})})})}(t),function(t){t.querySelectorAll("textarea").forEach(t=>{const e=t.getAttribute("maxlength");if(!e)return;const r=document.createElement("div");r.className="kr-char-counter";const o=()=>{const o=e-t.value.length;r.textContent=`${o} caractères restants`,r.classList.remove("warning","error"),o<=0?r.classList.add("error"):o<=20&&r.classList.add("warning")};t.parentNode.insertBefore(r,t.nextSibling),t.addEventListener("input",o),o()})}(t),function(t){t.querySelectorAll(".kr-char-nav-btn, .kr-char-expand-btn, .nav-tabs a, .btn, .radio label").forEach(t=>{t.classList.add("kr-touch-feedback"),t.addEventListener("touchstart",()=>{t.classList.add("active"),navigator.vibrate&&navigator.vibrate(10)},{passive:!0}),t.addEventListener("touchend",()=>{setTimeout(()=>{t.classList.remove("active")},600)},{passive:!0}),t.addEventListener("touchcancel",()=>{t.classList.remove("active")},{passive:!0})})}(t)}(t)},150)})})});document.body&&t.observe(document.body,{childList:!0,subtree:!1})}function V(t){if(!t)return;if(!t.classList.contains("bootbox-confirm"))return;const e=t.querySelector(".panel-heading");e&&e.style.setProperty("display","block","important");const r=t.querySelectorAll(".panel-heading ul.nav-tabs");0!==r.length&&(console.log("[Order Modal] Forçage du layout grid pour",r.length,"nav-tabs"),r.forEach((t,e)=>{t.style.setProperty("display","grid","important"),t.style.setProperty("grid-template-columns","repeat(2, 1fr)","important"),t.style.setProperty("gap","12px","important"),t.style.setProperty("padding-left","0","important"),t.style.setProperty("justify-items","start","important"),t.style.setProperty("align-items","stretch","important"),t.style.setProperty("margin-bottom","12px","important"),t.style.setProperty("border-bottom","none","important"),t.style.setProperty("border-top","none","important"),t.style.setProperty("padding-top","0","important");let r="grid-pseudo-fix-"+e,o=document.getElementById(r);o||(o=document.createElement("style"),o.id=r,document.head.appendChild(o)),t.id||(t.id="order-modal-nav-"+e),o.textContent=`\n        #${t.id}::before,\n        #${t.id}::after {\n          display: none !important;\n          content: none !important;\n        }\n      `;const a=t.querySelectorAll("li");a.forEach(t=>{t.style.setProperty("margin","0","important"),t.style.setProperty("padding","0","important"),t.style.setProperty("float","none","important"),t.style.setProperty("display","block","important"),t.style.setProperty("position","static","important"),t.style.setProperty("width","100%","important"),t.style.setProperty("grid-column","auto","important"),t.style.setProperty("grid-row","auto","important"),t.style.setProperty("justify-self","stretch","important"),t.style.setProperty("align-self","stretch","important");const e=t.querySelector("a");e&&(e.style.setProperty("display","block","important"),e.style.setProperty("width","100%","important"),e.style.setProperty("min-height","44px","important"),e.style.setProperty("padding","12px 16px","important"),e.style.setProperty("text-align","center","important"),e.style.setProperty("border-radius","8px","important"),e.style.setProperty("margin","0","important"),e.style.setProperty("box-sizing","border-box","important"))}),console.log(`[Order Modal] Grid appliqué sur nav-tabs #${e+1} (${a.length} items)`)}),setTimeout(()=>{r.forEach(t=>{t.style.setProperty("display","grid","important")})},100))}function Y(t){if(!t)return;if(!document.body.classList.contains("mobile-mode"))return;const e=t.querySelector(".btn-toolbar");e&&(Array.from(e.childNodes).forEach(t=>{t.nodeType===Node.TEXT_NODE&&/^\s*$/.test(t.textContent)&&e.removeChild(t)}),e.style.setProperty("display","grid","important"),e.style.setProperty("grid-template-columns","repeat(6, 1fr)","important"),e.style.setProperty("gap","4px","important"),e.querySelectorAll(".btn-group, .dropdown, span.dropdown").forEach(t=>{t.style.setProperty("display","contents","important")}),e.querySelectorAll(".btn, span.dropdown > a > .btn, .dropdown > a > .btn, span.dropdown button, .dropdown button").forEach(t=>{t.style.setProperty("width","100%","important"),t.style.setProperty("min-width","0","important"),t.style.setProperty("max-width","none","important")}),console.log("[Order Modal] Toolbar grid forcé et whitespace nettoyé"))}function G(){const t=document.querySelector(".c100");if(!t)return;const e=t.querySelector("span");if(!e)return;const r=e.textContent.trim().match(/^(\d{1,2}):(\d{2})$/);if(!r)return;const o=parseInt(r[1],10),a=parseInt(r[2],10);let n;if(n=o>=24?"#32CD32":o>=18?"#90EE90":o>=12?"#FFD700":o>=6?"#FF8C00":"#8B0000",t.style.setProperty("--clock-color",n),o>=24){t.setAttribute("data-second-lap","true");const e=o-24,r=Math.floor((60*e+a)/1440*100);t.className=t.className.replace(/\bp\d{1,3}\b/g,""),t.className+=" p"+r}else t.removeAttribute("data-second-lap")}!function(){try{if(!n())return;const t=document.createElement("style");t.id=o.STYLE_ID,t.textContent=o.BUNDLED_CSS,(document.head||document.documentElement).appendChild(t);const e=i();document.documentElement.classList.add("kr-theme-enabled","kr-theme-variant-"+e),"high-contrast"===e&&document.documentElement.classList.add("kr-theme-high-contrast")}catch(t){m(),console.error("CSS injection failed",t)}}(),n()&&setTimeout(m,3e3),a(()=>s()),function(){const t="kr-forums-rp",e=["taverne","marché","monde","communauté","débats","staff"];window.updateForumRPMenu=function(){const e=document.querySelector('[data-forums-added="rp"] .dropdown-menu');if(!e)return;const r=function(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Forums RP] Erreur lecture localStorage:",t),[]}}();console.log(`[Forums RP] Mise à jour du menu avec ${r.length} forums`);const o=Array.from(e.children).slice(0,4);if(e.innerHTML="",o.forEach(t=>e.appendChild(t)),r.length>0)r.forEach(t=>{const r=document.createElement("li"),o=document.createElement("a");o.href=t.url,o.textContent=t.name,r.appendChild(o),e.appendChild(r)});else{const t=document.createElement("li"),r=document.createElement("a");r.href="forum/rp",r.textContent="Autre",t.appendChild(r),e.appendChild(t)}},r.register("ForumsRP:Extract",function(){if("/forum/rp"!==window.location.pathname)return;console.log("[Forums RP] Extraction des forums depuis la page...");const r=[];document.querySelectorAll("table.table tbody tr").forEach(t=>{const o=t.querySelector("td:first-child a");if(!o)return;const a=o.textContent.trim(),n=o.getAttribute("href");!e.some(t=>a.toLowerCase().includes(t))&&n?(r.push({name:a,url:n}),console.log(`[Forums RP] Ajouté: ${a} (${n})`)):console.log(`[Forums RP] Exclu: ${a}`)});try{localStorage.setItem(t,JSON.stringify(r)),console.log(`[Forums RP] ${r.length} forums stockés dans localStorage`)}catch(t){console.error("[Forums RP] Erreur sauvegarde localStorage:",t)}},5)}(),function(){const t="kr-forums-hrp";window.updateForumHRPMenu=function(){const e=document.querySelector('[data-forums-added="hrp"] .dropdown-menu');if(!e)return;const r=function(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Forums HRP] Erreur lecture localStorage:",t),[]}}();if(console.log(`[Forums HRP] Mise à jour du menu avec ${r.length} forums`),e.innerHTML="",r.length>0)r.forEach(t=>{const r=document.createElement("li"),o=document.createElement("a");o.href=t.url,o.textContent=t.name,r.appendChild(o),e.appendChild(r)});else{const t=document.createElement("li"),r=document.createElement("a");r.href="forum/hrp",r.textContent="Voir tous les forums",t.appendChild(r),e.appendChild(t)}},r.register("ForumsHRP:Extract",function(){if("/forum/hrp"!==window.location.pathname)return;console.log("[Forums HRP] Extraction des forums depuis la page...");const e=[];document.querySelectorAll("table.table tbody tr").forEach(t=>{const r=t.querySelector("td:first-child a");if(!r)return;const o=r.textContent.trim(),a=r.getAttribute("href");a&&(e.push({name:o,url:a}),console.log(`[Forums HRP] Ajouté: ${o} (${a})`))});try{localStorage.setItem(t,JSON.stringify(e)),console.log(`[Forums HRP] ${e.length} forums stockés dans localStorage`)}catch(t){console.error("[Forums HRP] Erreur sauvegarde localStorage:",t)}},5)}(),function(){const t="kr-forums-communaute",e=["taverne","marché","monde","communauté","débats","staff"];window.updateForumCommunauteMenu=function(){const e=document.querySelector('[data-forums-added="forum-communaute"] .dropdown-menu');if(!e)return;const r=function(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Forums Communauté] Erreur lecture localStorage:",t),[]}}();if(console.log(`[Forums Communauté] Mise à jour du menu avec ${r.length} forums`),e.innerHTML="",r.length>0)r.forEach(t=>{const r=document.createElement("li"),o=document.createElement("a");o.href=t.url,o.textContent=t.name,r.appendChild(o),e.appendChild(r)});else{const t=document.createElement("li"),r=document.createElement("a");r.href="forum/communaute",r.textContent="Voir tous les forums",t.appendChild(r),e.appendChild(t)}},r.register("ForumsCommunaute:Extract",function(){if("/forum/communaute"!==window.location.pathname)return;console.log("[Forums Communauté] Extraction des forums depuis la page...");const r=[];document.querySelectorAll("table.table tbody tr").forEach(t=>{const o=t.querySelector("td:first-child a");if(!o)return;const a=o.textContent.trim(),n=o.getAttribute("href");!e.some(t=>a.toLowerCase().includes(t))&&n&&(r.push({name:a,url:n}),console.log(`[Forums Communauté] Ajouté: ${a} (${n})`))});try{localStorage.setItem(t,JSON.stringify(r)),console.log(`[Forums Communauté] ${r.length} forums stockés dans localStorage`)}catch(t){console.error("[Forums Communauté] Erreur sauvegarde localStorage:",t)}},5)}(),function(){const t="kr-forums-debats",e=["taverne","marché","monde","communauté","débats","staff"];window.updateForumDebatsMenu=function(){const e=document.querySelector('[data-forums-added="forum-debats"] .dropdown-menu');if(!e)return;const r=function(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Forums Débats] Erreur lecture localStorage:",t),[]}}();if(console.log(`[Forums Débats] Mise à jour du menu avec ${r.length} forums`),e.innerHTML="",r.length>0)r.forEach(t=>{const r=document.createElement("li"),o=document.createElement("a");o.href=t.url,o.textContent=t.name,r.appendChild(o),e.appendChild(r)});else{const t=document.createElement("li"),r=document.createElement("a");r.href="forum/debats",r.textContent="Voir tous les forums",t.appendChild(r),e.appendChild(t)}},r.register("ForumsDebats:Extract",function(){if("/forum/debats"!==window.location.pathname)return;console.log("[Forums Débats] Extraction des forums depuis la page...");const r=[];document.querySelectorAll("table.table tbody tr").forEach(t=>{const o=t.querySelector("td:first-child a");if(!o)return;const a=o.textContent.trim(),n=o.getAttribute("href");!e.some(t=>a.toLowerCase().includes(t))&&n&&(r.push({name:a,url:n}),console.log(`[Forums Débats] Ajouté: ${a} (${n})`))});try{localStorage.setItem(t,JSON.stringify(r)),console.log(`[Forums Débats] ${r.length} forums stockés dans localStorage`)}catch(t){console.error("[Forums Débats] Erreur sauvegarde localStorage:",t)}},5)}(),function(){const t="kr-forums-staff",e=["taverne","marché","monde","communauté","débats","staff"];window.updateForumStaffMenu=function(){const e=document.querySelector('[data-forums-added="forum-staff"] .dropdown-menu');if(!e)return;const r=function(){try{const e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.warn("[Forums Staff] Erreur lecture localStorage:",t),[]}}();if(console.log(`[Forums Staff] Mise à jour du menu avec ${r.length} forums`),e.innerHTML="",r.length>0)r.forEach(t=>{const r=document.createElement("li"),o=document.createElement("a");o.href=t.url,o.textContent=t.name,r.appendChild(o),e.appendChild(r)});else{const t=document.createElement("li"),r=document.createElement("a");r.href="forum/staff",r.textContent="Voir tous les forums",t.appendChild(r),e.appendChild(t)}},r.register("ForumsStaff:Extract",function(){if("/forum/staff"!==window.location.pathname)return;console.log("[Forums Staff] Extraction des forums depuis la page...");const r=[];document.querySelectorAll("table.table tbody tr").forEach(t=>{const o=t.querySelector("td:first-child a");if(!o)return;const a=o.textContent.trim(),n=o.getAttribute("href");!e.some(t=>a.toLowerCase().includes(t))&&n&&(r.push({name:a,url:n}),console.log(`[Forums Staff] Ajouté: ${a} (${n})`))});try{localStorage.setItem(t,JSON.stringify(r)),console.log(`[Forums Staff] ${r.length} forums stockés dans localStorage`)}catch(t){console.error("[Forums Staff] Erreur sauvegarde localStorage:",t)}},5)}(),function(){function t(){const t=document.querySelector("table.table tbody");if(!t)return void console.warn("[Forum Cards] Tableau forums introuvable");const e=Array.from(t.querySelectorAll("tr"));if(0===e.length)return void console.warn("[Forum Cards] Aucun forum trouvé");const r=document.createElement("div");r.className="forums-cards-container",r.setAttribute("role","list"),e.forEach((t,e)=>{try{const o=function(t,e){const r=t.querySelectorAll("td");if(r.length<3)return null;const o=r[0],a=o.querySelector("p:first-child a");if(!a)return null;const n=a.textContent.trim(),i=a.getAttribute("href"),l=o.querySelector("p:nth-child(2)"),d=l?l.textContent.trim():"",s=[];o.querySelectorAll("div, span").forEach(t=>{t.textContent.includes("Modérateur")&&t.querySelectorAll("a").forEach(t=>{const e=t.textContent.trim();e&&!e.includes("[mod]")&&s.push({name:e.replace(/\[.*?\]/g,"").trim(),url:t.getAttribute("href")})})});const c=r[1]?.textContent.trim().replace("·","").trim()||"0 sujets",m=r[2]?.textContent.trim()||"0 messages";let p="",u="",g="";if(r[3]){const t=r[3].textContent.trim(),e=r[3].querySelector("a");if(e){u=e.textContent.trim();const r=t.match(/(\w+.*?\(\d{2}:\d{2}\))/);g=r?r[1]:""}p=t.replace("→","").trim()}const b=document.createElement("article");b.className="forum-card",b.setAttribute("role","listitem"),b.setAttribute("data-forum-index",e);const h=document.createElement("a");h.href=i,h.className="forum-card-link",h.setAttribute("aria-label",`Accéder au forum ${n}`);let f=`\n        <div class="forum-card-header">\n          <h3 class="forum-title">${n}</h3>\n        </div>\n      `;return d&&(f+=`<p class="forum-description">${d}</p>`),s.length>0&&(f+=`<p class="forum-moderators">Mod: ${s.length>2?`${s[0].name}, ${s[1].name}...`:s.map(t=>t.name).join(", ")}</p>`),f+='<div class="forum-footer">',f+=`\n        <div class="forum-stats">\n          <span class="forum-topics">${c}</span>\n          <span class="forum-separator">·</span>\n          <span class="forum-messages">${m}</span>\n        </div>\n      `,p&&u&&(f+=`\n          <div class="forum-last-activity">\n            <span class="last-user">${u}</span>\n            <span class="last-time"> · ${g}</span>\n          </div>\n        `),f+="</div>",h.innerHTML=f,h.style.setProperty("display","flex","important"),h.style.setProperty("flex-direction","column","important"),h.style.setProperty("align-items","flex-start","important"),h.style.setProperty("justify-content","flex-start","important"),h.style.setProperty("width","100%","important"),b.appendChild(h),b}(t,e);o&&r.appendChild(o)}catch(t){console.error("[Forum Cards] Erreur création carte:",t)}});const o=t.closest("table");o&&o.parentNode&&(o.parentNode.insertBefore(r,o),o.style.display="none",o.setAttribute("data-mobile-hidden","true")),console.log(`[Forum Cards] ${e.length} forums transformés en cards`)}window.location.pathname.startsWith("/forum/")&&r.register("ForumCards:MobileTransform",function(){document.body.classList.contains("mobile-mode")?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t():console.log("[Forum Cards] Mode desktop détecté, transformation annulée")},15)}(),r.register("MiniChat:FAB",function(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.getElementById("flap");if(!t)return;t.style.display="none",t.classList.add("mini-chat-overlay");const e=document.createElement("button");e.className="mini-chat-fab",e.innerHTML='<span class="fab-text">MC</span>',e.setAttribute("aria-label","Ouvrir le mini-chat"),e.setAttribute("type","button"),e.addEventListener("click",r=>{r.preventDefault(),"block"===t.style.display?(t.style.display="none",e.classList.remove("active"),document.body.style.overflow=""):(t.style.display="block",e.classList.add("active"),document.body.style.overflow="hidden")});const r=t.querySelector(".close-btn");r&&r.addEventListener("click",()=>{t.style.display="none",e.classList.remove("active"),document.body.style.overflow=""}),document.body.appendChild(e),console.log("[Mini-Chat FAB] Initialisé")},20),r.register("ForumTopics:FullTitles",function(){document.querySelectorAll("p.nomargin").forEach(t=>{const e=t.querySelector("span.invisible"),r=t.querySelector("a");if(e&&r){const t=e.textContent.trim();r.textContent.trim().includes("(...)")&&t&&(r.textContent=t)}})},5),r.register("ForumTopics:MobileStats",function(){if(!document.body.classList.contains("mobile-mode"))return;if(!document.body.classList.contains("page-forum"))return;const t=document.getElementById("topics");function e(){const e=t.querySelectorAll("tbody tr");0!==e.length&&(e.forEach(t=>{if(t.hasAttribute("data-stats-added"))return;t.setAttribute("data-stats-added","true");const e=t.querySelector("td:nth-child(1)"),r=t.querySelector("td:nth-child(2)"),o=t.querySelector("td:nth-child(3)");if(!e||!r||!o)return;const a=e.querySelector("ul:first-of-type li a"),n=e.querySelector("p > a");a&&n&&(n.href=a.href,n.setAttribute("data-smart-redirect","first-unread")),n&&(t.style.cursor="pointer",t.addEventListener("click",t=>{"A"===t.target.tagName||t.target.closest("a")||n.click()}));const i=r.textContent.trim(),l=o.textContent.trim(),d=document.createElement("div");d.className="forum-topic-stats-mobile",d.innerHTML=`\n            <i class="fa fa-comment" aria-hidden="true"></i> ${i}\n            <span class="stats-sep">·</span>\n            <i class="fa fa-eye" aria-hidden="true"></i> ${l}\n          `;const s=e.querySelector("p");s&&s.after(d)}),console.log("[Forum Topics Mobile] Sujets enrichis"))}t&&(e(),"undefined"!=typeof jQuery&&jQuery(t).on("draw.dt",function(){e()}))},25),r.register("PermanentTopics:Icons",function(){if(!document.body.classList.contains("mobile-mode"))return;const t=document.querySelectorAll(".panel-default");0!==t.length&&(t.forEach(t=>{t.querySelectorAll(".table tbody tr").forEach(t=>{if(t.hasAttribute("data-permanent-icons-added"))return;t.setAttribute("data-permanent-icons-added","true");const e=t.querySelectorAll("td");if(e.length<2)return;const r=e[1],o=e[2];if(!r||!o)return;const a=r.textContent.trim(),n=o.textContent.trim(),i=document.createElement("div");i.className="permanent-topic-stats",i.innerHTML=`\n            <i class="fa fa-comment" aria-hidden="true"></i> ${a}\n            <span style="margin: 0 4px;">·</span>\n            <i class="fa fa-eye" aria-hidden="true"></i> ${n}\n          `,i.style.cssText="\n            display: flex;\n            align-items: center;\n            gap: 4px;\n            font-size: 11px;\n            color: var(--kr-text-secondary);\n            order: 2;\n            margin: 0 0 2px 0;\n          ",r.style.display="none",o.style.display="none";const l=e[0];l&&l.after(i)})}),console.log("[Permanent Topics Mobile] Icônes ajoutées"))},25),r.register("ForumHeader:MobileBreadcrumb",function(){if(!document.body.classList.contains("mobile-mode"))return;if(window.location.pathname.includes("/kramail"))return;const t=document.querySelector(".container h1");if(!t)return void console.warn("[Forum Header Mobile] h1 non trouvé");const e=Array.from(t.childNodes).find(t=>t.nodeType===Node.TEXT_NODE)?.textContent.trim();if(!e)return;const r=t.querySelectorAll("a");if(r.length<2)return;const o=r[0],a=r[1],n=document.createElement("div");n.className="forum-mobile-breadcrumb",n.style.cssText="\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 12px;\n        margin-bottom: 16px;\n        font-size: 13px;\n        color: var(--kr-text-secondary);\n      ";const i=document.createElement("div");i.style.cssText="\n        display: flex;\n        align-items: center;\n        gap: 6px;\n      ";const l=o.cloneNode(!0);l.style.cssText="\n        display: inline-flex;\n        align-items: center;\n        gap: 4px;\n        color: var(--kr-text-secondary);\n        text-decoration: none;\n        font-weight: 400;\n        background: none;\n        padding: 0;\n        border: none;\n        border-radius: 0;\n      ";const d=document.createElement("span");d.textContent="›",d.style.cssText="\n        color: var(--kr-text-secondary);\n        font-size: 13px;\n        margin: 0 2px;\n      ";const s=document.createElement("span");s.textContent=e,s.style.cssText="\n        color: var(--kr-text-secondary);\n        font-weight: 400;\n      ",i.appendChild(l),i.appendChild(d),i.appendChild(s);const c=document.createElement("a");c.href=a.href,c.className="forum-new-topic-fab",c.setAttribute("aria-label","Nouveau sujet"),c.innerHTML='<span style="font-size: 24px; font-weight: 300; line-height: 1;">+</span>',c.style.cssText="\n        width: 44px;\n        height: 44px;\n        min-width: 44px;\n        border-radius: 50%;\n        background: var(--kr-primary);\n        color: white;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        text-decoration: none;\n        transition: all 0.2s ease;\n      ",c.addEventListener("touchstart",function(){this.style.transform="scale(0.92)",this.style.boxShadow="0 1px 4px rgba(0, 0, 0, 0.3)"}),c.addEventListener("touchend",function(){this.style.transform="scale(1)",this.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.2)"}),n.appendChild(i),n.appendChild(c),t.innerHTML="",t.style.cssText="\n        margin: 12px 16px !important;\n        padding: 0 !important;\n        background: transparent !important;\n      ",t.appendChild(n),console.log("[Forum Header Mobile] Fil d'ariane + FAB créés")},25),function(){function t(){if(!document.body.classList.contains("mobile-mode"))return;if(!window.location.pathname.includes("/kramail"))return;const t=document.querySelector("h1.page-header"),e=document.getElementById("col-left");if(!t||!e)return void console.warn("[Kramail Character Switcher] h1 ou col-left non trouvé");const r=Array.from(t.childNodes).find(t=>t.nodeType===Node.TEXT_NODE)?.textContent.trim();if(!r)return void console.warn("[Kramail Character Switcher] Nom du personnage non trouvé");const o=Array.from(e.querySelectorAll('a[href*="kramail/"]')).filter(t=>{const e=t.getAttribute("href");return e&&e.match(/kramail\/[^\/]+-\d+-\d+$/)}).map(t=>{let e="",o=t.previousElementSibling;for(;o;){if(o.classList&&o.classList.contains("list-group-subtitle")){e=o.textContent.trim();break}o=o.previousElementSibling}return{name:t.textContent.trim(),href:t.href,category:e,isActive:t.textContent.trim()===r}});if(0===o.length)return void console.warn("[Kramail Character Switcher] Aucun personnage trouvé");if(1===o.length)return;const a=document.createElement("div");a.className="kramail-character-dropdown",a.style.cssText="\n        position: absolute;\n        top: 100%;\n        left: 0;\n        right: 0;\n        background: var(--kr-bg-surface);\n        border: 1px solid var(--kr-border-default);\n        border-radius: var(--mobile-radius);\n        box-shadow: var(--kr-shadow-lg);\n        margin-top: 8px;\n        z-index: 1000;\n        display: none;\n        overflow: hidden;\n      ",o.forEach(t=>{const e=document.createElement("a");e.href=t.href,e.className="kramail-character-option",e.style.cssText="\n          display: flex;\n          flex-direction: column;\n          padding: 12px 16px;\n          min-height: 44px;\n          text-decoration: none;\n          color: var(--kr-text-primary);\n          border-bottom: 1px solid var(--kr-border-default);\n          transition: background var(--transition-fast);\n        ";const r=document.createElement("div");if(r.style.cssText=`\n          font-size: 16px;\n          font-weight: ${t.isActive?"600":"400"};\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        `,r.textContent=t.name,t.isActive){const t=document.createElement("span");t.textContent="✓",t.style.cssText="\n            color: var(--kr-primary);\n            font-weight: 700;\n          ",r.insertBefore(t,r.firstChild)}if(e.appendChild(r),t.category){const r=document.createElement("div");r.style.cssText="\n            font-size: 13px;\n            color: var(--kr-text-muted);\n            margin-top: 2px;\n          ",r.textContent=`(${t.category})`,e.appendChild(r)}e.addEventListener("touchstart",()=>{e.style.background="var(--kr-bg-active)"},{passive:!0}),e.addEventListener("touchend",()=>{e.style.background=""},{passive:!0}),e.addEventListener("mouseenter",()=>{e.style.background="var(--kr-bg-hover)"}),e.addEventListener("mouseleave",()=>{e.style.background=""}),a.appendChild(e)});const n=document.createElement("div");n.className="kramail-character-selector",n.style.cssText="\n        position: relative;\n        display: inline-flex;\n        align-items: center;\n        gap: 8px;\n        cursor: pointer;\n        user-select: none;\n        padding: 8px 12px;\n        margin: -8px -12px;\n        border-radius: var(--mobile-radius);\n        transition: background var(--transition-fast);\n      ";const i=Array.from(t.childNodes).find(t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim()===r);if(!i)return void console.warn("[Kramail Character Switcher] Nœud texte non trouvé");const l=document.createElement("span");l.textContent=r,l.style.fontWeight="700";const d=document.createElement("span");d.textContent="▼",d.className="kramail-dropdown-icon",d.style.cssText="\n        font-size: 12px;\n        transition: transform var(--transition-fast);\n        color: var(--kr-text-secondary);\n      ",n.appendChild(l),n.appendChild(d),n.appendChild(a),t.insertBefore(n,i),i.remove();let s=!1;const c=()=>{s&&(s=!1,a.style.display="none",d.style.transform="rotate(0deg)",n.style.background="")};n.addEventListener("click",t=>{t.stopPropagation(),s=!s,a.style.display=s?"block":"none",d.style.transform=s?"rotate(180deg)":"rotate(0deg)",n.style.background=s?"var(--kr-bg-hover)":""}),document.addEventListener("click",t=>{n.contains(t.target)||c()}),a.querySelectorAll("a").forEach(t=>{t.addEventListener("click",()=>{c()})}),console.log("[Kramail Character Switcher] Dropdown créé avec",o.length,"personnages")}r.register("Kramail:CharacterSwitcher",t,30),r.register("Kramail:CharacterSwitcher:Observer",function(){new MutationObserver(e=>{e.forEach(e=>{if("class"===e.attributeName){const e=document.body.classList.contains("mobile-mode"),r=document.querySelector(".kramail-character-selector");e&&!r&&window.location.pathname.includes("/kramail")&&(console.log("[Kramail Character Switcher] Réinitialisation du dropdown (changement de mode)"),t())}})}).observe(document.body,{attributes:!0,attributeFilter:["class"]})},31)}(),r.register("Kramail:MobileEnhancer",function(){if(!document.body.classList.contains("mobile-mode"))return;if(!window.location.pathname.includes("/kramail"))return;const t=document.querySelector("h1.page-header .pull-right");if(!t)return void console.warn("[Kramail Mobile Enhancer] .pull-right non trouvé");const e=document.querySelector("#topics thead .btn-group");if(!e)return void console.warn("[Kramail Mobile Enhancer] .btn-group non trouvé dans le thead");const r=e.cloneNode(!0);r.classList.add("kramail-actions-mobile"),t.appendChild(r);const o=r.querySelector(".dropdown-toggle");o&&(o.innerHTML='<i class="fas fa-ellipsis-v"></i>');const a=r.querySelector(".dropdown-menu");if(o&&a){o.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),r.classList.toggle("open")}),document.addEventListener("click",function(t){r.contains(t.target)||r.classList.remove("open")});const n=r.querySelector("#allbox");if(n){function i(t){document.querySelectorAll('input[type="checkbox"][name="c[]"]').forEach(function(e){e.checked=t});const e=document.querySelector("#allbox");e&&(e.checked=t)}n.removeAttribute("id"),n.setAttribute("name","allbox-mobile"),n.removeAttribute("onclick"),n.addEventListener("click",function(t){t.stopPropagation(),i(n.checked)});const l=n.closest("a");l&&l.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),n.checked=!n.checked,i(n.checked)})}r.querySelectorAll(".dropdown-menu li a").forEach(t=>{t.addEventListener("click",function(){setTimeout(function(){r.classList.remove("open")},200)})})}console.log('[Kramail Mobile Enhancer] Bouton "+" cloné dans la barre de navigation')},32),r.register("Kramail:PostMobileEnhancer",function(){if(!document.body.classList.contains("mobile-mode"))return;if(!window.location.pathname.match(/\/kramail\/post\//))return;const t=document.querySelector("h1.page-header"),e=document.querySelector(".forum-top");if(!t||!e)return void console.warn("[Kramail Post Mobile] h1 ou .forum-top non trouvé");const r=e.querySelector(".pull-right");if(!r)return void console.warn("[Kramail Post Mobile] .pull-right non trouvé dans .forum-top");const o=Array.from(r.querySelectorAll("a.btn"));if(0===o.length)return void console.warn("[Kramail Post Mobile] Aucun bouton trouvé");const a=document.createElement("span");a.className="pull-right";const n=o.slice(0,4),i=o.slice(4);n.forEach(function(t){Array.from(t.childNodes).filter(function(t){return 3===t.nodeType}).forEach(function(t){t.textContent=""}),t.querySelector(".fa-backward")&&t.classList.add("btn-primary"),a.appendChild(t)});var l=document.createElement("div");l.className="btn-group kramail-post-kebab";var d=document.createElement("button");d.className="btn btn-default dropdown-toggle",d.type="button",d.innerHTML='<i class="fas fa-ellipsis-v"></i>';var s=document.createElement("ul");s.className="dropdown-menu dropdown-menu-right",s.setAttribute("role","menu");var c={"fa-exclamation-triangle":"Signaler","fa-times":"Supprimer","fa-envelope":"Nouveau message","fa-user":"Contacts"};i.forEach(function(t){var e=document.createElement("li"),r=document.createElement("a");r.href=t.getAttribute("href")||"#";var o=t.querySelector("i"),a=o?o.className:"",n="";Object.keys(c).forEach(function(t){-1!==a.indexOf(t)&&(n=c[t])}),r.innerHTML='<i class="'+a+'"></i> <span class="label-simple">'+n+"</span>",t.classList.contains("alertdel")&&r.classList.add("alertdel");var i=t.getAttribute("onclick");i&&r.setAttribute("onclick",i),e.appendChild(r),s.appendChild(e)}),l.appendChild(d),l.appendChild(s),a.appendChild(l),t.appendChild(a),d.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),l.classList.toggle("open")}),document.addEventListener("click",function(t){l.contains(t.target)||l.classList.remove("open")}),s.querySelectorAll("a").forEach(function(t){t.addEventListener("click",function(){setTimeout(function(){l.classList.remove("open")},200)})}),r.classList.add("kramail-actions-moved");var m=document.querySelector("ul.media-list.forum > li.media.well");if(m){m.classList.add("kramail-post-restructured");var p=m.querySelector(".pull-left"),u=m.querySelector(".media-body");if(p&&u){var g=p.querySelector("img.avatar"),b=g?g.src:"",h=g?g.alt:"",f=p.querySelector(".cartouche strong a"),k=f?f.textContent:h,y=f?f.href:"#",v=u.querySelector(".btn-group-xs .btn"),x="";v&&(x=v.textContent.replace("posté","").trim());var w=u.querySelector("p"),E=w?w.innerHTML:"",S=u.querySelector(".t"),C=S?S.innerHTML:"",A="";if(S){for(var L=S.nextSibling,q=[];L;)1===L.nodeType?q.push(L.outerHTML):3===L.nodeType&&L.textContent.trim()&&q.push(L.textContent),L=L.nextSibling;A=(A=q.join("")).replace(/^(<br\s*\/?>)*\s*___\s*(<br\s*\/?>)*/i,"").trim()}var T=document.createElement("div");T.className="kramail-msg-header",T.innerHTML='<img class="kramail-msg-avatar" src="'+b+'" alt="'+h+'"><div class="kramail-msg-header-info"><div class="kramail-msg-sender"><a href="'+y+'">'+k+'</a></div><div class="kramail-msg-date"><i class="fa fa-clock-o"></i> '+x+"</div></div>";var N=document.createElement("div");N.className="kramail-msg-recipients",N.innerHTML=E;var M=document.createElement("div");if(M.className="kramail-msg-body",M.innerHTML=C,A.length>5){var P=document.createElement("div");P.className="kramail-msg-signature",P.innerHTML=A,M.appendChild(P)}m.appendChild(T),m.appendChild(N),m.appendChild(M),console.log("[Kramail Post Mobile] Page message restructurée")}else console.warn("[Kramail Post Mobile] pull-left ou media-body manquant")}else console.warn("[Kramail Post Mobile] .media.well non trouvé")},33),r.register("ForumThread:MobileBreadcrumb",function(){if(!document.body.classList.contains("mobile-mode"))return;if(!window.location.pathname.includes("/forum/sujet/"))return;const t=document.querySelector(".container h1.page-header"),e=document.querySelectorAll(".forum-top");if(!t||0===e.length)return void console.warn("[Forum Thread Mobile] h1 ou .forum-top non trouvé");const r=Array.from(t.childNodes).filter(t=>t.nodeType===Node.TEXT_NODE&&t.textContent.trim()).map(t=>t.textContent.trim())[0];if(!r)return void console.warn("[Forum Thread Mobile] Titre du thread non trouvé");const o=e[0],a=o.querySelector('a[href*="forum/rp/"], a[href*="forum/hrp/"]'),n=o.querySelector('a[href*="nouveau-sujet"]');if(!a||!n)return void console.warn("[Forum Thread Mobile] Liens non trouvés",{taverneLink:!!a,newTopicLink:!!n});const i=a.textContent.trim(),l=a.href;let d="Jeu (RP)",s="forum/rp";function c(t=!1){const e=document.createElement("div");e.className=t?"forum-thread-mobile-breadcrumb-bottom":"forum-thread-mobile-breadcrumb",e.style.cssText=`\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          gap: 12px;\n          ${t?"margin-top: 16px; margin-bottom: 16px; padding: 12px 16px;":"margin-bottom: 16px;"}\n          font-size: 13px;\n          color: var(--kr-text-secondary);\n        `;const o=document.createElement("div");o.style.cssText="\n          display: flex;\n          align-items: center;\n          gap: 6px;\n          flex: 1;\n          min-width: 0;\n        ";const l=document.createElement("a");l.href=s,l.textContent=d,l.style.cssText="\n          display: inline-flex;\n          align-items: center;\n          gap: 4px;\n          color: var(--kr-text-secondary);\n          text-decoration: none;\n          font-weight: 400;\n          white-space: nowrap;\n        ";const c=document.createElement("span");c.textContent="›",c.style.cssText="\n          color: var(--kr-text-secondary);\n          font-size: 13px;\n          margin: 0 2px;\n          flex-shrink: 0;\n        ";const m=document.createElement("a");m.href=a.href,m.textContent=i,m.style.cssText="\n          color: var(--kr-text-secondary);\n          text-decoration: none;\n          font-weight: 400;\n          white-space: nowrap;\n        ";const p=document.createElement("span");p.textContent="›",p.style.cssText="\n          color: var(--kr-text-secondary);\n          font-size: 13px;\n          margin: 0 2px;\n          flex-shrink: 0;\n        ";const u=document.createElement("span");u.textContent=r,u.style.cssText="\n          color: var(--kr-text-secondary);\n          font-weight: 400;\n          overflow: hidden;\n          text-overflow: ellipsis;\n          white-space: nowrap;\n          min-width: 0;\n        ",o.appendChild(l),o.appendChild(c),o.appendChild(m),o.appendChild(p),o.appendChild(u);const g=document.createElement("a");return g.href=n.href,g.className="forum-new-topic-fab",g.setAttribute("aria-label","Nouveau sujet"),g.innerHTML='<span style="font-size: 24px; font-weight: 300; line-height: 1;">+</span>',g.style.cssText="\n          width: 44px;\n          height: 44px;\n          min-width: 44px;\n          flex-shrink: 0;\n          border-radius: 50%;\n          background: var(--kr-primary);\n          color: white;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n          text-decoration: none;\n          transition: all 0.2s ease;\n        ",g.addEventListener("touchstart",function(){this.style.transform="scale(0.92)",this.style.boxShadow="0 1px 4px rgba(0, 0, 0, 0.3)"}),g.addEventListener("touchend",function(){this.style.transform="scale(1)",this.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.2)"}),e.appendChild(o),e.appendChild(g),e}l.includes("/forum/hrp/")&&(d="Jeu (HRP)",s="forum/hrp"),t.innerHTML="",t.style.cssText="\n        margin: 12px 16px !important;\n        padding: 0 !important;\n        background: transparent !important;\n      ",t.appendChild(c(!1)),e.forEach((t,e)=>{0!==e&&(t.innerHTML="",t.style.cssText="\n          margin: 0 !important;\n          padding: 0 !important;\n          background: transparent !important;\n          border: none !important;\n        ",t.appendChild(c(!0)))});const m=document.querySelector(".container h1.page-header + .row + .row .btn-group");m&&(m.style.display="none"),document.querySelectorAll('.forum-top a[href*="nouveau-sujet"], .forum-top a[href*="repondre"]').forEach(t=>{t.parentElement.style.display="none"}),console.log("[Forum Thread Mobile] Fil d'ariane + FAB créés (haut et bas) - Éléments superflus masqués")},25),r.register("ForumThread:HideTags",function(){console.log("[Forum Thread:HideTags] Function called"),window.location.pathname.includes("/forum/sujet/")?(console.log("[Forum Thread:HideTags] On forum thread page, hiding tags after delay"),setTimeout(()=>{console.log("[Forum Thread:HideTags] setTimeout fired");const t=Array.from(document.querySelectorAll('a[href*="forum/tags"]'));if(console.log("[Forum Thread:HideTags] Found",t.length,"tag links"),0===t.length)return void console.log("[Forum Thread:HideTags] No tag links found");let e=t[0];for(;e&&e!==document.body;)if(e=e.parentElement,e&&e.querySelectorAll('a[href*="forum/tags"]').length===t.length){const r=e.querySelectorAll("a");if(console.log("[Forum Thread:HideTags] Found container with",r.length,"total links"),r.length<50)return e.style.display="none",void console.log("[Forum Thread] Tags masqués ("+t.length+" tag(s))")}t.forEach(t=>{const e=t.parentElement;e&&!e.className.includes("forum")&&(e.style.display="none")}),console.log("[Forum Thread] Tags masqués (fallback)")},500)):console.log("[Forum Thread:HideTags] Not on a forum thread page")},26),r.register("ForumPosts:Restructure",function(){if(window.innerWidth>=768)return;if(!window.location.pathname.includes("/forum/sujet/"))return;const t=document.querySelectorAll("ul.media-list.forum > li.media:not([data-restructured])");0!==t.length&&(t.forEach(t=>{const e=t.querySelector(".pull-left, .user-info"),r=t.querySelector(".pull-right"),o=t.querySelector(".media-body");if(!e||!o)return;const a=o.innerHTML,n=document.createElement("div");n.className="row forum-header";const i=document.createElement("div");i.className="col-xs-8 forum-user-section";const l=e.cloneNode(!0);i.appendChild(l);const d=o.querySelector(".btn-group.btn-group-xs:first-child, div.btn-group.btn-group-xs:first-child");if(d){const t=d.textContent.replace("posté","").replace("modifié","").trim(),e=document.createElement("div");e.className="post-date-mobile",e.textContent=t,i.appendChild(e)}const s=document.createElement("div");if(s.className="col-xs-4 forum-actions-section",r){const t=r.cloneNode(!0);s.appendChild(t)}n.appendChild(i),n.appendChild(s);const c=document.createElement("div");c.className="row forum-content-row";const m=document.createElement("div");m.className="col-xs-12 forum-content-section";const p=document.createElement("div");p.innerHTML=a;const u=p.querySelector(".pull-left, .user-info"),g=p.querySelector(".pull-right"),b=p.querySelector(".btn-group.btn-group-xs:first-child");u&&u.remove(),g&&g.remove(),b&&b.remove(),m.innerHTML=p.innerHTML,c.appendChild(m),e&&e.parentElement===t&&e.remove(),o.innerHTML="",o.appendChild(n),o.appendChild(c),t.setAttribute("data-restructured","true"),t.classList.add("forum-post-restructured")}),console.log(`[Forum Restructure] ${t.length} posts restructurés avec nouveau layout`))},26);const W={STORAGE_KEY:"kr-changelog-viewed",CHANGELOG_URL:"https://raw.githubusercontent.com/arnaudroubinet/kraland-css/main/changelog.json",changelog:null,async loadChangelog(){if(null!==this.changelog)return this.changelog;try{return new Promise((t,e)=>{"undefined"!=typeof GM&&GM.xmlHttpRequest?GM.xmlHttpRequest({method:"GET",url:this.CHANGELOG_URL,timeout:5e3,onload:e=>{try{const r=JSON.parse(e.responseText);this.changelog=this.parseChangelogData(r),t(this.changelog)}catch(e){console.warn("[Changelog] Erreur parsing JSON:",e),this.changelog={},t(this.changelog)}},onerror:e=>{console.warn("[Changelog] Erreur chargement:",e),this.changelog={},t(this.changelog)}}):fetch(this.CHANGELOG_URL,{cache:"no-store"}).then(t=>t.json()).then(e=>{this.changelog=this.parseChangelogData(e),t(this.changelog)}).catch(e=>{console.warn("[Changelog] Erreur fetch:",e),this.changelog={},t(this.changelog)})})}catch(t){return console.warn("[Changelog] Erreur loadChangelog:",t),{}}},parseChangelogData(t){const e={};return t.versions&&Array.isArray(t.versions)&&t.versions.forEach(t=>{t.version&&Array.isArray(t.changes)&&(e[t.version]=t.changes)}),e},getCurrentVersion:()=>t,getLastViewedVersion(){try{const t=localStorage.getItem(this.STORAGE_KEY);return t?JSON.parse(t):null}catch(t){return console.warn("[Changelog] Erreur lecture localStorage:",t),null}},markVersionAsViewed(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.warn("[Changelog] Erreur sauvegarde localStorage:",t)}},getChangesBetweenVersions(t,e){if(!this.changelog||"object"!=typeof this.changelog)return[];if(!t||!this.changelog[e])return this.changelog[e]||[];const r=Object.keys(this.changelog).sort((t,e)=>e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})),o=r.indexOf(t),a=r.indexOf(e);if(-1===o||-1===a||o<=a)return this.changelog[e]||[];const n=[];for(let t=a;t<o;t++){const e=r[t];this.changelog[e]&&n.push(...this.changelog[e])}return n},createModal(t){const e=document.createElement("div");e.className="kr-changelog-modal",e.id="kr-changelog-modal";const r=0===t.length||t===this.changelog[this.getCurrentVersion()],o=r?"Bienvenue dans Kraland Thème!":"Mise à jour disponible",a=r?"Découvrez les améliorations":"Voici les changements de cette version";e.innerHTML=`\n        <div class="kr-changelog-overlay" tabindex="-1"></div>\n        <div class="kr-changelog-content" role="dialog" aria-modal="true" aria-label="${o}">\n          <div class="kr-changelog-header">\n            <h2>${o}</h2>\n          </div>\n          <div class="kr-changelog-body">\n            <p class="kr-changelog-subtitle">${a}</p>\n            <ul class="kr-changelog-list">\n              ${t.map(t=>`<li>${t}</li>`).join("")}\n            </ul>\n          </div>\n          <div class="kr-changelog-footer">\n            <button class="kr-changelog-view-all">Voir tous les changements</button>\n            <button class="kr-changelog-close-btn">Fermer</button>\n          </div>\n        </div>\n      `;const n=e.querySelector(".kr-changelog-content");n&&(n.style.position="fixed",n.style.top="50%",n.style.left="50%",n.style.transform="translate(-50%, -50%)",n.style.width="90%",n.style.maxWidth="600px",n.style.background="rgba(0,0,0,0.95)",n.style.color="#ffffff");const i=e.querySelector(".kr-changelog-overlay");return i&&(i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.background="rgba(0, 0, 0, 0.5)",i.style.cursor="pointer",i.tabIndex=-1),e},showModal(t){const e=document.getElementById("kr-changelog-modal");e&&e.remove();const r=this.createModal(t);document.body.appendChild(r);const o=r.querySelector(".kr-changelog-close-btn"),a=r.querySelector(".kr-changelog-overlay"),n=r.querySelector(".kr-changelog-view-all");let i=()=>{r.remove(),this.markVersionAsViewed(this.getCurrentVersion()),document.removeEventListener("keydown",l)};const l=t=>{"Escape"===t.key&&i()};document.addEventListener("keydown",l),o.addEventListener("click",i),a.addEventListener("click",i),n.addEventListener("click",()=>{this.showFullChangelog()}),setTimeout(()=>{r.classList.add("active");const t=r.querySelector(".kr-changelog-close-btn");t&&t.focus()},50),i=()=>{r.remove(),this.markVersionAsViewed(this.getCurrentVersion()),document.removeEventListener("keydown",l)}},showFullChangelog(){const t=document.getElementById("kr-changelog-modal");t&&t.remove();const e=document.createElement("div");e.className="kr-changelog-modal kr-changelog-full",e.id="kr-changelog-full-modal";const r=Object.keys(this.changelog).sort((t,e)=>e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})).map(t=>`\n          <div class="kr-changelog-version">\n            <h3>Version ${t}</h3>\n            <ul>\n              ${this.changelog[t].map(t=>`<li>${t}</li>`).join("")}\n            </ul>\n          </div>\n        `).join("");e.innerHTML=`\n        <div class="kr-changelog-overlay" tabindex="-1"></div>\n        <div class="kr-changelog-content kr-changelog-content-full" role="dialog" aria-modal="true" aria-label="Historique complet des changements">\n          <div class="kr-changelog-header">\n            <h2>Historique complet des changements</h2>\n          </div>\n          <div class="kr-changelog-body kr-changelog-body-full">\n            ${r}\n          </div>\n          <div class="kr-changelog-footer">\n            <button class="kr-changelog-close-btn">Fermer</button>\n          </div>\n        </div>\n      `;const o=e.querySelector(".kr-changelog-content");o&&(o.style.position="fixed",o.style.top="50%",o.style.left="50%",o.style.transform="translate(-50%, -50%)",o.style.width="90%",o.style.maxWidth="800px",o.style.background="rgba(0,0,0,0.95)",o.style.color="#ffffff");const a=e.querySelector(".kr-changelog-overlay");a&&(a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.background="rgba(0, 0, 0, 0.5)",a.style.cursor="pointer",a.tabIndex=-1),document.body.appendChild(e);const n=e.querySelector(".kr-changelog-close-btn"),i=e.querySelector(".kr-changelog-overlay"),l=()=>{e.remove(),document.removeEventListener("keydown",d)};n.addEventListener("click",l),i.addEventListener("click",l);const d=t=>{"Escape"===t.key&&l()};document.addEventListener("keydown",d),setTimeout(()=>{e.classList.add("active");const t=e.querySelector(".kr-changelog-close-btn");t&&t.focus()},50)},async init(){const t=this.getCurrentVersion(),e=this.getLastViewedVersion();if(e!==t){console.log("[Changelog] Nouvelle version détectée, chargement du changelog..."),await this.loadChangelog();const r=this.getChangesBetweenVersions(e,t);r.length>0&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>this.showModal(r),1e3)}):setTimeout(()=>this.showModal(r),1e3))}else console.log("[Changelog] Version identique, pas de chargement");this.addChangelogButton()},addChangelogButton(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{this.insertChangelogButton()}):setTimeout(()=>this.insertChangelogButton(),500)},async insertChangelogButton(){if(!window.location.href.includes("/profil/interface"))return;null===this.changelog&&(console.log("[Changelog] Chargement changelog pour page profil..."),await this.loadChangelog());const t=document.querySelector(".panel-body")||document.querySelector(".content")||document.querySelector("main")||document.querySelector(".container");if(!t)return void console.log("[Changelog] Conteneur profil non trouvé");if(document.getElementById("kr-changelog-btn"))return;const e=document.createElement("button");e.id="kr-changelog-btn",e.className="btn btn-info kr-changelog-btn",e.innerHTML="📝 Voir l'historique des changements";const r=document.querySelector(".kr-reset-alerts-btn"),o=r&&r.parentNode&&r.parentNode.querySelector(".help-block");if(o&&(e.className="btn btn-link kr-changelog-btn kr-changelog-inline",e.innerHTML="📝 Voir l'historique des changements",e.setAttribute("title","Voir l'historique des changements"),e.setAttribute("aria-label","Voir l'historique des changements"),e.style.display="inline",e.style.marginLeft="8px",e.style.fontSize="13px",e.style.padding="0",e.style.verticalAlign="middle"),e.addEventListener("click",()=>{this.showFullChangelog()}),o)o.appendChild(e);else{const r=t.querySelector("h1")||t.querySelector("h2");r?r.parentNode.insertBefore(e,r.nextSibling):t.insertBefore(e,t.firstChild)}console.log("[Changelog] Bouton ajouté sur la page profil")}};!function(){try{const t=(null===localStorage.getItem(o.ENABLE_KEY)&&localStorage.setItem(o.ENABLE_KEY,"true"),n()),e=document.getElementById(o.STYLE_ID);!t&&e?.parentElement&&e.parentElement.removeChild(e),a(O),a(R),t&&(u(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{h(),m()},{once:!0}):(h(),m())),function(){let t=!1;const e=new MutationObserver(()=>{n()&&(document.getElementById(o.STYLE_ID)||p(o.BUNDLED_CSS),t||(h(),t=!0)),a(()=>s()),a(O)});(document.documentElement||document)&&e.observe(document.documentElement||document,{childList:!0,subtree:!0});const r=t=>function(){const e=t.apply(this,arguments);return setTimeout(()=>u(),250),e};history.pushState=r(history.pushState),history.replaceState=r(history.replaceState),window.addEventListener("popstate",()=>setTimeout(()=>u(),250))}(),function(){let t={x:0,y:0};const e=new WeakMap,r=new MutationObserver(r=>{r.forEach(r=>{r.addedNodes.forEach(r=>{1===r.nodeType&&r.classList?.contains("bootbox")&&(t.x=window.scrollX,t.y=window.scrollY,setTimeout(()=>{const o=$(r).data("bs.modal");o&&"static"===o.options.backdrop&&(o.options.backdrop=!0,$(r).on("mousedown.backdrop.track",function(t){t.target===this&&e.set(this,{x:t.clientX,y:t.clientY})}),$(r).off("click.dismiss.bs.modal").on("click.dismiss.bs.modal",function(t){if(t.target!==this)return;const r=e.get(this);r&&(Math.sqrt(Math.pow(t.clientX-r.x,2)+Math.pow(t.clientY-r.y,2))>5||($(this).modal("hide"),e.delete(this)))}),$(r).one("hidden.bs.modal",function(){e.delete(this)})),window.scrollTo(t.x,t.y)},100),$(r).one("shown.bs.modal",function(){window.scrollTo(t.x,t.y)}))})})});document.body&&r.observe(document.body,{childList:!0,subtree:!1})}(),K(),function(){const t=window.innerWidth<768;if(!t)return;let e;!function(){if(document.querySelector(".kr-mobile-overlay"))return;const t=document.createElement("div");t.className="kr-mobile-overlay",t.addEventListener("click",()=>{const e=document.getElementById("skills-panel");e&&e.classList.remove("mobile-open");const r=document.getElementById("flap");r&&r.classList.remove("mobile-open"),t.classList.remove("active")}),document.body.appendChild(t)}(),function(){if(!c())return;const t=document.getElementById("skills-panel");if(!t)return;const e=document.createElement("button");e.className="kr-mobile-skills-toggle btn btn-primary",e.innerHTML='<i class="fa fa-chart-bar"></i>',e.setAttribute("aria-label","Afficher les compétences"),e.onclick=()=>{t.classList.toggle("mobile-open");const e=document.querySelector(".kr-mobile-overlay");e&&e.classList.toggle("active")},document.body.appendChild(e);const r=document.createElement("button");r.className="kr-mobile-close",r.innerHTML="×",r.setAttribute("aria-label","Fermer"),r.onclick=()=>{t.classList.remove("mobile-open");const e=document.querySelector(".kr-mobile-overlay");e&&e.classList.remove("active")},t.insertBefore(r,t.firstChild)}(),function(){const t=document.getElementById("flap");if(!t)return;const e=document.querySelector('a[href*="#flap"]');if(e&&e.addEventListener("click",e=>{e.preventDefault(),t.classList.toggle("mobile-open");const r=document.querySelector(".kr-mobile-overlay");r&&r.classList.toggle("active")}),!t.querySelector(".kr-mobile-close")){const e=document.createElement("button");e.className="kr-mobile-close",e.innerHTML="×",e.setAttribute("aria-label","Fermer le mini-chat"),e.onclick=()=>{t.classList.remove("mobile-open");const e=document.querySelector(".kr-mobile-overlay");e&&e.classList.remove("active")};const r=t.querySelector(".panel-heading")||t.querySelector(".modal-header")||t.firstElementChild;r?(r.style.position="relative",r.appendChild(e)):t.insertBefore(e,t.firstChild)}}(),K(),function(){const t=new MutationObserver(t=>{t.forEach(t=>{const e=t.target.closest(".bootbox.modal");if(!e)return;const r=e.querySelector(".panel.with-nav-tabs .panel-heading");if(!r)return;const o=r.querySelector(".nav-tabs > li.active");o&&setTimeout(()=>{const t=o.getBoundingClientRect(),e=r.getBoundingClientRect(),a=o.offsetLeft-e.width/2+t.width/2;r.scrollTo({left:Math.max(0,a),behavior:"smooth"})},100)})});document.body&&t.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})}(),window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{window.innerWidth<768!==t&&location.reload()},250)})}(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>r.run(),{once:!0}):r.run(),setTimeout(()=>{const t=document.getElementById(o.STYLE_ID);n()&&t?.parentElement?t.parentElement.appendChild(t):!n()&&t?.parentElement&&t.parentElement.removeChild(t)},1e3),setInterval(f,2e3),a(()=>W.init())}catch(t){console.error("Kraland theme init failed",t)}}()}();